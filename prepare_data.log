2025-10-20 11:16:32,913 - __main__ - INFO - 
================================================================================
2025-10-20 11:16:32,915 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-20 11:16:32,915 - __main__ - INFO - ================================================================================
2025-10-20 11:16:32,915 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-09-19 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC']
  DV: []
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-20 11:16:32,916 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:16:32,916 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-20 11:16:32,916 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:18:32,131 - __main__ - INFO - 
================================================================================
2025-10-20 11:18:32,131 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-20 11:18:32,131 - __main__ - INFO - ================================================================================
2025-10-20 11:18:32,131 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-09-19 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC']
  DV: []
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-20 11:18:32,132 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:18:32,133 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-20 11:18:32,134 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:18:32,134 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-20 11:18:32,231 - database - INFO - Loading data from database for Mill 6...
2025-10-20 11:18:32,231 - database - INFO -   Date range: 2025-09-19 to 2025-10-19
2025-10-20 11:18:32,232 - database - INFO -   Resample frequency: 1min
2025-10-20 11:18:32,232 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-20 11:18:32,232 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-09-19, end_date=2025-10-19
2025-10-20 11:18:32,233 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-20 11:18:32,233 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-09-19 to 2025-10-19
2025-10-20 11:18:32,233 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-09-19, end_date=2025-10-19
2025-10-20 11:18:32,233 - db.db_connector - INFO - DEBUG: Current time: 2025-10-20 11:18:32.233605
2025-10-20 11:18:32,241 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-09-19 00:00:00 (timezone: None)
2025-10-20 11:18:32,241 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-20 11:18:32,243 - db.db_connector - INFO - DEBUG: Days from now to end_date: -2
2025-10-20 11:18:32,243 - db.db_connector - INFO - DEBUG: Converted start_date 2025-09-19 -> 2025-09-19 00:00:00
2025-10-20 11:18:32,243 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-20 11:18:32,243 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-09-19 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-20 11:18:32,243 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-20 11:18:32,509 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-20 11:18:32,510 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-20 11:18:32,536 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-20 11:18:32,990 - db.db_connector - INFO - Retrieved 43201 rows for Mill 6
2025-10-20 11:18:32,992 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-09-19 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:18:32,993 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-20 11:18:33,000 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 43201
2025-10-20 11:18:33,001 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-09-19 00:00:00
2025-10-20 11:18:33,001 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-20 11:18:33,002 - db.db_connector - INFO - Mill data retrieved: 43201 rows, 13 columns
2025-10-20 11:18:33,003 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-20 11:18:33,022 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp  PSI80  PSI200
TimeStamp                                            ...                           
2025-09-19 00:00:00  175.712  14.188887  134.440083  ...  206.405350   51.5    21.3
2025-09-19 00:01:00  175.712  14.179776  134.158500  ...  204.743175   51.5    21.3
2025-09-19 00:02:00  175.712  14.206867  131.214500  ...  201.810305   51.5    21.3

[3 rows x 13 columns]
2025-10-20 11:18:33,031 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-09-19 00:00:00, end=2025-10-19 00:00:00
2025-10-20 11:18:33,031 - db.db_connector - INFO - DEBUG: Before date filtering: 43201 rows, date range: 2025-09-19 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:18:33,034 - db.db_connector - INFO - DEBUG: After start date filter (2025-09-19 00:00:00): 43201 rows (removed 0 rows)
2025-10-20 11:18:33,035 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 43201 rows (removed 0 rows)
2025-10-20 11:18:33,036 - db.db_connector - INFO - DEBUG: After date filtering: 43201 rows, date range: 2025-09-19 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:18:33,059 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-20 11:18:33,074 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-20 11:18:33,075 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-20 11:18:33,076 - db.db_connector - INFO - Processed mill data: 43201 rows, 13 columns
2025-10-20 11:18:33,076 - db.db_connector - INFO - Retrieving ore quality data
2025-10-20 11:18:33,076 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-09-19, end_date=2025-10-19
2025-10-20 11:18:33,077 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-09-19 00:00:00 (timezone: None)
2025-10-20 11:18:33,078 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-20 11:18:33,079 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-09-19 -> 2025-09-19 00:00:00
2025-10-20 11:18:33,080 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-20 11:18:33,080 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-09-19 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-20 11:18:33,084 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-20 11:18:33,084 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-20 11:18:33,086 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-20 11:18:33,087 - db.db_connector - INFO - DEBUG: ore_quality has 90 records in requested range 2025-09-19 to 2025-10-19
2025-10-20 11:18:33,092 - db.db_connector - INFO - Retrieved 90 rows of ore quality data
2025-10-20 11:18:33,093 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-09-19 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:18:33,093 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-20 11:18:33,094 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 90
2025-10-20 11:18:33,094 - db.db_connector - INFO - Ore data retrieved: 90 rows, 11 columns
2025-10-20 11:18:33,095 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-20 11:18:33,095 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-09-19 00:00:00, end=2025-10-19 00:00:00
2025-10-20 11:18:33,095 - db.db_connector - INFO - DEBUG: Before date filtering: 90 rows, date range: 2025-09-19 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:18:33,095 - db.db_connector - INFO - DEBUG: After start date filter (2025-09-19 00:00:00): 90 rows (removed 0 rows)
2025-10-20 11:18:33,097 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 90 rows (removed 0 rows)
2025-10-20 11:18:33,097 - db.db_connector - INFO - DEBUG: After date filtering: 90 rows, date range: 2025-09-19 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:18:33,103 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-20 11:18:33,104 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-20 11:18:33,104 - db.db_connector - INFO - Processed ore data: 42721 rows, 9 columns - with constant values (no interpolation)
2025-10-20 11:18:33,104 - db.db_connector - INFO - DF1 (mill): 43201 rows, index range: 2025-09-19 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:18:33,105 - db.db_connector - INFO - DF2 (ore): 42721 rows, index range: 2025-09-19 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:18:33,106 - db.db_connector - INFO - Found 42721 common timestamps
2025-10-20 11:18:33,111 - db.db_connector - INFO - Successfully joined dataframes: 42721 rows, 22 columns
2025-10-20 11:18:33,113 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-20 11:18:33,113 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-09-19 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:18:33,119 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 42721
2025-10-20 11:18:33,120 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 42721 records
2025-10-20 11:18:33,120 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-20 11:18:33,123 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                                
2025-09-19 06:00:00  175.881503  13.998450  156.947272  1960.422458  1650.479426    0.449260  1657.402756  3.581000  555.957653  766.560222  208.649311  52.933481  19.610815  784   NaN      1       1.4       7.0  0.737  0.228   0.035             NaN
2025-09-19 06:01:00  175.884503  14.000991  155.641610  1961.269907  1649.431918    0.448760  1657.591137  3.576533  555.636808  765.654869  208.602531  52.953481  19.590815  784   NaN      1       1.4       7.0  0.737  0.228   0.035             NaN
2025-09-19 06:02:00  175.887503  13.999801  155.869165  1962.668418  1648.302321    0.448302  1657.982620  3.572067  555.270399  764.773544  208.600590  52.973481  19.570815  784   NaN      1       1.4       7.0  0.737  0.228   0.035             NaN
2025-10-20 11:18:33,124 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-20 11:18:33,126 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-20 11:18:33,127 - db.db_connector - INFO - ==================================================
2025-10-20 11:18:33,127 - db.db_connector - INFO - Combined data has 42721 rows and 22 columns
2025-10-20 11:18:33,129 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-20 11:18:33,138 - db.db_connector - INFO - Combined data sample:
                            Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                               ...                               
2025-09-19 06:00:00  175.881503  13.998450  156.947272  ...  0.228   0.035             NaN
2025-09-19 06:01:00  175.884503  14.000991  155.641610  ...  0.228   0.035             NaN
2025-09-19 06:02:00  175.887503  13.999801  155.869165  ...  0.228   0.035             NaN

[3 rows x 22 columns]
2025-10-20 11:18:33,138 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-20 11:18:33,138 - db.db_connector - INFO - DEBUG: Final result - 42721 total records
2025-10-20 11:18:33,139 - db.db_connector - INFO - DEBUG: Final date range: 2025-09-19 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:18:33,701 - database - INFO - Applying data filters...
2025-10-20 11:18:33,704 - database - INFO -   Ore: 100 < x < 220
2025-10-20 11:18:33,704 - database - INFO -   PulpHC: 400 < x < 600
2025-10-20 11:18:33,705 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-20 11:18:33,715 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:18:33,715 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-20 11:18:33,715 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:18:33,715 - motif_discovery - INFO - Discovering motifs in 4 features...
2025-10-20 11:18:33,715 - motif_discovery - INFO -   Window size: 60
2025-10-20 11:18:33,716 - motif_discovery - INFO -   Max motifs: 20
2025-10-20 11:18:33,716 - motif_discovery - INFO -   Radius: 4.5
2025-10-20 11:18:33,721 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-20 11:19:49,925 - motif_discovery - INFO -   Discovering motif groups...
2025-10-20 11:19:51,725 - __main__ - INFO - 
Applying correlation filter...
2025-10-20 11:19:51,725 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-20 11:19:51,726 - motif_discovery - INFO -   Filter level: instance
2025-10-20 11:19:51,726 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-20 11:19:51,726 - motif_discovery - INFO -   Rules:
2025-10-20 11:19:51,726 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-20 11:19:51,726 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-20 11:19:51,733 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:19:51,734 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-20 11:19:51,734 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:19:51,734 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-20 11:19:51,734 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-20 11:19:51,734 - density_analysis - INFO -   Window size: 60 minutes
2025-10-20 11:19:51,734 - density_analysis - INFO -   Max motifs: 15
2025-10-20 11:19:51,734 - density_analysis - INFO -   Radius: 4.5
2025-10-20 11:19:51,735 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-20 11:20:47,554 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-20 11:21:40,462 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:21:40,462 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-20 11:21:40,462 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:21:40,462 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-20 11:21:40,462 - density_analysis - INFO - 
Motif 1 (10 instances):
2025-10-20 11:21:40,489 - density_analysis - INFO -   Avg DensityHC change: +1.07
2025-10-20 11:21:40,489 - density_analysis - INFO -   Ore-Density correlation: -0.115 (lag: 0 min)
2025-10-20 11:21:40,489 - density_analysis - INFO -   WaterMill-Density correlation: -0.131 (lag: 0 min)
2025-10-20 11:21:40,489 - density_analysis - INFO - 
Motif 2 (3 instances):
2025-10-20 11:21:40,495 - density_analysis - INFO -   Avg DensityHC change: -7.09
2025-10-20 11:21:40,495 - density_analysis - INFO -   Ore-Density correlation: +0.260 (lag: -6 min)
2025-10-20 11:21:40,495 - density_analysis - INFO -   WaterMill-Density correlation: +0.253 (lag: -4 min)
2025-10-20 11:21:40,495 - density_analysis - INFO - 
Motif 3 (4 instances):
2025-10-20 11:21:40,503 - density_analysis - INFO -   Avg DensityHC change: +6.55
2025-10-20 11:21:40,503 - density_analysis - INFO -   Ore-Density correlation: -0.030 (lag: 0 min)
2025-10-20 11:21:40,503 - density_analysis - INFO -   WaterMill-Density correlation: -0.020 (lag: 0 min)
2025-10-20 11:21:40,504 - density_analysis - INFO - 
Motif 4 (4 instances):
2025-10-20 11:21:40,511 - density_analysis - INFO -   Avg DensityHC change: +10.07
2025-10-20 11:21:40,511 - density_analysis - INFO -   Ore-Density correlation: +0.807 (lag: 0 min)
2025-10-20 11:21:40,511 - density_analysis - INFO -   WaterMill-Density correlation: +0.794 (lag: -0 min)
2025-10-20 11:21:40,511 - density_analysis - INFO - 
Motif 5 (2 instances):
2025-10-20 11:21:40,515 - density_analysis - INFO -   Avg DensityHC change: +2.69
2025-10-20 11:21:40,516 - density_analysis - INFO -   Ore-Density correlation: -0.260 (lag: 10 min)
2025-10-20 11:21:40,516 - density_analysis - INFO -   WaterMill-Density correlation: -0.322 (lag: 8 min)
2025-10-20 11:21:40,517 - density_analysis - INFO - 
Motif 6 (3 instances):
2025-10-20 11:21:40,522 - density_analysis - INFO -   Avg DensityHC change: +5.19
2025-10-20 11:21:40,523 - density_analysis - INFO -   Ore-Density correlation: +0.724 (lag: 4 min)
2025-10-20 11:21:40,523 - density_analysis - INFO -   WaterMill-Density correlation: +0.694 (lag: 6 min)
2025-10-20 11:21:40,523 - density_analysis - INFO - 
Motif 7 (2 instances):
2025-10-20 11:21:40,528 - density_analysis - INFO -   Avg DensityHC change: +12.84
2025-10-20 11:21:40,528 - density_analysis - INFO -   Ore-Density correlation: +0.808 (lag: 0 min)
2025-10-20 11:21:40,529 - density_analysis - INFO -   WaterMill-Density correlation: +0.975 (lag: 0 min)
2025-10-20 11:21:40,533 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:21:40,533 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-20 11:21:40,533 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:21:40,533 - segmentation - INFO - Merging motif collections...
2025-10-20 11:21:40,533 - segmentation - INFO -   Primary motifs: 20
2025-10-20 11:21:40,533 - segmentation - INFO -   Secondary motifs: 7
2025-10-20 11:21:40,536 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:21:40,537 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-20 11:21:40,537 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:21:40,537 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-20 11:21:40,587 - segmentation - INFO -     - Total segments: 96
2025-10-20 11:21:40,587 - segmentation - INFO -     - Total rows: 5760
2025-10-20 11:21:40,588 - segmentation - INFO -     - Unique motifs: 27
2025-10-20 11:21:40,775 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:21:40,775 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-20 11:21:40,775 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:21:40,775 - segmentation - INFO - Extracting motif summaries...
2025-10-20 11:21:40,790 - segmentation - INFO - Creating instance catalog...
2025-10-20 11:21:40,795 - segmentation - INFO - Calculating segment statistics...
2025-10-20 11:21:40,832 - visualization - INFO - Creating summary report...
2025-10-20 11:21:40,834 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:21:40,834 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-20 11:21:40,835 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:21:40,836 - visualization - INFO - Plotting top 10 motifs...
2025-10-20 11:21:45,803 - visualization - INFO - Creating motif overview plot...
2025-10-20 11:21:46,196 - visualization - INFO - Creating density analysis plot...
2025-10-20 11:21:46,716 - visualization - INFO - Creating correlation heatmap...
2025-10-20 11:21:47,114 - visualization - INFO - Creating feature distribution plots...
2025-10-20 11:21:48,231 - __main__ - INFO - 
================================================================================
2025-10-20 11:21:48,231 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-20 11:21:48,231 - __main__ - INFO - ================================================================================
2025-10-20 11:21:48,231 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-20 11:21:48,231 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-20 11:21:48,231 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-20 11:36:32,531 - __main__ - INFO - 
================================================================================
2025-10-20 11:36:32,532 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-20 11:36:32,532 - __main__ - INFO - ================================================================================
2025-10-20 11:36:32,532 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-09-01 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-20 11:36:32,533 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:36:32,534 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-20 11:36:32,534 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:36:32,534 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-20 11:36:32,615 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-20 11:36:32,615 - database - INFO - ✅ Database connector initialized
2025-10-20 11:36:32,615 - database - INFO - Loading data from database for Mill 6...
2025-10-20 11:36:32,617 - database - INFO -   Date range: 2025-09-01 to 2025-10-19
2025-10-20 11:36:32,617 - database - INFO -   Resample frequency: 1min
2025-10-20 11:36:32,617 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-20 11:36:32,618 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-09-01, end_date=2025-10-19
2025-10-20 11:36:32,618 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-20 11:36:32,618 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-09-01 to 2025-10-19
2025-10-20 11:36:32,618 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-09-01, end_date=2025-10-19
2025-10-20 11:36:32,618 - db.db_connector - INFO - DEBUG: Current time: 2025-10-20 11:36:32.618000
2025-10-20 11:36:32,620 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-09-01 00:00:00 (timezone: None)
2025-10-20 11:36:32,620 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-20 11:36:32,621 - db.db_connector - INFO - DEBUG: Days from now to end_date: -2
2025-10-20 11:36:32,621 - db.db_connector - INFO - DEBUG: Converted start_date 2025-09-01 -> 2025-09-01 00:00:00
2025-10-20 11:36:32,622 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-20 11:36:32,622 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-09-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-20 11:36:32,622 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-20 11:36:32,662 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-20 11:36:32,662 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-20 11:36:32,674 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-20 11:36:33,312 - db.db_connector - INFO - Retrieved 69109 rows for Mill 6
2025-10-20 11:36:33,313 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:36:33,313 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-20 11:36:33,316 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 69109
2025-10-20 11:36:33,316 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-09-01 00:00:00
2025-10-20 11:36:33,316 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-20 11:36:33,316 - db.db_connector - INFO - Mill data retrieved: 69109 rows, 13 columns
2025-10-20 11:36:33,316 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-20 11:36:33,326 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp  PSI80  PSI200
TimeStamp                                            ...                           
2025-09-01 00:00:00  176.967  14.681531   124.23800  ...  212.835485   52.0    20.5
2025-09-01 00:01:00  176.967  14.739024   124.23800  ...  209.783758   52.0    20.5
2025-09-01 00:02:00  176.967  14.716262   123.98775  ...  212.117882   52.0    20.5

[3 rows x 13 columns]
2025-10-20 11:36:33,336 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-09-01 00:00:00, end=2025-10-19 00:00:00
2025-10-20 11:36:33,336 - db.db_connector - INFO - DEBUG: Before date filtering: 69109 rows, date range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:36:33,338 - db.db_connector - INFO - DEBUG: After start date filter (2025-09-01 00:00:00): 69109 rows (removed 0 rows)
2025-10-20 11:36:33,342 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 69109 rows (removed 0 rows)
2025-10-20 11:36:33,342 - db.db_connector - INFO - DEBUG: After date filtering: 69109 rows, date range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:36:33,383 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-20 11:36:33,399 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-20 11:36:33,399 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-20 11:36:33,402 - db.db_connector - INFO - Processed mill data: 69121 rows, 13 columns
2025-10-20 11:36:33,402 - db.db_connector - INFO - Retrieving ore quality data
2025-10-20 11:36:33,402 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-09-01, end_date=2025-10-19
2025-10-20 11:36:33,403 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-09-01 00:00:00 (timezone: None)
2025-10-20 11:36:33,404 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-20 11:36:33,405 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-09-01 -> 2025-09-01 00:00:00
2025-10-20 11:36:33,406 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-20 11:36:33,406 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-09-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-20 11:36:33,408 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-20 11:36:33,408 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-20 11:36:33,411 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-20 11:36:33,412 - db.db_connector - INFO - DEBUG: ore_quality has 144 records in requested range 2025-09-01 to 2025-10-19
2025-10-20 11:36:33,416 - db.db_connector - INFO - Retrieved 144 rows of ore quality data
2025-10-20 11:36:33,417 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:36:33,417 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-20 11:36:33,419 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 144
2025-10-20 11:36:33,419 - db.db_connector - INFO - Ore data retrieved: 144 rows, 11 columns
2025-10-20 11:36:33,419 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-20 11:36:33,420 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-09-01 00:00:00, end=2025-10-19 00:00:00
2025-10-20 11:36:33,420 - db.db_connector - INFO - DEBUG: Before date filtering: 144 rows, date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:36:33,420 - db.db_connector - INFO - DEBUG: After start date filter (2025-09-01 00:00:00): 144 rows (removed 0 rows)
2025-10-20 11:36:33,421 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 144 rows (removed 0 rows)
2025-10-20 11:36:33,421 - db.db_connector - INFO - DEBUG: After date filtering: 144 rows, date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:36:33,429 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-20 11:36:33,429 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-20 11:36:33,430 - db.db_connector - INFO - Processed ore data: 68641 rows, 9 columns - with constant values (no interpolation)
2025-10-20 11:36:33,431 - db.db_connector - INFO - DF1 (mill): 69121 rows, index range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-20 11:36:33,432 - db.db_connector - INFO - DF2 (ore): 68641 rows, index range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:36:33,432 - db.db_connector - INFO - Found 68641 common timestamps
2025-10-20 11:36:33,442 - db.db_connector - INFO - Successfully joined dataframes: 68641 rows, 22 columns
2025-10-20 11:36:33,442 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-20 11:36:33,442 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:36:33,450 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 68641
2025-10-20 11:36:33,450 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 68641 records
2025-10-20 11:36:33,450 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-20 11:36:33,454 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                                
2025-09-01 06:00:00  176.898480  14.730702     124.742  2042.187456  1602.319027    0.403065  1659.355988  3.207067  408.527603  674.914692  214.507862  50.823137  21.869804  730   NaN      1       0.6       5.6  0.668  0.273   0.059             NaN
2025-09-01 06:01:00  176.972747  14.721150     124.742  2040.682737  1601.375441    0.402159  1659.329429  3.203933  408.009086  674.898307  214.330872  50.983137  21.689804  730   NaN      1       0.6       5.6  0.668  0.273   0.059             NaN
2025-09-01 06:02:00  176.979680  14.716917     124.742  2039.980160  1603.366318    0.404820  1659.289190  3.200800  408.823780  675.810809  214.308859  51.077804  21.584471  730   NaN      1       0.6       5.6  0.668  0.273   0.059             NaN
2025-10-20 11:36:33,454 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-20 11:36:33,458 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-20 11:36:33,458 - db.db_connector - INFO - ==================================================
2025-10-20 11:36:33,461 - db.db_connector - INFO - Combined data has 68641 rows and 22 columns
2025-10-20 11:36:33,461 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-20 11:36:33,470 - db.db_connector - INFO - Combined data sample:
                            Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                               ...                               
2025-09-01 06:00:00  176.898480  14.730702     124.742  ...  0.273   0.059             NaN
2025-09-01 06:01:00  176.972747  14.721150     124.742  ...  0.273   0.059             NaN
2025-09-01 06:02:00  176.979680  14.716917     124.742  ...  0.273   0.059             NaN

[3 rows x 22 columns]
2025-10-20 11:36:33,470 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-20 11:36:33,471 - db.db_connector - INFO - DEBUG: Final result - 68641 total records
2025-10-20 11:36:33,472 - db.db_connector - INFO - DEBUG: Final date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-20 11:36:33,498 - database - INFO -   ✓ Loaded 68641 rows, 24 columns
2025-10-20 11:36:34,361 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-20 11:36:34,362 - database - INFO - ✓ All 11 required columns present
2025-10-20 11:36:34,362 - database - INFO - Applying data filters...
2025-10-20 11:36:34,365 - database - INFO -   Ore: 100 < x < 220
2025-10-20 11:36:34,366 - database - INFO -   PulpHC: 400 < x < 600
2025-10-20 11:36:34,366 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-20 11:36:34,374 - database - INFO -   ✓ Filtered: 66100 rows kept, 2541 removed (3.7%)
2025-10-20 11:36:34,375 - __main__ - INFO - ✓ Data loaded and filtered: 66100 rows
2025-10-20 11:36:34,375 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:36:34,375 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-20 11:36:34,375 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:36:34,375 - motif_discovery - INFO - Discovering motifs in 4 features...
2025-10-20 11:36:34,375 - motif_discovery - INFO -   Window size: 60
2025-10-20 11:36:34,375 - motif_discovery - INFO -   Max motifs: 20
2025-10-20 11:36:34,375 - motif_discovery - INFO -   Radius: 4.5
2025-10-20 11:36:34,377 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-20 11:39:49,022 - motif_discovery - INFO -   Discovering motif groups...
2025-10-20 11:39:51,714 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-20 11:39:51,714 - motif_discovery - INFO -   ✓ Total instances: 108
2025-10-20 11:39:51,715 - motif_discovery - INFO -   ✓ Average distance: 2.192
2025-10-20 11:39:51,715 - __main__ - INFO - 
Applying correlation filter...
2025-10-20 11:39:51,715 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-20 11:39:51,716 - motif_discovery - INFO -   Filter level: instance
2025-10-20 11:39:51,716 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-20 11:39:51,716 - motif_discovery - INFO -   Rules:
2025-10-20 11:39:51,716 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-20 11:39:51,716 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-20 11:39:51,717 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-20 11:39:51,718 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-20 11:39:51,718 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-20 11:39:51,719 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:39:51,719 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-20 11:39:51,719 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:39:51,719 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-20 11:39:51,719 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-20 11:39:51,719 - density_analysis - INFO -   Window size: 60 minutes
2025-10-20 11:39:51,719 - density_analysis - INFO -   Max motifs: 15
2025-10-20 11:39:51,719 - density_analysis - INFO -   Radius: 4.5
2025-10-20 11:39:51,720 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-20 11:42:19,681 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-20 11:43:45,180 - density_analysis - INFO -   ✓ Found 8 motif groups
2025-10-20 11:43:45,180 - density_analysis - INFO -   ✓ Total instances: 32
2025-10-20 11:43:45,182 - __main__ - INFO - ✓ Density motif discovery complete: 8 motifs
2025-10-20 11:43:45,182 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:43:45,182 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-20 11:43:45,182 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:43:45,182 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-20 11:43:45,182 - density_analysis - INFO - 
Motif 1 (12 instances):
2025-10-20 11:43:45,207 - density_analysis - INFO -   Avg DensityHC change: +0.02
2025-10-20 11:43:45,207 - density_analysis - INFO -   Ore-Density correlation: -0.123 (lag: 0 min)
2025-10-20 11:43:45,207 - density_analysis - INFO -   WaterMill-Density correlation: -0.135 (lag: 0 min)
2025-10-20 11:43:45,207 - density_analysis - INFO - 
Motif 2 (4 instances):
2025-10-20 11:43:45,215 - density_analysis - INFO -   Avg DensityHC change: -4.34
2025-10-20 11:43:45,215 - density_analysis - INFO -   Ore-Density correlation: +0.240 (lag: -8 min)
2025-10-20 11:43:45,216 - density_analysis - INFO -   WaterMill-Density correlation: +0.354 (lag: -4 min)
2025-10-20 11:43:45,216 - density_analysis - INFO - 
Motif 3 (2 instances):
2025-10-20 11:43:45,221 - density_analysis - INFO -   Avg DensityHC change: +16.30
2025-10-20 11:43:45,221 - density_analysis - INFO -   Ore-Density correlation: -0.836 (lag: 2 min)
2025-10-20 11:43:45,221 - density_analysis - INFO -   WaterMill-Density correlation: -0.791 (lag: 2 min)
2025-10-20 11:43:45,222 - density_analysis - INFO - 
Motif 4 (4 instances):
2025-10-20 11:43:45,230 - density_analysis - INFO -   Avg DensityHC change: -3.51
2025-10-20 11:43:45,230 - density_analysis - INFO -   Ore-Density correlation: +0.369 (lag: -2 min)
2025-10-20 11:43:45,230 - density_analysis - INFO -   WaterMill-Density correlation: +0.395 (lag: 0 min)
2025-10-20 11:43:45,230 - density_analysis - INFO - 
Motif 5 (3 instances):
2025-10-20 11:43:45,237 - density_analysis - INFO -   Avg DensityHC change: +3.98
2025-10-20 11:43:45,237 - density_analysis - INFO -   Ore-Density correlation: -0.013 (lag: 0 min)
2025-10-20 11:43:45,237 - density_analysis - INFO -   WaterMill-Density correlation: -0.155 (lag: 0 min)
2025-10-20 11:43:45,238 - density_analysis - INFO - 
Motif 6 (3 instances):
2025-10-20 11:43:45,244 - density_analysis - INFO -   Avg DensityHC change: +7.83
2025-10-20 11:43:45,244 - density_analysis - INFO -   Ore-Density correlation: +0.766 (lag: 0 min)
2025-10-20 11:43:45,244 - density_analysis - INFO -   WaterMill-Density correlation: +0.747 (lag: -1 min)
2025-10-20 11:43:45,244 - density_analysis - INFO - 
Motif 7 (2 instances):
2025-10-20 11:43:45,248 - density_analysis - INFO -   Avg DensityHC change: +2.69
2025-10-20 11:43:45,248 - density_analysis - INFO -   Ore-Density correlation: -0.260 (lag: 10 min)
2025-10-20 11:43:45,249 - density_analysis - INFO -   WaterMill-Density correlation: -0.322 (lag: 8 min)
2025-10-20 11:43:45,249 - density_analysis - INFO - 
Motif 8 (2 instances):
2025-10-20 11:43:45,253 - density_analysis - INFO -   Avg DensityHC change: -13.34
2025-10-20 11:43:45,253 - density_analysis - INFO -   Ore-Density correlation: +0.632 (lag: -8 min)
2025-10-20 11:43:45,253 - density_analysis - INFO -   WaterMill-Density correlation: -0.804 (lag: -4 min)
2025-10-20 11:43:45,255 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-20 11:43:45,256 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:43:45,256 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-20 11:43:45,256 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:43:45,256 - segmentation - INFO - Merging motif collections...
2025-10-20 11:43:45,256 - segmentation - INFO -   Primary motifs: 20
2025-10-20 11:43:45,257 - segmentation - INFO -   Secondary motifs: 8
2025-10-20 11:43:45,257 - segmentation - INFO -   ✓ Merged: 28 total motifs
2025-10-20 11:43:45,257 - __main__ - INFO - ✓ Total motifs: 28
2025-10-20 11:43:45,258 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:43:45,258 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-20 11:43:45,258 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:43:45,258 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-20 11:43:45,258 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-20 11:43:45,308 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-20 11:43:45,308 - segmentation - INFO -     - Total segments: 108
2025-10-20 11:43:45,308 - segmentation - INFO -     - Total rows: 6480
2025-10-20 11:43:45,309 - segmentation - INFO -     - Unique motifs: 20
2025-10-20 11:43:45,310 - __main__ - INFO -   Creating complete dataset (28 motifs)...
2025-10-20 11:43:45,310 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-20 11:43:45,373 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-20 11:43:45,374 - segmentation - INFO -     - Total segments: 140
2025-10-20 11:43:45,375 - segmentation - INFO -     - Total rows: 8400
2025-10-20 11:43:45,375 - segmentation - INFO -     - Unique motifs: 28
2025-10-20 11:43:45,470 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV.csv (6480 rows)
2025-10-20 11:43:45,595 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all.csv (8400 rows)
2025-10-20 11:43:45,596 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:43:45,596 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-20 11:43:45,596 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:43:45,597 - segmentation - INFO - Extracting motif summaries...
2025-10-20 11:43:45,615 - segmentation - INFO -   ✓ Created summary for 28 motifs
2025-10-20 11:43:45,617 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-20 11:43:45,617 - segmentation - INFO - Creating instance catalog...
2025-10-20 11:43:45,619 - segmentation - INFO -   ✓ Cataloged 140 instances
2025-10-20 11:43:45,620 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-20 11:43:45,620 - segmentation - INFO - Calculating segment statistics...
2025-10-20 11:43:45,650 - segmentation - INFO -   ✓ Calculated statistics for 28 motifs
2025-10-20 11:43:45,652 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-20 11:43:45,653 - visualization - INFO - Creating summary report...
2025-10-20 11:43:45,653 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-20 11:43:45,653 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 11:43:45,653 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-20 11:43:45,653 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 11:43:45,653 - visualization - INFO - Plotting top 10 motifs...
2025-10-20 11:43:46,146 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-20 11:43:46,656 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-20 11:43:47,202 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-20 11:43:47,705 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-20 11:43:48,180 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-20 11:43:48,608 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-20 11:43:49,056 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-20 11:43:49,494 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-20 11:43:49,991 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-20 11:43:50,414 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-20 11:43:50,414 - visualization - INFO - Creating motif overview plot...
2025-10-20 11:43:50,909 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-20 11:43:50,909 - visualization - INFO - Creating density analysis plot...
2025-10-20 11:43:51,451 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-20 11:43:51,451 - visualization - INFO - Creating correlation heatmap...
2025-10-20 11:43:51,733 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-20 11:43:51,733 - visualization - INFO - Creating feature distribution plots...
2025-10-20 11:43:52,873 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-20 11:43:52,874 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_6
2025-10-20 11:43:52,875 - __main__ - INFO - 
================================================================================
2025-10-20 11:43:52,875 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-20 11:43:52,875 - __main__ - INFO - ================================================================================
2025-10-20 11:43:52,875 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-20 11:43:52,876 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-20 11:43:52,876 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-20 11:43:52,876 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-20 16:07:23,315 - __main__ - INFO - 
================================================================================
2025-10-20 16:07:23,315 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-20 16:07:23,315 - __main__ - INFO - ================================================================================
2025-10-20 16:07:23,316 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-06-20 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-20 16:07:23,316 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 16:07:23,317 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-20 16:07:23,317 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 16:07:23,319 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-20 16:07:23,440 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-20 16:07:23,441 - database - INFO - ✅ Database connector initialized
2025-10-20 16:07:23,442 - database - INFO - Loading data from database for Mill 6...
2025-10-20 16:07:23,442 - database - INFO -   Date range: 2025-06-20 to 2025-10-19
2025-10-20 16:07:23,442 - database - INFO -   Resample frequency: 1min
2025-10-20 16:07:23,442 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-20 16:07:23,443 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-06-20, end_date=2025-10-19
2025-10-20 16:07:23,443 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-20 16:07:23,444 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-06-20 to 2025-10-19
2025-10-20 16:07:23,444 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-06-20, end_date=2025-10-19
2025-10-20 16:07:23,444 - db.db_connector - INFO - DEBUG: Current time: 2025-10-20 16:07:23.444185
2025-10-20 16:07:23,445 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-06-20 00:00:00 (timezone: None)
2025-10-20 16:07:23,446 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-20 16:07:23,446 - db.db_connector - INFO - DEBUG: Days from now to end_date: -2
2025-10-20 16:07:23,447 - db.db_connector - INFO - DEBUG: Converted start_date 2025-06-20 -> 2025-06-20 00:00:00
2025-10-20 16:07:23,448 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-20 16:07:23,448 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-06-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-20 16:07:23,448 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-20 16:07:23,491 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-20 16:07:23,492 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-20 16:07:23,507 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-20 16:07:25,116 - db.db_connector - INFO - Retrieved 174217 rows for Mill 6
2025-10-20 16:07:25,116 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-06-20 00:00:00 to 2025-10-19 00:00:00
2025-10-20 16:07:25,116 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-20 16:07:25,124 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 97134
2025-10-20 16:07:25,125 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-12 12:55:00
2025-10-20 16:07:25,125 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-20 16:07:25,126 - db.db_connector - INFO - Mill data retrieved: 174217 rows, 13 columns
2025-10-20 16:07:25,126 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-20 16:07:25,136 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp  PSI80  PSI200
TimeStamp                                            ...                           
2025-06-20 00:00:00  180.206  11.794122  106.993529  ...  204.864017   51.2    23.1
2025-06-20 00:01:00  180.206  11.774821  112.506833  ...  206.175800   51.2    23.1
2025-06-20 00:02:00  180.206  11.781091  126.096154  ...  202.628939   51.2    23.1

[3 rows x 13 columns]
2025-10-20 16:07:25,146 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-06-20 00:00:00, end=2025-10-19 00:00:00
2025-10-20 16:07:25,146 - db.db_connector - INFO - DEBUG: Before date filtering: 174217 rows, date range: 2025-06-20 00:00:00 to 2025-10-19 00:00:00
2025-10-20 16:07:25,150 - db.db_connector - INFO - DEBUG: After start date filter (2025-06-20 00:00:00): 174217 rows (removed 0 rows)
2025-10-20 16:07:25,155 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 174217 rows (removed 0 rows)
2025-10-20 16:07:25,156 - db.db_connector - INFO - DEBUG: After date filtering: 174217 rows, date range: 2025-06-20 00:00:00 to 2025-10-19 00:00:00
2025-10-20 16:07:25,278 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-20 16:07:25,339 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-20 16:07:25,339 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-20 16:07:25,344 - db.db_connector - INFO - Processed mill data: 174241 rows, 13 columns
2025-10-20 16:07:25,344 - db.db_connector - INFO - Retrieving ore quality data
2025-10-20 16:07:25,345 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-06-20, end_date=2025-10-19
2025-10-20 16:07:25,346 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-06-20 00:00:00 (timezone: None)
2025-10-20 16:07:25,346 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-20 16:07:25,347 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-06-20 -> 2025-06-20 00:00:00
2025-10-20 16:07:25,347 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-20 16:07:25,347 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-06-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-20 16:07:25,350 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-20 16:07:25,350 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-20 16:07:25,353 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-20 16:07:25,355 - db.db_connector - INFO - DEBUG: ore_quality has 363 records in requested range 2025-06-20 to 2025-10-19
2025-10-20 16:07:25,360 - db.db_connector - INFO - Retrieved 363 rows of ore quality data
2025-10-20 16:07:25,361 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-06-20 06:00:00 to 2025-10-18 22:00:00
2025-10-20 16:07:25,362 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-20 16:07:25,363 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 203
2025-10-20 16:07:25,363 - db.db_connector - INFO - Ore data retrieved: 363 rows, 11 columns
2025-10-20 16:07:25,363 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-20 16:07:25,363 - db.db_connector - WARNING - Found 3 duplicate timestamps, removing duplicates
2025-10-20 16:07:25,365 - db.db_connector - INFO - After removing duplicates: 360 rows remaining
2025-10-20 16:07:25,366 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-06-20 00:00:00, end=2025-10-19 00:00:00
2025-10-20 16:07:25,366 - db.db_connector - INFO - DEBUG: Before date filtering: 360 rows, date range: 2025-06-20 06:00:00 to 2025-10-18 22:00:00
2025-10-20 16:07:25,366 - db.db_connector - INFO - DEBUG: After start date filter (2025-06-20 00:00:00): 360 rows (removed 0 rows)
2025-10-20 16:07:25,367 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 360 rows (removed 0 rows)
2025-10-20 16:07:25,367 - db.db_connector - INFO - DEBUG: After date filtering: 360 rows, date range: 2025-06-20 06:00:00 to 2025-10-18 22:00:00
2025-10-20 16:07:25,386 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-20 16:07:25,386 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-20 16:07:25,391 - db.db_connector - INFO - Processed ore data: 173761 rows, 9 columns - with constant values (no interpolation)
2025-10-20 16:07:25,392 - db.db_connector - INFO - DF1 (mill): 174241 rows, index range: 2025-06-20 00:00:00 to 2025-10-19 00:00:00
2025-10-20 16:07:25,392 - db.db_connector - INFO - DF2 (ore): 173761 rows, index range: 2025-06-20 06:00:00 to 2025-10-18 22:00:00
2025-10-20 16:07:25,393 - db.db_connector - INFO - Found 173761 common timestamps
2025-10-20 16:07:25,420 - db.db_connector - INFO - Successfully joined dataframes: 173761 rows, 22 columns
2025-10-20 16:07:25,420 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-20 16:07:25,421 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-06-20 06:00:00 to 2025-10-18 22:00:00
2025-10-20 16:07:25,428 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 97026
2025-10-20 16:07:25,429 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 97026 records
2025-10-20 16:07:25,429 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-20 16:07:25,432 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp  PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                            
2025-06-20 06:00:00  181.218104  11.655761  158.159245  1900.735656  1594.930557    0.472994  1683.994011  3.701667  541.967375  681.245661  202.064894   52.4  21.650735  511   NaN      1       0.5       6.8  0.761  0.205   0.034             NaN
2025-06-20 06:01:00  181.258704  11.652142  158.282073  1901.453020  1594.678661    0.472982  1684.240900  3.697333  541.621416  681.132927  202.185786   52.4  21.621569  511   NaN      1       0.5       6.8  0.761  0.205   0.034             NaN
2025-06-20 06:02:00  181.299304  11.647124  158.646518  1901.829305  1595.334152    0.472981  1684.280382  3.696933  541.445879  681.028164  202.123270   52.4  21.574902  511   NaN      1       0.5       6.8  0.761  0.205   0.034             NaN
2025-10-20 16:07:25,432 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-20 16:07:25,435 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-20 16:07:25,436 - db.db_connector - INFO - ==================================================
2025-10-20 16:07:25,439 - db.db_connector - INFO - Combined data has 173761 rows and 22 columns
2025-10-20 16:07:25,440 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-20 16:07:25,450 - db.db_connector - INFO - Combined data sample:
                            Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                               ...                               
2025-06-20 06:00:00  181.218104  11.655761  158.159245  ...  0.205   0.034             NaN
2025-06-20 06:01:00  181.258704  11.652142  158.282073  ...  0.205   0.034             NaN
2025-06-20 06:02:00  181.299304  11.647124  158.646518  ...  0.205   0.034             NaN

[3 rows x 22 columns]
2025-10-20 16:07:25,451 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-20 16:07:25,452 - db.db_connector - INFO - DEBUG: Final result - 173761 total records
2025-10-20 16:07:25,452 - db.db_connector - INFO - DEBUG: Final date range: 2025-06-20 06:00:00 to 2025-10-18 22:00:00
2025-10-20 16:07:25,500 - database - INFO -   ✓ Loaded 173761 rows, 24 columns
2025-10-20 16:07:27,662 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-20 16:07:27,662 - database - INFO - ✓ All 11 required columns present
2025-10-20 16:07:27,663 - database - INFO - Applying data filters...
2025-10-20 16:07:27,669 - database - INFO -   Ore: 100 < x < 220
2025-10-20 16:07:27,671 - database - INFO -   PulpHC: 400 < x < 600
2025-10-20 16:07:27,671 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-20 16:07:27,689 - database - INFO -   ✓ Filtered: 163070 rows kept, 10691 removed (6.2%)
2025-10-20 16:07:27,691 - __main__ - INFO - ✓ Data loaded and filtered: 163070 rows
2025-10-20 16:07:27,692 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 16:07:27,692 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-20 16:07:27,692 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 16:07:27,692 - motif_discovery - INFO - Discovering motifs in 4 features...
2025-10-20 16:07:27,692 - motif_discovery - INFO -   Window size: 60
2025-10-20 16:07:27,692 - motif_discovery - INFO -   Max motifs: 20
2025-10-20 16:07:27,692 - motif_discovery - INFO -   Radius: 4.5
2025-10-20 16:07:27,700 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-20 16:35:55,718 - motif_discovery - INFO -   Discovering motif groups...
2025-10-20 16:36:01,317 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-20 16:36:01,317 - motif_discovery - INFO -   ✓ Total instances: 227
2025-10-20 16:36:01,317 - motif_discovery - INFO -   ✓ Average distance: 2.836
2025-10-20 16:36:01,317 - __main__ - INFO - 
Applying correlation filter...
2025-10-20 16:36:01,319 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-20 16:36:01,319 - motif_discovery - INFO -   Filter level: instance
2025-10-20 16:36:01,319 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-20 16:36:01,319 - motif_discovery - INFO -   Rules:
2025-10-20 16:36:01,319 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-20 16:36:01,319 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-20 16:36:01,321 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-20 16:36:01,322 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-20 16:36:01,322 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-20 16:36:01,323 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 16:36:01,323 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-20 16:36:01,323 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 16:36:01,323 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-20 16:36:01,323 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-20 16:36:01,323 - density_analysis - INFO -   Window size: 60 minutes
2025-10-20 16:36:01,323 - density_analysis - INFO -   Max motifs: 15
2025-10-20 16:36:01,323 - density_analysis - INFO -   Radius: 4.5
2025-10-20 16:36:01,330 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-20 16:57:04,302 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-20 17:00:51,299 - density_analysis - INFO -   ✓ Found 9 motif groups
2025-10-20 17:00:51,300 - density_analysis - INFO -   ✓ Total instances: 55
2025-10-20 17:00:51,302 - __main__ - INFO - ✓ Density motif discovery complete: 9 motifs
2025-10-20 17:00:51,302 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 17:00:51,302 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-20 17:00:51,302 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 17:00:51,302 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-20 17:00:51,302 - density_analysis - INFO - 
Motif 1 (13 instances):
2025-10-20 17:00:51,336 - density_analysis - INFO -   Avg DensityHC change: +0.07
2025-10-20 17:00:51,336 - density_analysis - INFO -   Ore-Density correlation: -0.111 (lag: 0 min)
2025-10-20 17:00:51,336 - density_analysis - INFO -   WaterMill-Density correlation: -0.124 (lag: 0 min)
2025-10-20 17:00:51,336 - density_analysis - INFO - 
Motif 2 (13 instances):
2025-10-20 17:00:51,360 - density_analysis - INFO -   Avg DensityHC change: -1.06
2025-10-20 17:00:51,360 - density_analysis - INFO -   Ore-Density correlation: +0.349 (lag: 0 min)
2025-10-20 17:00:51,361 - density_analysis - INFO -   WaterMill-Density correlation: +0.316 (lag: 0 min)
2025-10-20 17:00:51,361 - density_analysis - INFO - 
Motif 3 (4 instances):
2025-10-20 17:00:51,368 - density_analysis - INFO -   Avg DensityHC change: -3.36
2025-10-20 17:00:51,368 - density_analysis - INFO -   Ore-Density correlation: +0.496 (lag: -7 min)
2025-10-20 17:00:51,370 - density_analysis - INFO -   WaterMill-Density correlation: -0.399 (lag: -8 min)
2025-10-20 17:00:51,370 - density_analysis - INFO - 
Motif 4 (2 instances):
2025-10-20 17:00:51,373 - density_analysis - INFO -   Avg DensityHC change: +35.41
2025-10-20 17:00:51,373 - density_analysis - INFO -   Ore-Density correlation: +0.110 (lag: -1 min)
2025-10-20 17:00:51,373 - density_analysis - INFO -   WaterMill-Density correlation: +0.061 (lag: -0 min)
2025-10-20 17:00:51,374 - density_analysis - INFO - 
Motif 5 (6 instances):
2025-10-20 17:00:51,389 - density_analysis - INFO -   Avg DensityHC change: -2.86
2025-10-20 17:00:51,389 - density_analysis - INFO -   Ore-Density correlation: -0.099 (lag: 10 min)
2025-10-20 17:00:51,389 - density_analysis - INFO -   WaterMill-Density correlation: -0.082 (lag: 11 min)
2025-10-20 17:00:51,389 - density_analysis - INFO - 
Motif 6 (5 instances):
2025-10-20 17:00:51,399 - density_analysis - INFO -   Avg DensityHC change: -6.24
2025-10-20 17:00:51,399 - density_analysis - INFO -   Ore-Density correlation: -0.010 (lag: 0 min)
2025-10-20 17:00:51,399 - density_analysis - INFO -   WaterMill-Density correlation: -0.073 (lag: 0 min)
2025-10-20 17:00:51,399 - density_analysis - INFO - 
Motif 7 (3 instances):
2025-10-20 17:00:51,405 - density_analysis - INFO -   Avg DensityHC change: -7.00
2025-10-20 17:00:51,405 - density_analysis - INFO -   Ore-Density correlation: +0.223 (lag: -5 min)
2025-10-20 17:00:51,406 - density_analysis - INFO -   WaterMill-Density correlation: +0.285 (lag: -5 min)
2025-10-20 17:00:51,406 - density_analysis - INFO - 
Motif 8 (7 instances):
2025-10-20 17:00:51,418 - density_analysis - INFO -   Avg DensityHC change: +4.24
2025-10-20 17:00:51,418 - density_analysis - INFO -   Ore-Density correlation: +0.057 (lag: 0 min)
2025-10-20 17:00:51,418 - density_analysis - INFO -   WaterMill-Density correlation: +0.022 (lag: 0 min)
2025-10-20 17:00:51,418 - density_analysis - INFO - 
Motif 9 (2 instances):
2025-10-20 17:00:51,423 - density_analysis - INFO -   Avg DensityHC change: -4.31
2025-10-20 17:00:51,423 - density_analysis - INFO -   Ore-Density correlation: +0.939 (lag: 0 min)
2025-10-20 17:00:51,423 - density_analysis - INFO -   WaterMill-Density correlation: -0.957 (lag: -0 min)
2025-10-20 17:00:51,425 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-20 17:00:51,425 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 17:00:51,426 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-20 17:00:51,426 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 17:00:51,426 - segmentation - INFO - Merging motif collections...
2025-10-20 17:00:51,427 - segmentation - INFO -   Primary motifs: 20
2025-10-20 17:00:51,427 - segmentation - INFO -   Secondary motifs: 9
2025-10-20 17:00:51,427 - segmentation - INFO -   ✓ Merged: 29 total motifs
2025-10-20 17:00:51,427 - __main__ - INFO - ✓ Total motifs: 29
2025-10-20 17:00:51,428 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 17:00:51,428 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-20 17:00:51,428 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 17:00:51,428 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-20 17:00:51,428 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-20 17:00:51,547 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-20 17:00:51,549 - segmentation - INFO -     - Total segments: 227
2025-10-20 17:00:51,549 - segmentation - INFO -     - Total rows: 13620
2025-10-20 17:00:51,550 - segmentation - INFO -     - Unique motifs: 20
2025-10-20 17:00:51,550 - __main__ - INFO -   Creating complete dataset (29 motifs)...
2025-10-20 17:00:51,550 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-20 17:00:51,778 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-20 17:00:51,778 - segmentation - INFO -     - Total segments: 282
2025-10-20 17:00:51,779 - segmentation - INFO -     - Total rows: 16920
2025-10-20 17:00:51,779 - segmentation - INFO -     - Unique motifs: 29
2025-10-20 17:00:51,973 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV.csv (13620 rows)
2025-10-20 17:00:52,231 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all.csv (16920 rows)
2025-10-20 17:00:52,233 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 17:00:52,233 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-20 17:00:52,234 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 17:00:52,234 - segmentation - INFO - Extracting motif summaries...
2025-10-20 17:00:52,248 - segmentation - INFO -   ✓ Created summary for 29 motifs
2025-10-20 17:00:52,250 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-20 17:00:52,250 - segmentation - INFO - Creating instance catalog...
2025-10-20 17:00:52,255 - segmentation - INFO -   ✓ Cataloged 282 instances
2025-10-20 17:00:52,258 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-20 17:00:52,258 - segmentation - INFO - Calculating segment statistics...
2025-10-20 17:00:52,295 - segmentation - INFO -   ✓ Calculated statistics for 29 motifs
2025-10-20 17:00:52,297 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-20 17:00:52,297 - visualization - INFO - Creating summary report...
2025-10-20 17:00:52,299 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-20 17:00:52,299 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-20 17:00:52,299 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-20 17:00:52,299 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-20 17:00:52,299 - visualization - INFO - Plotting top 10 motifs...
2025-10-20 17:00:53,171 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-20 17:00:53,670 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-20 17:00:54,184 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-20 17:00:54,696 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-20 17:00:55,179 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-20 17:00:55,684 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-20 17:00:56,312 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-20 17:00:56,771 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-20 17:00:57,239 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-20 17:00:57,699 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-20 17:00:57,699 - visualization - INFO - Creating motif overview plot...
2025-10-20 17:00:58,102 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-20 17:00:58,102 - visualization - INFO - Creating density analysis plot...
2025-10-20 17:00:58,603 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-20 17:00:58,603 - visualization - INFO - Creating correlation heatmap...
2025-10-20 17:00:58,895 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-20 17:00:58,895 - visualization - INFO - Creating feature distribution plots...
2025-10-20 17:01:00,225 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-20 17:01:00,227 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_6
2025-10-20 17:01:00,227 - __main__ - INFO - 
================================================================================
2025-10-20 17:01:00,227 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-20 17:01:00,227 - __main__ - INFO - ================================================================================
2025-10-20 17:01:00,228 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-20 17:01:00,228 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-20 17:01:00,228 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-20 17:01:00,228 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-21 09:10:29,143 - __main__ - INFO - 
================================================================================
2025-10-21 09:10:29,143 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-21 09:10:29,143 - __main__ - INFO - ================================================================================
2025-10-21 09:10:29,144 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-08-20 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-21 09:10:29,144 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:10:29,144 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-21 09:10:29,144 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:10:29,144 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-21 09:10:29,273 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-21 09:10:29,274 - database - INFO - ✅ Database connector initialized
2025-10-21 09:10:29,275 - database - INFO - Loading data from database for Mill 6...
2025-10-21 09:10:29,275 - database - INFO -   Date range: 2025-08-20 to 2025-10-19
2025-10-21 09:10:29,276 - database - INFO -   Resample frequency: 1min
2025-10-21 09:10:29,276 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-21 09:10:29,276 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 09:10:29,276 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-21 09:10:29,276 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-08-20 to 2025-10-19
2025-10-21 09:10:29,276 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 09:10:29,276 - db.db_connector - INFO - DEBUG: Current time: 2025-10-21 09:10:29.276675
2025-10-21 09:10:29,278 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 09:10:29,279 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 09:10:29,280 - db.db_connector - INFO - DEBUG: Days from now to end_date: -3
2025-10-21 09:10:29,280 - db.db_connector - INFO - DEBUG: Converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 09:10:29,281 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 09:10:29,281 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 09:10:29,281 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-21 09:10:29,327 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-21 09:10:29,328 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-21 09:10:29,345 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-21 09:10:30,070 - db.db_connector - INFO - Retrieved 86389 rows for Mill 6
2025-10-21 09:10:30,071 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 09:10:30,072 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-21 09:10:30,075 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 86389
2025-10-21 09:10:30,076 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-20 00:00:00
2025-10-21 09:10:30,077 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-21 09:10:30,078 - db.db_connector - INFO - Mill data retrieved: 86389 rows, 13 columns
2025-10-21 09:10:30,078 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-21 09:10:30,090 - db.db_connector - INFO - Mill data sample:
                            Ore  WaterMill  WaterZumpf  ...    MotorAmp      PSI80     PSI200
TimeStamp                                               ...                                  
2025-08-20 00:00:00  181.557000  16.865936  142.967267  ...  210.442672  52.000000  20.900000
2025-08-20 00:01:00  181.557000  16.904759  181.702737  ...  211.614935  52.000000  20.900000
2025-08-20 00:02:00  182.285591  16.968104  133.898571  ...  206.307136  51.216327  21.781633

[3 rows x 13 columns]
2025-10-21 09:10:30,100 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 09:10:30,101 - db.db_connector - INFO - DEBUG: Before date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 09:10:30,103 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 09:10:30,106 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 09:10:30,107 - db.db_connector - INFO - DEBUG: After date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 09:10:30,158 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-21 09:10:30,178 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-21 09:10:30,178 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 09:10:30,181 - db.db_connector - INFO - Processed mill data: 86401 rows, 13 columns
2025-10-21 09:10:30,181 - db.db_connector - INFO - Retrieving ore quality data
2025-10-21 09:10:30,181 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-08-20, end_date=2025-10-19
2025-10-21 09:10:30,182 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 09:10:30,182 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 09:10:30,182 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 09:10:30,184 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 09:10:30,184 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 09:10:30,188 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-21 09:10:30,188 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-21 09:10:30,192 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-21 09:10:30,194 - db.db_connector - INFO - DEBUG: ore_quality has 180 records in requested range 2025-08-20 to 2025-10-19
2025-10-21 09:10:30,200 - db.db_connector - INFO - Retrieved 180 rows of ore quality data
2025-10-21 09:10:30,201 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 09:10:30,201 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-21 09:10:30,203 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 180
2025-10-21 09:10:30,203 - db.db_connector - INFO - Ore data retrieved: 180 rows, 11 columns
2025-10-21 09:10:30,203 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-21 09:10:30,205 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 09:10:30,205 - db.db_connector - INFO - DEBUG: Before date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 09:10:30,205 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 180 rows (removed 0 rows)
2025-10-21 09:10:30,205 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 180 rows (removed 0 rows)
2025-10-21 09:10:30,205 - db.db_connector - INFO - DEBUG: After date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 09:10:30,215 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-21 09:10:30,216 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 09:10:30,218 - db.db_connector - INFO - Processed ore data: 85921 rows, 9 columns - with constant values (no interpolation)
2025-10-21 09:10:30,218 - db.db_connector - INFO - DF1 (mill): 86401 rows, index range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 09:10:30,219 - db.db_connector - INFO - DF2 (ore): 85921 rows, index range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 09:10:30,219 - db.db_connector - INFO - Found 85921 common timestamps
2025-10-21 09:10:30,231 - db.db_connector - INFO - Successfully joined dataframes: 85921 rows, 22 columns
2025-10-21 09:10:30,232 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 09:10:30,232 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 09:10:30,241 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 85921
2025-10-21 09:10:30,242 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 85921 records
2025-10-21 09:10:30,242 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-21 09:10:30,246 - db.db_connector - INFO -                         Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                            
2025-08-20 06:00:00  183.86  17.055654  160.167630  1996.986947  1599.186917    0.474443  1665.372881  3.823867  554.752728  703.051266  210.112138  50.891828  22.068006  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:01:00  183.86  17.042846  162.262963  1995.476894  1598.304249    0.474109  1665.749170  3.824933  554.565172  703.179260  209.921031  50.865161  22.094672  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:02:00  183.86  17.037084  162.091912  1993.315325  1600.078242    0.473947  1665.613778  3.829667  554.971853  703.383504  209.622913  50.838495  22.121339  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-10-21 09:10:30,247 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-21 09:10:30,250 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-21 09:10:30,250 - db.db_connector - INFO - ==================================================
2025-10-21 09:10:30,253 - db.db_connector - INFO - Combined data has 85921 rows and 22 columns
2025-10-21 09:10:30,253 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 09:10:30,264 - db.db_connector - INFO - Combined data sample:
                        Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                           ...                               
2025-08-20 06:00:00  183.86  17.055654  160.167630  ...  0.208   0.054             NaN
2025-08-20 06:01:00  183.86  17.042846  162.262963  ...  0.208   0.054             NaN
2025-08-20 06:02:00  183.86  17.037084  162.091912  ...  0.208   0.054             NaN

[3 rows x 22 columns]
2025-10-21 09:10:30,264 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-21 09:10:30,264 - db.db_connector - INFO - DEBUG: Final result - 85921 total records
2025-10-21 09:10:30,264 - db.db_connector - INFO - DEBUG: Final date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 09:10:30,293 - database - INFO -   ✓ Loaded 85921 rows, 24 columns
2025-10-21 09:10:31,570 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-21 09:10:31,570 - database - INFO - ✓ All 11 required columns present
2025-10-21 09:10:31,570 - database - INFO - Applying data filters...
2025-10-21 09:10:31,575 - database - INFO -   Ore: 100 < x < 220
2025-10-21 09:10:31,575 - database - INFO -   PulpHC: 400 < x < 600
2025-10-21 09:10:31,576 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-21 09:10:31,585 - database - INFO -   ✓ Filtered: 82985 rows kept, 2936 removed (3.4%)
2025-10-21 09:10:31,586 - __main__ - INFO - ✓ Data loaded and filtered: 82985 rows
2025-10-21 09:10:31,586 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:10:31,586 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-21 09:10:31,587 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:10:31,587 - motif_discovery - INFO - Discovering motifs in 4 features...
2025-10-21 09:10:31,587 - motif_discovery - INFO -   Window size: 60
2025-10-21 09:10:31,587 - motif_discovery - INFO -   Max motifs: 20
2025-10-21 09:10:31,588 - motif_discovery - INFO -   Radius: 4.5
2025-10-21 09:10:31,591 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-21 09:15:44,164 - motif_discovery - INFO -   Discovering motif groups...
2025-10-21 09:15:47,383 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-21 09:15:47,384 - motif_discovery - INFO -   ✓ Total instances: 135
2025-10-21 09:15:47,384 - motif_discovery - INFO -   ✓ Average distance: 2.282
2025-10-21 09:15:47,384 - __main__ - INFO - 
Applying correlation filter...
2025-10-21 09:15:47,384 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-21 09:15:47,385 - motif_discovery - INFO -   Filter level: instance
2025-10-21 09:15:47,385 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-21 09:15:47,385 - motif_discovery - INFO -   Rules:
2025-10-21 09:15:47,385 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-21 09:15:47,385 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-21 09:15:47,387 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-21 09:15:47,388 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-21 09:15:47,388 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-21 09:15:47,388 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:15:47,388 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-21 09:15:47,388 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:15:47,388 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-21 09:15:47,389 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-21 09:15:47,389 - density_analysis - INFO -   Window size: 60 minutes
2025-10-21 09:15:47,389 - density_analysis - INFO -   Max motifs: 15
2025-10-21 09:15:47,389 - density_analysis - INFO -   Radius: 4.5
2025-10-21 09:15:47,391 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-21 09:19:42,994 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-21 09:21:30,670 - density_analysis - INFO -   ✓ Found 8 motif groups
2025-10-21 09:21:30,670 - density_analysis - INFO -   ✓ Total instances: 33
2025-10-21 09:21:30,672 - __main__ - INFO - ✓ Density motif discovery complete: 8 motifs
2025-10-21 09:21:30,672 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:21:30,673 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-21 09:21:30,673 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:21:30,673 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-21 09:21:30,673 - density_analysis - INFO - 
Motif 1 (12 instances):
2025-10-21 09:21:30,703 - density_analysis - INFO -   Avg DensityHC change: +0.02
2025-10-21 09:21:30,703 - density_analysis - INFO -   Ore-Density correlation: -0.123 (lag: 0 min)
2025-10-21 09:21:30,704 - density_analysis - INFO -   WaterMill-Density correlation: -0.135 (lag: 0 min)
2025-10-21 09:21:30,704 - density_analysis - INFO - 
Motif 2 (4 instances):
2025-10-21 09:21:30,713 - density_analysis - INFO -   Avg DensityHC change: +12.80
2025-10-21 09:21:30,713 - density_analysis - INFO -   Ore-Density correlation: -0.463 (lag: 0 min)
2025-10-21 09:21:30,713 - density_analysis - INFO -   WaterMill-Density correlation: -0.451 (lag: 0 min)
2025-10-21 09:21:30,713 - density_analysis - INFO - 
Motif 3 (2 instances):
2025-10-21 09:21:30,718 - density_analysis - INFO -   Avg DensityHC change: +35.41
2025-10-21 09:21:30,718 - density_analysis - INFO -   Ore-Density correlation: +0.110 (lag: -1 min)
2025-10-21 09:21:30,720 - density_analysis - INFO -   WaterMill-Density correlation: +0.061 (lag: -0 min)
2025-10-21 09:21:30,720 - density_analysis - INFO - 
Motif 4 (5 instances):
2025-10-21 09:21:30,731 - density_analysis - INFO -   Avg DensityHC change: +0.11
2025-10-21 09:21:30,731 - density_analysis - INFO -   Ore-Density correlation: -0.057 (lag: 0 min)
2025-10-21 09:21:30,731 - density_analysis - INFO -   WaterMill-Density correlation: +0.007 (lag: 0 min)
2025-10-21 09:21:30,732 - density_analysis - INFO - 
Motif 5 (3 instances):
2025-10-21 09:21:30,739 - density_analysis - INFO -   Avg DensityHC change: +3.98
2025-10-21 09:21:30,739 - density_analysis - INFO -   Ore-Density correlation: -0.013 (lag: 0 min)
2025-10-21 09:21:30,739 - density_analysis - INFO -   WaterMill-Density correlation: -0.155 (lag: 0 min)
2025-10-21 09:21:30,739 - density_analysis - INFO - 
Motif 6 (3 instances):
2025-10-21 09:21:30,748 - density_analysis - INFO -   Avg DensityHC change: +7.83
2025-10-21 09:21:30,748 - density_analysis - INFO -   Ore-Density correlation: +0.766 (lag: 0 min)
2025-10-21 09:21:30,748 - density_analysis - INFO -   WaterMill-Density correlation: +0.747 (lag: -1 min)
2025-10-21 09:21:30,748 - density_analysis - INFO - 
Motif 7 (2 instances):
2025-10-21 09:21:30,753 - density_analysis - INFO -   Avg DensityHC change: -0.90
2025-10-21 09:21:30,753 - density_analysis - INFO -   Ore-Density correlation: -0.036 (lag: -11 min)
2025-10-21 09:21:30,753 - density_analysis - INFO -   WaterMill-Density correlation: -0.044 (lag: -2 min)
2025-10-21 09:21:30,754 - density_analysis - INFO - 
Motif 8 (2 instances):
2025-10-21 09:21:30,758 - density_analysis - INFO -   Avg DensityHC change: -4.00
2025-10-21 09:21:30,758 - density_analysis - INFO -   Ore-Density correlation: +0.740 (lag: 6 min)
2025-10-21 09:21:30,758 - density_analysis - INFO -   WaterMill-Density correlation: +0.720 (lag: 1 min)
2025-10-21 09:21:30,761 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-21 09:21:30,761 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:21:30,761 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-21 09:21:30,761 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:21:30,761 - segmentation - INFO - Merging motif collections...
2025-10-21 09:21:30,761 - segmentation - INFO -   Primary motifs: 20
2025-10-21 09:21:30,761 - segmentation - INFO -   Secondary motifs: 8
2025-10-21 09:21:30,762 - segmentation - INFO -   ✓ Merged: 28 total motifs
2025-10-21 09:21:30,762 - __main__ - INFO - ✓ Total motifs: 28
2025-10-21 09:21:30,762 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:21:30,762 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-21 09:21:30,762 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:21:30,762 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-21 09:21:30,762 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 09:21:30,824 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 09:21:30,825 - segmentation - INFO -     - Total segments: 135
2025-10-21 09:21:30,825 - segmentation - INFO -     - Total rows: 8100
2025-10-21 09:21:30,825 - segmentation - INFO -     - Unique motifs: 20
2025-10-21 09:21:30,827 - __main__ - INFO -   Creating complete dataset (28 motifs)...
2025-10-21 09:21:30,827 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 09:21:30,900 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 09:21:30,900 - segmentation - INFO -     - Total segments: 168
2025-10-21 09:21:30,901 - segmentation - INFO -     - Total rows: 10080
2025-10-21 09:21:30,903 - segmentation - INFO -     - Unique motifs: 28
2025-10-21 09:21:31,024 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV.csv (8100 rows)
2025-10-21 09:21:31,168 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all.csv (10080 rows)
2025-10-21 09:21:31,168 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:21:31,168 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-21 09:21:31,169 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:21:31,169 - segmentation - INFO - Extracting motif summaries...
2025-10-21 09:21:31,178 - segmentation - INFO -   ✓ Created summary for 28 motifs
2025-10-21 09:21:31,180 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-21 09:21:31,181 - segmentation - INFO - Creating instance catalog...
2025-10-21 09:21:31,183 - segmentation - INFO -   ✓ Cataloged 168 instances
2025-10-21 09:21:31,184 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-21 09:21:31,184 - segmentation - INFO - Calculating segment statistics...
2025-10-21 09:21:31,214 - segmentation - INFO -   ✓ Calculated statistics for 28 motifs
2025-10-21 09:21:31,215 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-21 09:21:31,215 - visualization - INFO - Creating summary report...
2025-10-21 09:21:31,217 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-21 09:21:31,217 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 09:21:31,217 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-21 09:21:31,217 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 09:21:31,217 - visualization - INFO - Plotting top 10 motifs...
2025-10-21 09:21:31,774 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-21 09:21:32,267 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-21 09:21:32,814 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-21 09:21:33,276 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-21 09:21:33,764 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-21 09:21:34,255 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-21 09:21:34,687 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-21 09:21:35,156 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-21 09:21:35,583 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-21 09:21:36,021 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-21 09:21:36,021 - visualization - INFO - Creating motif overview plot...
2025-10-21 09:21:36,523 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-21 09:21:36,524 - visualization - INFO - Creating density analysis plot...
2025-10-21 09:21:37,065 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-21 09:21:37,065 - visualization - INFO - Creating correlation heatmap...
2025-10-21 09:21:37,348 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-21 09:21:37,348 - visualization - INFO - Creating feature distribution plots...
2025-10-21 09:21:38,476 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-21 09:21:38,477 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_6
2025-10-21 09:21:38,477 - __main__ - INFO - 
================================================================================
2025-10-21 09:21:38,477 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-21 09:21:38,477 - __main__ - INFO - ================================================================================
2025-10-21 09:21:38,477 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-21 09:21:38,477 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-21 09:21:38,477 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-21 09:21:38,478 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-21 10:00:45,994 - __main__ - INFO - 
================================================================================
2025-10-21 10:00:45,997 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-21 10:00:45,997 - __main__ - INFO - ================================================================================
2025-10-21 10:00:45,998 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 8
Date Range: 2025-08-20 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-21 10:00:45,999 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:00:45,999 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-21 10:00:45,999 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:00:45,999 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-21 10:00:46,172 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-21 10:00:46,172 - database - INFO - ✅ Database connector initialized
2025-10-21 10:00:46,172 - database - INFO - Loading data from database for Mill 8...
2025-10-21 10:00:46,172 - database - INFO -   Date range: 2025-08-20 to 2025-10-19
2025-10-21 10:00:46,173 - database - INFO -   Resample frequency: 1min
2025-10-21 10:00:46,173 - db.db_connector - INFO - === STARTING get_combined_data for Mill 8 ===
2025-10-21 10:00:46,173 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=8, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 10:00:46,173 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-21 10:00:46,173 - db.db_connector - INFO - Retrieving mill data for mill 8 from 2025-08-20 to 2025-10-19
2025-10-21 10:00:46,174 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=8, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 10:00:46,174 - db.db_connector - INFO - DEBUG: Current time: 2025-10-21 10:00:46.174325
2025-10-21 10:00:46,189 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 10:00:46,189 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 10:00:46,192 - db.db_connector - INFO - DEBUG: Days from now to end_date: -3
2025-10-21 10:00:46,193 - db.db_connector - INFO - DEBUG: Converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 10:00:46,193 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 10:00:46,193 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_08" WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 10:00:46,193 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_08"
2025-10-21 10:00:46,750 - db.db_connector - INFO - DEBUG: Table MILL_08 has 419390 total records
2025-10-21 10:00:46,751 - db.db_connector - INFO - DEBUG: Table MILL_08 date range: 2025-01-01 02:07:00 to 2025-10-19 08:58:00
2025-10-21 10:00:46,767 - db.db_connector - INFO - DEBUG: Table MILL_08 has 97672 records after 2025-08-12 12:54:00
2025-10-21 10:00:47,963 - db.db_connector - INFO - Retrieved 86389 rows for Mill 8
2025-10-21 10:00:47,966 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 10:00:47,969 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-21 10:00:47,973 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 86389
2025-10-21 10:00:47,973 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-20 00:00:00
2025-10-21 10:00:47,973 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-21 10:00:47,974 - db.db_connector - INFO - Mill data retrieved: 86389 rows, 13 columns
2025-10-21 10:00:47,974 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-21 10:00:47,994 - db.db_connector - INFO - Mill data sample:
                       Ore  WaterMill  WaterZumpf   Power  ZumpfLevel  ...  PulpHC  PumpRPM  MotorAmp  PSI80  PSI200
TimeStamp                                                              ...                                          
2025-08-20 00:00:00  0.199        0.0       0.103  0.1680  126.509818  ...   0.089      0.0       0.0  150.2  6470.5
2025-08-20 00:01:00  0.199        0.0       0.103  0.0000  109.290259  ...   0.089      0.0       0.0  150.2  6470.5
2025-08-20 00:02:00  0.199        0.0       0.103  0.1519  154.882918  ...   0.089      0.0       0.0  150.2  6470.5

[3 rows x 13 columns]
2025-10-21 10:00:48,004 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 10:00:48,004 - db.db_connector - INFO - DEBUG: Before date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 10:00:48,009 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 10:00:48,011 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 10:00:48,011 - db.db_connector - INFO - DEBUG: After date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 10:00:48,084 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-21 10:00:48,113 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-21 10:00:48,114 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 10:00:48,116 - db.db_connector - INFO - Processed mill data: 86401 rows, 13 columns
2025-10-21 10:00:48,117 - db.db_connector - INFO - Retrieving ore quality data
2025-10-21 10:00:48,117 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-08-20, end_date=2025-10-19
2025-10-21 10:00:48,118 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 10:00:48,118 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 10:00:48,119 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 10:00:48,120 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 10:00:48,120 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 10:00:48,124 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-21 10:00:48,125 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-21 10:00:48,128 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-21 10:00:48,131 - db.db_connector - INFO - DEBUG: ore_quality has 180 records in requested range 2025-08-20 to 2025-10-19
2025-10-21 10:00:48,137 - db.db_connector - INFO - Retrieved 180 rows of ore quality data
2025-10-21 10:00:48,138 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 10:00:48,138 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-21 10:00:48,140 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 180
2025-10-21 10:00:48,140 - db.db_connector - INFO - Ore data retrieved: 180 rows, 11 columns
2025-10-21 10:00:48,140 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-21 10:00:48,140 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 10:00:48,142 - db.db_connector - INFO - DEBUG: Before date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 10:00:48,142 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 180 rows (removed 0 rows)
2025-10-21 10:00:48,142 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 180 rows (removed 0 rows)
2025-10-21 10:00:48,142 - db.db_connector - INFO - DEBUG: After date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 10:00:48,155 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-21 10:00:48,155 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 10:00:48,156 - db.db_connector - INFO - Processed ore data: 85921 rows, 9 columns - with constant values (no interpolation)
2025-10-21 10:00:48,157 - db.db_connector - INFO - DF1 (mill): 86401 rows, index range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 10:00:48,157 - db.db_connector - INFO - DF2 (ore): 85921 rows, index range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 10:00:48,157 - db.db_connector - INFO - Found 85921 common timestamps
2025-10-21 10:00:48,172 - db.db_connector - INFO - Successfully joined dataframes: 85921 rows, 22 columns
2025-10-21 10:00:48,172 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 10:00:48,172 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 10:00:48,187 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 85921
2025-10-21 10:00:48,187 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 85921 records
2025-10-21 10:00:48,187 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-21 10:00:48,193 - db.db_connector - INFO -                        Ore  WaterMill  WaterZumpf    Power  ZumpfLevel  PressureHC  DensityHC        FE  PulpHC  PumpRPM  MotorAmp  PSI80  PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                    
2025-08-20 06:00:00  0.883        0.0       0.103  0.06495   97.577389         0.0    1200.55  3.823867   0.089      0.0       0.0  150.2  6470.5  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:01:00  0.883        0.0       0.103  0.07475  109.409357         0.0    1200.55  3.824933   0.089      0.0       0.0  150.2  6470.5  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:02:00  0.883        0.0       0.103  0.07475  107.764323         0.0    1200.55  3.829667   0.089      0.0       0.0  150.2  6470.5  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-10-21 10:00:48,194 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-21 10:00:48,197 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                                
2025-10-18 21:58:00  177.954583  14.592665  240.649053  1948.029611  1557.060110    0.381727  1661.053830  3.466000  568.625900  722.042933  184.576568  46.384783  28.876232  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  177.934650  14.590065  240.422186  1950.278729  1553.013663    0.381927  1660.682735  3.468867  568.275615  721.808922  184.761958  46.300000  28.933333  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  177.896650  14.587437  240.379386  1951.767803  1550.478061    0.381856  1660.388364  3.471733  567.863525  721.724656  184.889164  46.300000  28.900000  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-21 10:00:48,197 - db.db_connector - INFO - ==================================================
2025-10-21 10:00:48,198 - db.db_connector - INFO - Combined data has 85921 rows and 22 columns
2025-10-21 10:00:48,199 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 10:00:48,210 - db.db_connector - INFO - Combined data sample:
                       Ore  WaterMill  WaterZumpf    Power  ...  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                   ...                                      
2025-08-20 06:00:00  0.883        0.0       0.103  0.06495  ...  0.738  0.208   0.054             NaN
2025-08-20 06:01:00  0.883        0.0       0.103  0.07475  ...  0.738  0.208   0.054             NaN
2025-08-20 06:02:00  0.883        0.0       0.103  0.07475  ...  0.738  0.208   0.054             NaN

[3 rows x 22 columns]
2025-10-21 10:00:48,210 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 8 ===
2025-10-21 10:00:48,210 - db.db_connector - INFO - DEBUG: Final result - 85921 total records
2025-10-21 10:00:48,210 - db.db_connector - INFO - DEBUG: Final date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 10:00:48,236 - database - INFO -   ✓ Loaded 85921 rows, 24 columns
2025-10-21 10:00:49,351 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-21 10:00:49,352 - database - INFO - ✓ All 11 required columns present
2025-10-21 10:00:49,352 - database - INFO - Applying data filters...
2025-10-21 10:00:49,358 - database - INFO -   Ore: 100 < x < 220
2025-10-21 10:00:49,359 - database - INFO -   PulpHC: 400 < x < 600
2025-10-21 10:00:49,359 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-21 10:00:49,373 - database - INFO -   ✓ Filtered: 80556 rows kept, 5365 removed (6.2%)
2025-10-21 10:00:49,374 - __main__ - INFO - ✓ Data loaded and filtered: 80556 rows
2025-10-21 10:00:49,374 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:00:49,375 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-21 10:00:49,375 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:00:49,375 - motif_discovery - INFO - Discovering motifs in 4 features...
2025-10-21 10:00:49,375 - motif_discovery - INFO -   Window size: 60
2025-10-21 10:00:49,375 - motif_discovery - INFO -   Max motifs: 20
2025-10-21 10:00:49,375 - motif_discovery - INFO -   Radius: 4.5
2025-10-21 10:00:49,379 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-21 10:05:53,347 - motif_discovery - INFO -   Discovering motif groups...
2025-10-21 10:05:56,472 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-21 10:05:56,472 - motif_discovery - INFO -   ✓ Total instances: 119
2025-10-21 10:05:56,472 - motif_discovery - INFO -   ✓ Average distance: 2.669
2025-10-21 10:05:56,472 - __main__ - INFO - 
Applying correlation filter...
2025-10-21 10:05:56,472 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-21 10:05:56,473 - motif_discovery - INFO -   Filter level: instance
2025-10-21 10:05:56,473 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-21 10:05:56,473 - motif_discovery - INFO -   Rules:
2025-10-21 10:05:56,474 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-21 10:05:56,474 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-21 10:05:56,475 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-21 10:05:56,476 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-21 10:05:56,476 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-21 10:05:56,476 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:05:56,476 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-21 10:05:56,476 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:05:56,476 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-21 10:05:56,476 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-21 10:05:56,476 - density_analysis - INFO -   Window size: 60 minutes
2025-10-21 10:05:56,476 - density_analysis - INFO -   Max motifs: 15
2025-10-21 10:05:56,477 - density_analysis - INFO -   Radius: 4.5
2025-10-21 10:05:56,478 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-21 10:09:38,136 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-21 10:11:25,099 - density_analysis - INFO -   ✓ Found 10 motif groups
2025-10-21 10:11:25,100 - density_analysis - INFO -   ✓ Total instances: 44
2025-10-21 10:11:25,101 - __main__ - INFO - ✓ Density motif discovery complete: 10 motifs
2025-10-21 10:11:25,101 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:11:25,101 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-21 10:11:25,101 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:11:25,101 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-21 10:11:25,101 - density_analysis - INFO - 
Motif 1 (8 instances):
2025-10-21 10:11:25,132 - density_analysis - INFO -   Avg DensityHC change: +4.75
2025-10-21 10:11:25,132 - density_analysis - INFO -   Ore-Density correlation: -0.426 (lag: 0 min)
2025-10-21 10:11:25,132 - density_analysis - INFO -   WaterMill-Density correlation: -0.316 (lag: 0 min)
2025-10-21 10:11:25,132 - density_analysis - INFO - 
Motif 2 (2 instances):
2025-10-21 10:11:25,136 - density_analysis - INFO -   Avg DensityHC change: +49.63
2025-10-21 10:11:25,136 - density_analysis - INFO -   Ore-Density correlation: -0.918 (lag: 0 min)
2025-10-21 10:11:25,136 - density_analysis - INFO -   WaterMill-Density correlation: -0.798 (lag: 2 min)
2025-10-21 10:11:25,136 - density_analysis - INFO - 
Motif 3 (12 instances):
2025-10-21 10:11:25,160 - density_analysis - INFO -   Avg DensityHC change: +8.47
2025-10-21 10:11:25,160 - density_analysis - INFO -   Ore-Density correlation: +0.424 (lag: 0 min)
2025-10-21 10:11:25,160 - density_analysis - INFO -   WaterMill-Density correlation: +0.513 (lag: 0 min)
2025-10-21 10:11:25,160 - density_analysis - INFO - 
Motif 4 (3 instances):
2025-10-21 10:11:25,166 - density_analysis - INFO -   Avg DensityHC change: -4.31
2025-10-21 10:11:25,166 - density_analysis - INFO -   Ore-Density correlation: -0.160 (lag: 0 min)
2025-10-21 10:11:25,166 - density_analysis - INFO -   WaterMill-Density correlation: -0.401 (lag: 0 min)
2025-10-21 10:11:25,167 - density_analysis - INFO - 
Motif 5 (7 instances):
2025-10-21 10:11:25,179 - density_analysis - INFO -   Avg DensityHC change: -2.58
2025-10-21 10:11:25,179 - density_analysis - INFO -   Ore-Density correlation: +0.083 (lag: 0 min)
2025-10-21 10:11:25,179 - density_analysis - INFO -   WaterMill-Density correlation: +0.165 (lag: 0 min)
2025-10-21 10:11:25,179 - density_analysis - INFO - 
Motif 6 (3 instances):
2025-10-21 10:11:25,185 - density_analysis - INFO -   Avg DensityHC change: -13.30
2025-10-21 10:11:25,185 - density_analysis - INFO -   Ore-Density correlation: -0.693 (lag: 0 min)
2025-10-21 10:11:25,185 - density_analysis - INFO -   WaterMill-Density correlation: -0.619 (lag: 0 min)
2025-10-21 10:11:25,185 - density_analysis - INFO - 
Motif 7 (2 instances):
2025-10-21 10:11:25,189 - density_analysis - INFO -   Avg DensityHC change: -15.12
2025-10-21 10:11:25,189 - density_analysis - INFO -   Ore-Density correlation: +0.768 (lag: -4 min)
2025-10-21 10:11:25,190 - density_analysis - INFO -   WaterMill-Density correlation: +0.858 (lag: 0 min)
2025-10-21 10:11:25,190 - density_analysis - INFO - 
Motif 8 (2 instances):
2025-10-21 10:11:25,193 - density_analysis - INFO -   Avg DensityHC change: -16.21
2025-10-21 10:11:25,194 - density_analysis - INFO -   Ore-Density correlation: -0.688 (lag: 2 min)
2025-10-21 10:11:25,194 - density_analysis - INFO -   WaterMill-Density correlation: -0.581 (lag: 5 min)
2025-10-21 10:11:25,194 - density_analysis - INFO - 
Motif 9 (2 instances):
2025-10-21 10:11:25,198 - density_analysis - INFO -   Avg DensityHC change: +3.54
2025-10-21 10:11:25,198 - density_analysis - INFO -   Ore-Density correlation: -0.035 (lag: 0 min)
2025-10-21 10:11:25,198 - density_analysis - INFO -   WaterMill-Density correlation: +0.080 (lag: 0 min)
2025-10-21 10:11:25,198 - density_analysis - INFO - 
Motif 10 (3 instances):
2025-10-21 10:11:25,204 - density_analysis - INFO -   Avg DensityHC change: +9.89
2025-10-21 10:11:25,204 - density_analysis - INFO -   Ore-Density correlation: +0.387 (lag: 0 min)
2025-10-21 10:11:25,204 - density_analysis - INFO -   WaterMill-Density correlation: -0.533 (lag: 0 min)
2025-10-21 10:11:25,205 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-21 10:11:25,205 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:11:25,205 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-21 10:11:25,205 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:11:25,205 - segmentation - INFO - Merging motif collections...
2025-10-21 10:11:25,205 - segmentation - INFO -   Primary motifs: 20
2025-10-21 10:11:25,206 - segmentation - INFO -   Secondary motifs: 10
2025-10-21 10:11:25,206 - segmentation - INFO -   ✓ Merged: 30 total motifs
2025-10-21 10:11:25,206 - __main__ - INFO - ✓ Total motifs: 30
2025-10-21 10:11:25,206 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:11:25,207 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-21 10:11:25,207 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:11:25,207 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-21 10:11:25,207 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 10:11:25,261 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 10:11:25,261 - segmentation - INFO -     - Total segments: 119
2025-10-21 10:11:25,261 - segmentation - INFO -     - Total rows: 7140
2025-10-21 10:11:25,263 - segmentation - INFO -     - Unique motifs: 20
2025-10-21 10:11:25,263 - __main__ - INFO -   Creating complete dataset (30 motifs)...
2025-10-21 10:11:25,264 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 10:11:25,338 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 10:11:25,338 - segmentation - INFO -     - Total segments: 163
2025-10-21 10:11:25,338 - segmentation - INFO -     - Total rows: 9780
2025-10-21 10:11:25,338 - segmentation - INFO -     - Unique motifs: 30
2025-10-21 10:11:25,448 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV.csv (7140 rows)
2025-10-21 10:11:25,603 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all.csv (9780 rows)
2025-10-21 10:11:25,603 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:11:25,603 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-21 10:11:25,603 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:11:25,604 - segmentation - INFO - Extracting motif summaries...
2025-10-21 10:11:25,613 - segmentation - INFO -   ✓ Created summary for 30 motifs
2025-10-21 10:11:25,615 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-21 10:11:25,616 - segmentation - INFO - Creating instance catalog...
2025-10-21 10:11:25,617 - segmentation - INFO -   ✓ Cataloged 163 instances
2025-10-21 10:11:25,618 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-21 10:11:25,619 - segmentation - INFO - Calculating segment statistics...
2025-10-21 10:11:25,651 - segmentation - INFO -   ✓ Calculated statistics for 30 motifs
2025-10-21 10:11:25,653 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-21 10:11:25,653 - visualization - INFO - Creating summary report...
2025-10-21 10:11:25,653 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-21 10:11:25,654 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 10:11:25,654 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-21 10:11:25,654 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 10:11:25,654 - visualization - INFO - Plotting top 10 motifs...
2025-10-21 10:11:26,431 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-21 10:11:26,990 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-21 10:11:27,516 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-21 10:11:28,133 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-21 10:11:28,611 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-21 10:11:29,104 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-21 10:11:29,645 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-21 10:11:30,190 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-21 10:11:30,727 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-21 10:11:31,211 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-21 10:11:31,212 - visualization - INFO - Creating motif overview plot...
2025-10-21 10:11:31,615 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-21 10:11:31,616 - visualization - INFO - Creating density analysis plot...
2025-10-21 10:11:32,304 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-21 10:11:32,304 - visualization - INFO - Creating correlation heatmap...
2025-10-21 10:11:32,589 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-21 10:11:32,589 - visualization - INFO - Creating feature distribution plots...
2025-10-21 10:11:33,864 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-21 10:11:33,864 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_8
2025-10-21 10:11:33,864 - __main__ - INFO - 
================================================================================
2025-10-21 10:11:33,864 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-21 10:11:33,864 - __main__ - INFO - ================================================================================
2025-10-21 10:11:33,866 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-21 10:11:33,866 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-21 10:11:33,866 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-21 10:11:33,866 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-21 14:56:42,928 - __main__ - INFO - 
================================================================================
2025-10-21 14:56:42,928 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-21 14:56:42,929 - __main__ - INFO - ================================================================================
2025-10-21 14:56:42,930 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 8
Date Range: 2025-08-20 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-21 14:56:42,930 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 14:56:42,931 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-21 14:56:42,931 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 14:56:42,931 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-21 14:56:43,088 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-21 14:56:43,088 - database - INFO - ✅ Database connector initialized
2025-10-21 14:56:43,090 - database - INFO - Loading data from database for Mill 8...
2025-10-21 14:56:43,090 - database - INFO -   Date range: 2025-08-20 to 2025-10-19
2025-10-21 14:56:43,090 - database - INFO -   Resample frequency: 1min
2025-10-21 14:56:43,090 - db.db_connector - INFO - === STARTING get_combined_data for Mill 8 ===
2025-10-21 14:56:43,091 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=8, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 14:56:43,091 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-21 14:56:43,091 - db.db_connector - INFO - Retrieving mill data for mill 8 from 2025-08-20 to 2025-10-19
2025-10-21 14:56:43,091 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=8, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 14:56:43,091 - db.db_connector - INFO - DEBUG: Current time: 2025-10-21 14:56:43.091007
2025-10-21 14:56:43,093 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 14:56:43,094 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 14:56:43,094 - db.db_connector - INFO - DEBUG: Days from now to end_date: -3
2025-10-21 14:56:43,094 - db.db_connector - INFO - DEBUG: Converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 14:56:43,094 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 14:56:43,095 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_08" WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 14:56:43,095 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_08"
2025-10-21 14:56:43,154 - db.db_connector - INFO - DEBUG: Table MILL_08 has 419390 total records
2025-10-21 14:56:43,155 - db.db_connector - INFO - DEBUG: Table MILL_08 date range: 2025-01-01 02:07:00 to 2025-10-19 08:58:00
2025-10-21 14:56:43,168 - db.db_connector - INFO - DEBUG: Table MILL_08 has 97672 records after 2025-08-12 12:54:00
2025-10-21 14:56:43,905 - db.db_connector - INFO - Retrieved 86389 rows for Mill 8
2025-10-21 14:56:43,906 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 14:56:43,907 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-21 14:56:43,910 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 86389
2025-10-21 14:56:43,910 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-20 00:00:00
2025-10-21 14:56:43,910 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-21 14:56:43,910 - db.db_connector - INFO - Mill data retrieved: 86389 rows, 13 columns
2025-10-21 14:56:43,910 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-21 14:56:43,920 - db.db_connector - INFO - Mill data sample:
                       Ore  WaterMill  WaterZumpf   Power  ...  PumpRPM  MotorAmp  PSI80  PSI200
TimeStamp                                                  ...                                  
2025-08-20 00:00:00  0.199        0.0       0.103  0.1680  ...      0.0       0.0  150.2  6470.5
2025-08-20 00:01:00  0.199        0.0       0.103  0.0000  ...      0.0       0.0  150.2  6470.5
2025-08-20 00:02:00  0.199        0.0       0.103  0.1519  ...      0.0       0.0  150.2  6470.5

[3 rows x 13 columns]
2025-10-21 14:56:43,929 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 14:56:43,929 - db.db_connector - INFO - DEBUG: Before date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 14:56:43,932 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 14:56:43,935 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 14:56:43,935 - db.db_connector - INFO - DEBUG: After date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 14:56:43,986 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-21 14:56:44,010 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-21 14:56:44,010 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 14:56:44,012 - db.db_connector - INFO - Processed mill data: 86401 rows, 13 columns
2025-10-21 14:56:44,012 - db.db_connector - INFO - Retrieving ore quality data
2025-10-21 14:56:44,012 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-08-20, end_date=2025-10-19
2025-10-21 14:56:44,013 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 14:56:44,013 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 14:56:44,015 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 14:56:44,015 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 14:56:44,016 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 14:56:44,019 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-21 14:56:44,019 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-21 14:56:44,020 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-21 14:56:44,022 - db.db_connector - INFO - DEBUG: ore_quality has 180 records in requested range 2025-08-20 to 2025-10-19
2025-10-21 14:56:44,026 - db.db_connector - INFO - Retrieved 180 rows of ore quality data
2025-10-21 14:56:44,027 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 14:56:44,027 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-21 14:56:44,028 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 180
2025-10-21 14:56:44,028 - db.db_connector - INFO - Ore data retrieved: 180 rows, 11 columns
2025-10-21 14:56:44,028 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-21 14:56:44,029 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 14:56:44,029 - db.db_connector - INFO - DEBUG: Before date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 14:56:44,030 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 180 rows (removed 0 rows)
2025-10-21 14:56:44,030 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 180 rows (removed 0 rows)
2025-10-21 14:56:44,030 - db.db_connector - INFO - DEBUG: After date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 14:56:44,038 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-21 14:56:44,038 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 14:56:44,042 - db.db_connector - INFO - Processed ore data: 85921 rows, 9 columns - with constant values (no interpolation)
2025-10-21 14:56:44,042 - db.db_connector - INFO - DF1 (mill): 86401 rows, index range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 14:56:44,043 - db.db_connector - INFO - DF2 (ore): 85921 rows, index range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 14:56:44,043 - db.db_connector - INFO - Found 85921 common timestamps
2025-10-21 14:56:44,055 - db.db_connector - INFO - Successfully joined dataframes: 85921 rows, 22 columns
2025-10-21 14:56:44,055 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 14:56:44,056 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 14:56:44,070 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 85921
2025-10-21 14:56:44,070 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 85921 records
2025-10-21 14:56:44,070 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-21 14:56:44,074 - db.db_connector - INFO -                        Ore  WaterMill  WaterZumpf    Power  ZumpfLevel  PressureHC  DensityHC        FE  PulpHC  PumpRPM  MotorAmp  PSI80  PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                    
2025-08-20 06:00:00  0.883        0.0       0.103  0.06495   97.577389         0.0    1200.55  3.823867   0.089      0.0       0.0  150.2  6470.5  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:01:00  0.883        0.0       0.103  0.07475  109.409357         0.0    1200.55  3.824933   0.089      0.0       0.0  150.2  6470.5  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:02:00  0.883        0.0       0.103  0.07475  107.764323         0.0    1200.55  3.829667   0.089      0.0       0.0  150.2  6470.5  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-10-21 14:56:44,076 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-21 14:56:44,078 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                                
2025-10-18 21:58:00  177.954583  14.592665  240.649053  1948.029611  1557.060110    0.381727  1661.053830  3.466000  568.625900  722.042933  184.576568  46.384783  28.876232  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  177.934650  14.590065  240.422186  1950.278729  1553.013663    0.381927  1660.682735  3.468867  568.275615  721.808922  184.761958  46.300000  28.933333  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  177.896650  14.587437  240.379386  1951.767803  1550.478061    0.381856  1660.388364  3.471733  567.863525  721.724656  184.889164  46.300000  28.900000  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-21 14:56:44,079 - db.db_connector - INFO - ==================================================
2025-10-21 14:56:44,081 - db.db_connector - INFO - Combined data has 85921 rows and 22 columns
2025-10-21 14:56:44,081 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 14:56:44,091 - db.db_connector - INFO - Combined data sample:
                       Ore  WaterMill  WaterZumpf    Power  ...  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                   ...                                      
2025-08-20 06:00:00  0.883        0.0       0.103  0.06495  ...  0.738  0.208   0.054             NaN
2025-08-20 06:01:00  0.883        0.0       0.103  0.07475  ...  0.738  0.208   0.054             NaN
2025-08-20 06:02:00  0.883        0.0       0.103  0.07475  ...  0.738  0.208   0.054             NaN

[3 rows x 22 columns]
2025-10-21 14:56:44,092 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 8 ===
2025-10-21 14:56:44,092 - db.db_connector - INFO - DEBUG: Final result - 85921 total records
2025-10-21 14:56:44,092 - db.db_connector - INFO - DEBUG: Final date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 14:56:44,116 - database - INFO -   ✓ Loaded 85921 rows, 24 columns
2025-10-21 14:56:45,187 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-21 14:56:45,189 - database - INFO - ✓ All 11 required columns present
2025-10-21 14:56:45,189 - database - INFO - Applying data filters...
2025-10-21 14:56:45,193 - database - INFO -   Ore: 100 < x < 220
2025-10-21 14:56:45,194 - database - INFO -   PulpHC: 400 < x < 600
2025-10-21 14:56:45,194 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-21 14:56:45,202 - database - INFO -   ✓ Filtered: 80556 rows kept, 5365 removed (6.2%)
2025-10-21 14:56:45,205 - circulative_load - INFO - Calculating circulative load...
2025-10-21 14:56:45,205 - circulative_load - INFO -   Using rho_solid = 2900 kg/m³
2025-10-21 14:56:45,213 - circulative_load - INFO -   ✓ Circulative load calculated for 80556 rows
2025-10-21 14:56:45,214 - circulative_load - INFO -     Mean: 2.561
2025-10-21 14:56:45,216 - circulative_load - INFO -     Median: 2.563
2025-10-21 14:56:45,216 - circulative_load - INFO -     Std: 0.300
2025-10-21 14:56:45,217 - circulative_load - INFO -     Min: 1.422
2025-10-21 14:56:45,217 - circulative_load - INFO -     Max: 5.239
2025-10-21 14:56:45,217 - circulative_load - INFO -     Values in typical range [1.5, 3.0]: 75326/80556 (93.5%)
2025-10-21 14:56:45,219 - circulative_load - INFO - Validating circulative load values...
2025-10-21 14:56:45,219 - circulative_load - INFO -   Total rows: 80556
2025-10-21 14:56:45,219 - circulative_load - INFO -   Valid values: 80556 (100.0%)
2025-10-21 14:56:45,220 - circulative_load - INFO -   Invalid/NaN values: 0 (0.0%)
2025-10-21 14:56:45,220 - circulative_load - INFO -   Out of range [0.5, 5.0]: 1 (0.0%)
2025-10-21 14:56:45,220 - __main__ - INFO -   ✓ Circulative load calculation complete
2025-10-21 14:56:46,460 - __main__ - INFO -   ✓ Updated data with circulative load saved to initial_data.csv
2025-10-21 14:56:46,460 - __main__ - INFO - ✓ Data loaded and filtered: 80556 rows
2025-10-21 14:56:46,460 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 14:56:46,460 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-21 14:56:46,460 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 14:56:46,460 - motif_discovery - INFO - Discovering motifs in 4 features...
2025-10-21 14:56:46,460 - motif_discovery - INFO -   Window size: 60
2025-10-21 14:56:46,460 - motif_discovery - INFO -   Max motifs: 20
2025-10-21 14:56:46,460 - motif_discovery - INFO -   Radius: 4.5
2025-10-21 14:56:46,463 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-21 15:01:41,908 - motif_discovery - INFO -   Discovering motif groups...
2025-10-21 15:01:45,026 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-21 15:01:45,026 - motif_discovery - INFO -   ✓ Total instances: 119
2025-10-21 15:01:45,026 - motif_discovery - INFO -   ✓ Average distance: 2.669
2025-10-21 15:01:45,028 - __main__ - INFO - 
Applying correlation filter...
2025-10-21 15:01:45,028 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-21 15:01:45,028 - motif_discovery - INFO -   Filter level: instance
2025-10-21 15:01:45,028 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-21 15:01:45,028 - motif_discovery - INFO -   Rules:
2025-10-21 15:01:45,028 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-21 15:01:45,028 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-21 15:01:45,029 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-21 15:01:45,030 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-21 15:01:45,031 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-21 15:01:45,031 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:01:45,031 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-21 15:01:45,031 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:01:45,031 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-21 15:01:45,032 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-21 15:01:45,032 - density_analysis - INFO -   Window size: 60 minutes
2025-10-21 15:01:45,032 - density_analysis - INFO -   Max motifs: 15
2025-10-21 15:01:45,032 - density_analysis - INFO -   Radius: 4.5
2025-10-21 15:01:45,034 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-21 15:05:27,668 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-21 15:07:16,638 - density_analysis - INFO -   ✓ Found 10 motif groups
2025-10-21 15:07:16,638 - density_analysis - INFO -   ✓ Total instances: 44
2025-10-21 15:07:16,638 - __main__ - INFO - ✓ Density motif discovery complete: 10 motifs
2025-10-21 15:07:16,639 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:07:16,639 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-21 15:07:16,639 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:07:16,639 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-21 15:07:16,639 - density_analysis - INFO - 
Motif 1 (8 instances):
2025-10-21 15:07:16,662 - density_analysis - INFO -   Avg DensityHC change: +4.75
2025-10-21 15:07:16,663 - density_analysis - INFO -   Ore-Density correlation: -0.426 (lag: 0 min)
2025-10-21 15:07:16,663 - density_analysis - INFO -   WaterMill-Density correlation: -0.316 (lag: 0 min)
2025-10-21 15:07:16,663 - density_analysis - INFO - 
Motif 2 (2 instances):
2025-10-21 15:07:16,667 - density_analysis - INFO -   Avg DensityHC change: +49.63
2025-10-21 15:07:16,667 - density_analysis - INFO -   Ore-Density correlation: -0.918 (lag: 0 min)
2025-10-21 15:07:16,668 - density_analysis - INFO -   WaterMill-Density correlation: -0.798 (lag: 2 min)
2025-10-21 15:07:16,668 - density_analysis - INFO - 
Motif 3 (12 instances):
2025-10-21 15:07:16,694 - density_analysis - INFO -   Avg DensityHC change: +8.47
2025-10-21 15:07:16,695 - density_analysis - INFO -   Ore-Density correlation: +0.424 (lag: 0 min)
2025-10-21 15:07:16,696 - density_analysis - INFO -   WaterMill-Density correlation: +0.513 (lag: 0 min)
2025-10-21 15:07:16,696 - density_analysis - INFO - 
Motif 4 (3 instances):
2025-10-21 15:07:16,702 - density_analysis - INFO -   Avg DensityHC change: -4.31
2025-10-21 15:07:16,702 - density_analysis - INFO -   Ore-Density correlation: -0.160 (lag: 0 min)
2025-10-21 15:07:16,702 - density_analysis - INFO -   WaterMill-Density correlation: -0.401 (lag: 0 min)
2025-10-21 15:07:16,702 - density_analysis - INFO - 
Motif 5 (7 instances):
2025-10-21 15:07:16,717 - density_analysis - INFO -   Avg DensityHC change: -2.58
2025-10-21 15:07:16,718 - density_analysis - INFO -   Ore-Density correlation: +0.083 (lag: 0 min)
2025-10-21 15:07:16,718 - density_analysis - INFO -   WaterMill-Density correlation: +0.165 (lag: 0 min)
2025-10-21 15:07:16,719 - density_analysis - INFO - 
Motif 6 (3 instances):
2025-10-21 15:07:16,726 - density_analysis - INFO -   Avg DensityHC change: -13.30
2025-10-21 15:07:16,726 - density_analysis - INFO -   Ore-Density correlation: -0.693 (lag: 0 min)
2025-10-21 15:07:16,726 - density_analysis - INFO -   WaterMill-Density correlation: -0.619 (lag: 0 min)
2025-10-21 15:07:16,726 - density_analysis - INFO - 
Motif 7 (2 instances):
2025-10-21 15:07:16,730 - density_analysis - INFO -   Avg DensityHC change: -15.12
2025-10-21 15:07:16,730 - density_analysis - INFO -   Ore-Density correlation: +0.768 (lag: -4 min)
2025-10-21 15:07:16,730 - density_analysis - INFO -   WaterMill-Density correlation: +0.858 (lag: 0 min)
2025-10-21 15:07:16,730 - density_analysis - INFO - 
Motif 8 (2 instances):
2025-10-21 15:07:16,734 - density_analysis - INFO -   Avg DensityHC change: -16.21
2025-10-21 15:07:16,734 - density_analysis - INFO -   Ore-Density correlation: -0.688 (lag: 2 min)
2025-10-21 15:07:16,735 - density_analysis - INFO -   WaterMill-Density correlation: -0.581 (lag: 5 min)
2025-10-21 15:07:16,735 - density_analysis - INFO - 
Motif 9 (2 instances):
2025-10-21 15:07:16,739 - density_analysis - INFO -   Avg DensityHC change: +3.54
2025-10-21 15:07:16,740 - density_analysis - INFO -   Ore-Density correlation: -0.035 (lag: 0 min)
2025-10-21 15:07:16,740 - density_analysis - INFO -   WaterMill-Density correlation: +0.080 (lag: 0 min)
2025-10-21 15:07:16,740 - density_analysis - INFO - 
Motif 10 (3 instances):
2025-10-21 15:07:16,746 - density_analysis - INFO -   Avg DensityHC change: +9.89
2025-10-21 15:07:16,746 - density_analysis - INFO -   Ore-Density correlation: +0.387 (lag: 0 min)
2025-10-21 15:07:16,746 - density_analysis - INFO -   WaterMill-Density correlation: -0.533 (lag: 0 min)
2025-10-21 15:07:16,749 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-21 15:07:16,749 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:07:16,749 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-21 15:07:16,749 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:07:16,749 - segmentation - INFO - Merging motif collections...
2025-10-21 15:07:16,750 - segmentation - INFO -   Primary motifs: 20
2025-10-21 15:07:16,750 - segmentation - INFO -   Secondary motifs: 10
2025-10-21 15:07:16,750 - segmentation - INFO -   ✓ Merged: 30 total motifs
2025-10-21 15:07:16,750 - __main__ - INFO - ✓ Total motifs: 30
2025-10-21 15:07:16,750 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:07:16,750 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-21 15:07:16,750 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:07:16,751 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-21 15:07:16,751 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 15:07:16,813 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 15:07:16,814 - segmentation - INFO -     - Total segments: 119
2025-10-21 15:07:16,814 - segmentation - INFO -     - Total rows: 7140
2025-10-21 15:07:16,814 - segmentation - INFO -     - Unique motifs: 20
2025-10-21 15:07:16,817 - __main__ - INFO -   Creating complete dataset (30 motifs)...
2025-10-21 15:07:16,818 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 15:07:16,902 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 15:07:16,902 - segmentation - INFO -     - Total segments: 163
2025-10-21 15:07:16,903 - segmentation - INFO -     - Total rows: 9780
2025-10-21 15:07:16,903 - segmentation - INFO -     - Unique motifs: 30
2025-10-21 15:07:17,027 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV.csv (7140 rows)
2025-10-21 15:07:17,198 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all.csv (9780 rows)
2025-10-21 15:07:17,199 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:07:17,199 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-21 15:07:17,199 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:07:17,199 - segmentation - INFO - Extracting motif summaries...
2025-10-21 15:07:17,209 - segmentation - INFO -   ✓ Created summary for 30 motifs
2025-10-21 15:07:17,210 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-21 15:07:17,210 - segmentation - INFO - Creating instance catalog...
2025-10-21 15:07:17,213 - segmentation - INFO -   ✓ Cataloged 163 instances
2025-10-21 15:07:17,215 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-21 15:07:17,215 - segmentation - INFO - Calculating segment statistics...
2025-10-21 15:07:17,247 - segmentation - INFO -   ✓ Calculated statistics for 30 motifs
2025-10-21 15:07:17,249 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-21 15:07:17,249 - visualization - INFO - Creating summary report...
2025-10-21 15:07:17,251 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-21 15:07:17,251 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:07:17,251 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-21 15:07:17,252 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:07:17,252 - visualization - INFO - Plotting top 10 motifs...
2025-10-21 15:07:17,853 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-21 15:07:18,345 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-21 15:07:18,827 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-21 15:07:19,389 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-21 15:07:19,846 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-21 15:07:20,298 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-21 15:07:20,781 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-21 15:07:21,243 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-21 15:07:21,753 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-21 15:07:22,209 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-21 15:07:22,209 - visualization - INFO - Creating motif overview plot...
2025-10-21 15:07:22,710 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-21 15:07:22,710 - visualization - INFO - Creating density analysis plot...
2025-10-21 15:07:23,198 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-21 15:07:23,199 - visualization - INFO - Creating correlation heatmap...
2025-10-21 15:07:23,463 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-21 15:07:23,464 - visualization - INFO - Creating feature distribution plots...
2025-10-21 15:07:24,603 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-21 15:07:24,603 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_8
2025-10-21 15:07:24,605 - __main__ - INFO - 
================================================================================
2025-10-21 15:07:24,606 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-21 15:07:24,606 - __main__ - INFO - ================================================================================
2025-10-21 15:07:24,606 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-21 15:07:24,606 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-21 15:07:24,606 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-21 15:07:24,606 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-21 15:37:27,081 - __main__ - INFO - 
================================================================================
2025-10-21 15:37:27,083 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-21 15:37:27,083 - __main__ - INFO - ================================================================================
2025-10-21 15:37:27,083 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-08-20 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-21 15:37:27,083 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:37:27,083 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-21 15:37:27,084 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:37:27,084 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-21 15:37:27,173 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-21 15:37:27,173 - database - INFO - ✅ Database connector initialized
2025-10-21 15:37:27,173 - database - INFO - Loading data from database for Mill 6...
2025-10-21 15:37:27,174 - database - INFO -   Date range: 2025-08-20 to 2025-10-19
2025-10-21 15:37:27,174 - database - INFO -   Resample frequency: 1min
2025-10-21 15:37:27,174 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-21 15:37:27,174 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 15:37:27,174 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-21 15:37:27,174 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-08-20 to 2025-10-19
2025-10-21 15:37:27,174 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 15:37:27,174 - db.db_connector - INFO - DEBUG: Current time: 2025-10-21 15:37:27.174886
2025-10-21 15:37:27,176 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 15:37:27,177 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 15:37:27,177 - db.db_connector - INFO - DEBUG: Days from now to end_date: -3
2025-10-21 15:37:27,177 - db.db_connector - INFO - DEBUG: Converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 15:37:27,178 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 15:37:27,178 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 15:37:27,178 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-21 15:37:27,211 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-21 15:37:27,211 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-21 15:37:27,229 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-21 15:37:27,886 - db.db_connector - INFO - Retrieved 86389 rows for Mill 6
2025-10-21 15:37:27,888 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:37:27,888 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-21 15:37:27,891 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 86389
2025-10-21 15:37:27,891 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-20 00:00:00
2025-10-21 15:37:27,891 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-21 15:37:27,892 - db.db_connector - INFO - Mill data retrieved: 86389 rows, 13 columns
2025-10-21 15:37:27,892 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-21 15:37:27,904 - db.db_connector - INFO - Mill data sample:
                            Ore  WaterMill  WaterZumpf  ...    MotorAmp      PSI80     PSI200
TimeStamp                                               ...                                  
2025-08-20 00:00:00  181.557000  16.865936  142.967267  ...  210.442672  52.000000  20.900000
2025-08-20 00:01:00  181.557000  16.904759  181.702737  ...  211.614935  52.000000  20.900000
2025-08-20 00:02:00  182.285591  16.968104  133.898571  ...  206.307136  51.216327  21.781633

[3 rows x 13 columns]
2025-10-21 15:37:27,914 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 15:37:27,915 - db.db_connector - INFO - DEBUG: Before date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:37:27,918 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 15:37:27,921 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 15:37:27,921 - db.db_connector - INFO - DEBUG: After date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:37:27,971 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-21 15:37:27,993 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-21 15:37:27,994 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 15:37:27,996 - db.db_connector - INFO - Processed mill data: 86401 rows, 13 columns
2025-10-21 15:37:27,996 - db.db_connector - INFO - Retrieving ore quality data
2025-10-21 15:37:27,996 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-08-20, end_date=2025-10-19
2025-10-21 15:37:27,996 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 15:37:27,998 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 15:37:27,998 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 15:37:27,999 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 15:37:28,000 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 15:37:28,003 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-21 15:37:28,003 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-21 15:37:28,007 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-21 15:37:28,011 - db.db_connector - INFO - DEBUG: ore_quality has 180 records in requested range 2025-08-20 to 2025-10-19
2025-10-21 15:37:28,017 - db.db_connector - INFO - Retrieved 180 rows of ore quality data
2025-10-21 15:37:28,018 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:37:28,018 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-21 15:37:28,019 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 180
2025-10-21 15:37:28,019 - db.db_connector - INFO - Ore data retrieved: 180 rows, 11 columns
2025-10-21 15:37:28,019 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-21 15:37:28,021 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 15:37:28,021 - db.db_connector - INFO - DEBUG: Before date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:37:28,022 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 180 rows (removed 0 rows)
2025-10-21 15:37:28,022 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 180 rows (removed 0 rows)
2025-10-21 15:37:28,022 - db.db_connector - INFO - DEBUG: After date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:37:28,033 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-21 15:37:28,033 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 15:37:28,035 - db.db_connector - INFO - Processed ore data: 85921 rows, 9 columns - with constant values (no interpolation)
2025-10-21 15:37:28,036 - db.db_connector - INFO - DF1 (mill): 86401 rows, index range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:37:28,036 - db.db_connector - INFO - DF2 (ore): 85921 rows, index range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:37:28,037 - db.db_connector - INFO - Found 85921 common timestamps
2025-10-21 15:37:28,050 - db.db_connector - INFO - Successfully joined dataframes: 85921 rows, 22 columns
2025-10-21 15:37:28,051 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 15:37:28,051 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:37:28,061 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 85921
2025-10-21 15:37:28,062 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 85921 records
2025-10-21 15:37:28,062 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-21 15:37:28,065 - db.db_connector - INFO -                         Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                            
2025-08-20 06:00:00  183.86  17.055654  160.167630  1996.986947  1599.186917    0.474443  1665.372881  3.823867  554.752728  703.051266  210.112138  50.891828  22.068006  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:01:00  183.86  17.042846  162.262963  1995.476894  1598.304249    0.474109  1665.749170  3.824933  554.565172  703.179260  209.921031  50.865161  22.094672  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:02:00  183.86  17.037084  162.091912  1993.315325  1600.078242    0.473947  1665.613778  3.829667  554.971853  703.383504  209.622913  50.838495  22.121339  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-10-21 15:37:28,066 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-21 15:37:28,069 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-21 15:37:28,070 - db.db_connector - INFO - ==================================================
2025-10-21 15:37:28,071 - db.db_connector - INFO - Combined data has 85921 rows and 22 columns
2025-10-21 15:37:28,072 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 15:37:28,081 - db.db_connector - INFO - Combined data sample:
                        Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                           ...                               
2025-08-20 06:00:00  183.86  17.055654  160.167630  ...  0.208   0.054             NaN
2025-08-20 06:01:00  183.86  17.042846  162.262963  ...  0.208   0.054             NaN
2025-08-20 06:02:00  183.86  17.037084  162.091912  ...  0.208   0.054             NaN

[3 rows x 22 columns]
2025-10-21 15:37:28,082 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-21 15:37:28,083 - db.db_connector - INFO - DEBUG: Final result - 85921 total records
2025-10-21 15:37:28,083 - db.db_connector - INFO - DEBUG: Final date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:37:28,108 - database - INFO -   ✓ Loaded 85921 rows, 24 columns
2025-10-21 15:37:29,183 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-21 15:40:37,580 - __main__ - INFO - 
================================================================================
2025-10-21 15:40:37,582 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-21 15:40:37,582 - __main__ - INFO - ================================================================================
2025-10-21 15:40:37,583 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-08-20 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf', 'MotorAmp']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-21 15:40:37,583 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 15:40:37,584 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-21 15:40:37,584 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 15:40:37,584 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-21 15:40:37,692 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-21 15:40:37,693 - database - INFO - ✅ Database connector initialized
2025-10-21 15:40:37,693 - database - INFO - Loading data from database for Mill 6...
2025-10-21 15:40:37,693 - database - INFO -   Date range: 2025-08-20 to 2025-10-19
2025-10-21 15:40:37,694 - database - INFO -   Resample frequency: 1min
2025-10-21 15:40:37,694 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-21 15:40:37,694 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 15:40:37,694 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-21 15:40:37,694 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-08-20 to 2025-10-19
2025-10-21 15:40:37,694 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-08-20, end_date=2025-10-19
2025-10-21 15:40:37,694 - db.db_connector - INFO - DEBUG: Current time: 2025-10-21 15:40:37.694657
2025-10-21 15:40:37,696 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 15:40:37,696 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 15:40:37,697 - db.db_connector - INFO - DEBUG: Days from now to end_date: -3
2025-10-21 15:40:37,697 - db.db_connector - INFO - DEBUG: Converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 15:40:37,697 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 15:40:37,698 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 15:40:37,698 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-21 15:40:37,734 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-21 15:40:37,734 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-21 15:40:37,753 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-21 15:40:38,412 - db.db_connector - INFO - Retrieved 86389 rows for Mill 6
2025-10-21 15:40:38,412 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:40:38,412 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-21 15:40:38,416 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 86389
2025-10-21 15:40:38,416 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-20 00:00:00
2025-10-21 15:40:38,416 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-21 15:40:38,418 - db.db_connector - INFO - Mill data retrieved: 86389 rows, 13 columns
2025-10-21 15:40:38,419 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-21 15:40:38,431 - db.db_connector - INFO - Mill data sample:
                            Ore  WaterMill  WaterZumpf  ...    MotorAmp      PSI80     PSI200
TimeStamp                                               ...                                  
2025-08-20 00:00:00  181.557000  16.865936  142.967267  ...  210.442672  52.000000  20.900000
2025-08-20 00:01:00  181.557000  16.904759  181.702737  ...  211.614935  52.000000  20.900000
2025-08-20 00:02:00  182.285591  16.968104  133.898571  ...  206.307136  51.216327  21.781633

[3 rows x 13 columns]
2025-10-21 15:40:38,440 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 15:40:38,441 - db.db_connector - INFO - DEBUG: Before date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:40:38,444 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 15:40:38,447 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 86389 rows (removed 0 rows)
2025-10-21 15:40:38,447 - db.db_connector - INFO - DEBUG: After date filtering: 86389 rows, date range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:40:38,498 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-21 15:40:38,518 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-21 15:40:38,519 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 15:40:38,521 - db.db_connector - INFO - Processed mill data: 86401 rows, 13 columns
2025-10-21 15:40:38,521 - db.db_connector - INFO - Retrieving ore quality data
2025-10-21 15:40:38,521 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-08-20, end_date=2025-10-19
2025-10-21 15:40:38,523 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-08-20 00:00:00 (timezone: None)
2025-10-21 15:40:38,523 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 15:40:38,524 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-08-20 -> 2025-08-20 00:00:00
2025-10-21 15:40:38,524 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 15:40:38,524 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-08-20 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 15:40:38,528 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-21 15:40:38,528 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-21 15:40:38,531 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-21 15:40:38,533 - db.db_connector - INFO - DEBUG: ore_quality has 180 records in requested range 2025-08-20 to 2025-10-19
2025-10-21 15:40:38,537 - db.db_connector - INFO - Retrieved 180 rows of ore quality data
2025-10-21 15:40:38,538 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:40:38,539 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-21 15:40:38,539 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 180
2025-10-21 15:40:38,539 - db.db_connector - INFO - Ore data retrieved: 180 rows, 11 columns
2025-10-21 15:40:38,539 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-21 15:40:38,540 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-08-20 00:00:00, end=2025-10-19 00:00:00
2025-10-21 15:40:38,540 - db.db_connector - INFO - DEBUG: Before date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:40:38,541 - db.db_connector - INFO - DEBUG: After start date filter (2025-08-20 00:00:00): 180 rows (removed 0 rows)
2025-10-21 15:40:38,541 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 180 rows (removed 0 rows)
2025-10-21 15:40:38,541 - db.db_connector - INFO - DEBUG: After date filtering: 180 rows, date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:40:38,552 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-21 15:40:38,552 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 15:40:38,554 - db.db_connector - INFO - Processed ore data: 85921 rows, 9 columns - with constant values (no interpolation)
2025-10-21 15:40:38,554 - db.db_connector - INFO - DF1 (mill): 86401 rows, index range: 2025-08-20 00:00:00 to 2025-10-19 00:00:00
2025-10-21 15:40:38,554 - db.db_connector - INFO - DF2 (ore): 85921 rows, index range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:40:38,555 - db.db_connector - INFO - Found 85921 common timestamps
2025-10-21 15:40:38,567 - db.db_connector - INFO - Successfully joined dataframes: 85921 rows, 22 columns
2025-10-21 15:40:38,567 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 15:40:38,568 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:40:38,577 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 85921
2025-10-21 15:40:38,578 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 85921 records
2025-10-21 15:40:38,578 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-21 15:40:38,581 - db.db_connector - INFO -                         Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                            
2025-08-20 06:00:00  183.86  17.055654  160.167630  1996.986947  1599.186917    0.474443  1665.372881  3.823867  554.752728  703.051266  210.112138  50.891828  22.068006  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:01:00  183.86  17.042846  162.262963  1995.476894  1598.304249    0.474109  1665.749170  3.824933  554.565172  703.179260  209.921031  50.865161  22.094672  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-08-20 06:02:00  183.86  17.037084  162.091912  1993.315325  1600.078242    0.473947  1665.613778  3.829667  554.971853  703.383504  209.622913  50.838495  22.121339  694   NaN      1       1.0       6.2  0.738  0.208   0.054             NaN
2025-10-21 15:40:38,582 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-21 15:40:38,584 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-21 15:40:38,584 - db.db_connector - INFO - ==================================================
2025-10-21 15:40:38,588 - db.db_connector - INFO - Combined data has 85921 rows and 22 columns
2025-10-21 15:40:38,588 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 15:40:38,597 - db.db_connector - INFO - Combined data sample:
                        Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                           ...                               
2025-08-20 06:00:00  183.86  17.055654  160.167630  ...  0.208   0.054             NaN
2025-08-20 06:01:00  183.86  17.042846  162.262963  ...  0.208   0.054             NaN
2025-08-20 06:02:00  183.86  17.037084  162.091912  ...  0.208   0.054             NaN

[3 rows x 22 columns]
2025-10-21 15:40:38,597 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-21 15:40:38,597 - db.db_connector - INFO - DEBUG: Final result - 85921 total records
2025-10-21 15:40:38,598 - db.db_connector - INFO - DEBUG: Final date range: 2025-08-20 06:00:00 to 2025-10-18 22:00:00
2025-10-21 15:40:38,624 - database - INFO -   ✓ Loaded 85921 rows, 24 columns
2025-10-21 15:40:39,694 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-21 16:15:18,532 - __main__ - INFO - 
================================================================================
2025-10-21 16:15:18,532 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-21 16:15:18,532 - __main__ - INFO - ================================================================================
2025-10-21 16:15:18,532 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-01-1 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-21 16:15:18,533 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 16:15:18,533 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-21 16:15:18,533 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 16:15:18,533 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-21 16:15:18,669 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-21 16:15:18,669 - database - INFO - ✅ Database connector initialized
2025-10-21 16:15:18,669 - database - INFO - Loading data from database for Mill 6...
2025-10-21 16:15:18,670 - database - INFO -   Date range: 2025-01-1 to 2025-10-19
2025-10-21 16:15:18,670 - database - INFO -   Resample frequency: 1min
2025-10-21 16:15:18,670 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-21 16:15:18,670 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-01-1, end_date=2025-10-19
2025-10-21 16:15:18,671 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-21 16:15:18,671 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-01-1 to 2025-10-19
2025-10-21 16:15:18,671 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-01-1, end_date=2025-10-19
2025-10-21 16:15:18,671 - db.db_connector - INFO - DEBUG: Current time: 2025-10-21 16:15:18.671755
2025-10-21 16:15:18,672 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-01-01 00:00:00 (timezone: None)
2025-10-21 16:15:18,673 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 16:15:18,673 - db.db_connector - INFO - DEBUG: Days from now to end_date: -3
2025-10-21 16:15:18,674 - db.db_connector - INFO - DEBUG: Converted start_date 2025-01-1 -> 2025-01-01 00:00:00
2025-10-21 16:15:18,674 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 16:15:18,674 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-01-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 16:15:18,674 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-21 16:15:18,705 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-21 16:15:18,707 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-21 16:15:18,721 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-21 16:15:22,531 - db.db_connector - INFO - Retrieved 418852 rows for Mill 6
2025-10-21 16:15:22,532 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-01-01 02:07:00 to 2025-10-19 00:00:00
2025-10-21 16:15:22,533 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-21 16:15:22,539 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 97134
2025-10-21 16:15:22,540 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-12 12:55:00
2025-10-21 16:15:22,540 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-21 16:15:22,540 - db.db_connector - INFO - Mill data retrieved: 418852 rows, 13 columns
2025-10-21 16:15:22,540 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-21 16:15:22,550 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp  PSI80  PSI200
TimeStamp                                            ...                           
2025-01-01 02:07:00  159.334  14.712979     225.132  ...  208.412746  667.0   157.0
2025-01-01 02:08:00  159.334  14.729826     225.132  ...  210.032806  667.0   157.0
2025-01-01 02:09:00  159.334  14.820792     225.132  ...  213.046922  667.0   157.0

[3 rows x 13 columns]
2025-10-21 16:15:22,564 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-01-01 00:00:00, end=2025-10-19 00:00:00
2025-10-21 16:15:22,565 - db.db_connector - INFO - DEBUG: Before date filtering: 418852 rows, date range: 2025-01-01 02:07:00 to 2025-10-19 00:00:00
2025-10-21 16:15:22,579 - db.db_connector - INFO - DEBUG: After start date filter (2025-01-01 00:00:00): 418852 rows (removed 0 rows)
2025-10-21 16:15:22,591 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 418852 rows (removed 0 rows)
2025-10-21 16:15:22,591 - db.db_connector - INFO - DEBUG: After date filtering: 418852 rows, date range: 2025-01-01 02:07:00 to 2025-10-19 00:00:00
2025-10-21 16:15:22,943 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-21 16:15:23,107 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-21 16:15:23,107 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 16:15:23,119 - db.db_connector - INFO - Processed mill data: 418914 rows, 13 columns
2025-10-21 16:15:23,120 - db.db_connector - INFO - Retrieving ore quality data
2025-10-21 16:15:23,120 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-01-1, end_date=2025-10-19
2025-10-21 16:15:23,121 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-01-01 00:00:00 (timezone: None)
2025-10-21 16:15:23,121 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-21 16:15:23,122 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-01-1 -> 2025-01-01 00:00:00
2025-10-21 16:15:23,122 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-21 16:15:23,122 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-01-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-21 16:15:23,124 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-21 16:15:23,126 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-21 16:15:23,128 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-21 16:15:23,129 - db.db_connector - INFO - DEBUG: ore_quality has 873 records in requested range 2025-01-1 to 2025-10-19
2025-10-21 16:15:23,139 - db.db_connector - INFO - Retrieved 873 rows of ore quality data
2025-10-21 16:15:23,140 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-01-01 06:00:00 to 2025-10-18 22:00:00
2025-10-21 16:15:23,141 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-21 16:15:23,143 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 203
2025-10-21 16:15:23,143 - db.db_connector - INFO - Ore data retrieved: 873 rows, 11 columns
2025-10-21 16:15:23,144 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-21 16:15:23,146 - db.db_connector - WARNING - Found 3 duplicate timestamps, removing duplicates
2025-10-21 16:15:23,146 - db.db_connector - INFO - After removing duplicates: 870 rows remaining
2025-10-21 16:15:23,148 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-01-01 00:00:00, end=2025-10-19 00:00:00
2025-10-21 16:15:23,148 - db.db_connector - INFO - DEBUG: Before date filtering: 870 rows, date range: 2025-01-01 06:00:00 to 2025-10-18 22:00:00
2025-10-21 16:15:23,148 - db.db_connector - INFO - DEBUG: After start date filter (2025-01-01 00:00:00): 870 rows (removed 0 rows)
2025-10-21 16:15:23,149 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 870 rows (removed 0 rows)
2025-10-21 16:15:23,149 - db.db_connector - INFO - DEBUG: After date filtering: 870 rows, date range: 2025-01-01 06:00:00 to 2025-10-18 22:00:00
2025-10-21 16:15:23,200 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-21 16:15:23,200 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-21 16:15:23,211 - db.db_connector - INFO - Processed ore data: 418561 rows, 9 columns - with constant values (no interpolation)
2025-10-21 16:15:23,212 - db.db_connector - INFO - DF1 (mill): 418914 rows, index range: 2025-01-01 02:07:00 to 2025-10-19 00:00:00
2025-10-21 16:15:23,213 - db.db_connector - INFO - DF2 (ore): 418561 rows, index range: 2025-01-01 06:00:00 to 2025-10-18 22:00:00
2025-10-21 16:15:23,213 - db.db_connector - INFO - Found 418561 common timestamps
2025-10-21 16:15:23,292 - db.db_connector - INFO - Successfully joined dataframes: 418561 rows, 22 columns
2025-10-21 16:15:23,293 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 16:15:23,293 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-01-01 06:00:00 to 2025-10-18 22:00:00
2025-10-21 16:15:23,299 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 97026
2025-10-21 16:15:23,299 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 97026 records
2025-10-21 16:15:23,300 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-21 16:15:23,303 - db.db_connector - INFO -                          Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp  PSI80  PSI200  id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                     
2025-01-01 06:00:00  159.559  14.934894  226.703356  1996.306436  1602.420326    0.540322  1627.879919  2.785400  490.606654  684.855034  210.613925  667.0   157.0   1   NaN      1       2.4       4.8  0.559  0.399   0.042             NaN
2025-01-01 06:01:00  159.559  14.920974  226.657000  1994.237762  1601.530977    0.540210  1627.981663  2.787333  490.806722  684.974264  210.416829  667.0   157.0   1   NaN      1       2.4       4.8  0.559  0.399   0.042             NaN
2025-01-01 06:02:00  159.559  14.897781  226.657000  1996.458690  1600.374492    0.539813  1628.058924  2.786400  490.432589  684.982420  210.700429  667.0   157.0   1   NaN      1       2.4       4.8  0.559  0.399   0.042             NaN
2025-10-21 16:15:23,304 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-21 16:15:23,307 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-21 16:15:23,308 - db.db_connector - INFO - ==================================================
2025-10-21 16:15:23,314 - db.db_connector - INFO - Combined data has 418561 rows and 22 columns
2025-10-21 16:15:23,315 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-21 16:15:23,325 - db.db_connector - INFO - Combined data sample:
                         Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                            ...                               
2025-01-01 06:00:00  159.559  14.934894  226.703356  ...  0.399   0.042             NaN
2025-01-01 06:01:00  159.559  14.920974  226.657000  ...  0.399   0.042             NaN
2025-01-01 06:02:00  159.559  14.897781  226.657000  ...  0.399   0.042             NaN

[3 rows x 22 columns]
2025-10-21 16:15:23,326 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-21 16:15:23,326 - db.db_connector - INFO - DEBUG: Final result - 418561 total records
2025-10-21 16:15:23,327 - db.db_connector - INFO - DEBUG: Final date range: 2025-01-01 06:00:00 to 2025-10-18 22:00:00
2025-10-21 16:15:23,432 - database - INFO -   ✓ Loaded 418561 rows, 24 columns
2025-10-21 16:15:28,959 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-21 16:15:28,960 - database - INFO - ✓ All 10 required columns present
2025-10-21 16:15:28,960 - database - INFO - Applying data filters...
2025-10-21 16:15:28,975 - database - INFO -   Ore: 100 < x < 220
2025-10-21 16:15:28,975 - database - INFO -   PulpHC: 400 < x < 600
2025-10-21 16:15:28,977 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-21 16:15:29,010 - database - INFO -   ✓ Filtered: 365305 rows kept, 53256 removed (12.7%)
2025-10-21 16:15:29,016 - circulative_load - INFO - Calculating circulative load...
2025-10-21 16:15:29,016 - circulative_load - INFO -   Using rho_solid = 2900 kg/m³
2025-10-21 16:15:29,044 - circulative_load - INFO -   ✓ Circulative load calculated for 365305 rows
2025-10-21 16:15:29,046 - circulative_load - INFO -     Mean: 2.220
2025-10-21 16:15:29,049 - circulative_load - INFO -     Median: 2.228
2025-10-21 16:15:29,054 - circulative_load - INFO -     Std: 0.267
2025-10-21 16:15:29,055 - circulative_load - INFO -     Min: 1.111
2025-10-21 16:15:29,055 - circulative_load - INFO -     Max: 4.820
2025-10-21 16:15:29,056 - circulative_load - INFO -     Values in typical range [1.5, 3.0]: 358874/365305 (98.2%)
2025-10-21 16:15:29,061 - circulative_load - INFO - Validating circulative load values...
2025-10-21 16:15:29,063 - circulative_load - INFO -   Total rows: 365305
2025-10-21 16:15:29,063 - circulative_load - INFO -   Valid values: 365305 (100.0%)
2025-10-21 16:15:29,063 - circulative_load - INFO -   Invalid/NaN values: 0 (0.0%)
2025-10-21 16:15:29,063 - circulative_load - INFO -   Out of range [0.5, 5.0]: 0 (0.0%)
2025-10-21 16:15:29,063 - __main__ - INFO -   ✓ Circulative load calculation complete
2025-10-21 16:15:34,731 - __main__ - INFO -   ✓ Updated data with circulative load saved to initial_data.csv
2025-10-21 16:15:34,732 - __main__ - INFO - ✓ Data loaded and filtered: 365305 rows
2025-10-21 16:15:34,733 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 16:15:34,734 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-21 16:15:34,734 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 16:15:34,734 - motif_discovery - INFO - Discovering motifs in 3 features...
2025-10-21 16:15:34,735 - motif_discovery - INFO -   Window size: 60
2025-10-21 16:15:34,735 - motif_discovery - INFO -   Max motifs: 20
2025-10-21 16:15:34,735 - motif_discovery - INFO -   Radius: 4.5
2025-10-21 16:15:34,748 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-21 18:04:04,224 - motif_discovery - INFO -   Discovering motif groups...
2025-10-21 18:04:13,762 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-21 18:04:13,762 - motif_discovery - INFO -   ✓ Total instances: 1732
2025-10-21 18:04:13,762 - motif_discovery - INFO -   ✓ Average distance: 3.127
2025-10-21 18:04:13,766 - __main__ - INFO - 
Applying correlation filter...
2025-10-21 18:04:13,766 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-21 18:04:13,766 - motif_discovery - INFO -   Filter level: instance
2025-10-21 18:04:13,766 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-21 18:04:13,766 - motif_discovery - INFO -   Rules:
2025-10-21 18:04:13,767 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-21 18:04:13,767 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-21 18:04:13,791 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-21 18:04:13,792 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-21 18:04:13,792 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-21 18:04:13,793 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 18:04:13,793 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-21 18:04:13,794 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 18:04:13,794 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-21 18:04:13,794 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-21 18:04:13,795 - density_analysis - INFO -   Window size: 60 minutes
2025-10-21 18:04:13,795 - density_analysis - INFO -   Max motifs: 15
2025-10-21 18:04:13,795 - density_analysis - INFO -   Radius: 4.5
2025-10-21 18:04:13,808 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-21 19:52:01,261 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-21 20:00:21,807 - density_analysis - INFO -   ✓ Found 13 motif groups
2025-10-21 20:00:21,807 - density_analysis - INFO -   ✓ Total instances: 206
2025-10-21 20:00:21,809 - __main__ - INFO - ✓ Density motif discovery complete: 13 motifs
2025-10-21 20:00:21,810 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 20:00:21,810 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-21 20:00:21,810 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 20:00:21,810 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-21 20:00:21,810 - density_analysis - INFO - 
Motif 1 (20 instances):
2025-10-21 20:00:21,851 - density_analysis - INFO -   Avg DensityHC change: +1.38
2025-10-21 20:00:21,853 - density_analysis - INFO -   Ore-Density correlation: +0.083 (lag: 0 min)
2025-10-21 20:00:21,853 - density_analysis - INFO -   WaterMill-Density correlation: +0.074 (lag: 0 min)
2025-10-21 20:00:21,853 - density_analysis - INFO - 
Motif 2 (20 instances):
2025-10-21 20:00:21,890 - density_analysis - INFO -   Avg DensityHC change: -1.79
2025-10-21 20:00:21,890 - density_analysis - INFO -   Ore-Density correlation: +0.301 (lag: -0 min)
2025-10-21 20:00:21,890 - density_analysis - INFO -   WaterMill-Density correlation: -0.205 (lag: 0 min)
2025-10-21 20:00:21,890 - density_analysis - INFO - 
Motif 3 (20 instances):
2025-10-21 20:00:21,927 - density_analysis - INFO -   Avg DensityHC change: -6.16
2025-10-21 20:00:21,927 - density_analysis - INFO -   Ore-Density correlation: +0.195 (lag: 0 min)
2025-10-21 20:00:21,927 - density_analysis - INFO -   WaterMill-Density correlation: +0.173 (lag: 0 min)
2025-10-21 20:00:21,929 - density_analysis - INFO - 
Motif 4 (20 instances):
2025-10-21 20:00:21,963 - density_analysis - INFO -   Avg DensityHC change: -1.91
2025-10-21 20:00:21,963 - density_analysis - INFO -   Ore-Density correlation: +0.125 (lag: 2 min)
2025-10-21 20:00:21,963 - density_analysis - INFO -   WaterMill-Density correlation: +0.076 (lag: 4 min)
2025-10-21 20:00:21,963 - density_analysis - INFO - 
Motif 5 (20 instances):
2025-10-21 20:00:21,998 - density_analysis - INFO -   Avg DensityHC change: +1.17
2025-10-21 20:00:21,998 - density_analysis - INFO -   Ore-Density correlation: +0.030 (lag: 2 min)
2025-10-21 20:00:21,999 - density_analysis - INFO -   WaterMill-Density correlation: +0.001 (lag: 0 min)
2025-10-21 20:00:21,999 - density_analysis - INFO - 
Motif 6 (20 instances):
2025-10-21 20:00:22,036 - density_analysis - INFO -   Avg DensityHC change: -0.36
2025-10-21 20:00:22,036 - density_analysis - INFO -   Ore-Density correlation: +0.115 (lag: 2 min)
2025-10-21 20:00:22,036 - density_analysis - INFO -   WaterMill-Density correlation: +0.004 (lag: 0 min)
2025-10-21 20:00:22,037 - density_analysis - INFO - 
Motif 7 (20 instances):
2025-10-21 20:00:22,074 - density_analysis - INFO -   Avg DensityHC change: -1.90
2025-10-21 20:00:22,074 - density_analysis - INFO -   Ore-Density correlation: -0.028 (lag: 0 min)
2025-10-21 20:00:22,074 - density_analysis - INFO -   WaterMill-Density correlation: +0.027 (lag: 0 min)
2025-10-21 20:00:22,074 - density_analysis - INFO - 
Motif 8 (14 instances):
2025-10-21 20:00:22,100 - density_analysis - INFO -   Avg DensityHC change: +1.80
2025-10-21 20:00:22,100 - density_analysis - INFO -   Ore-Density correlation: -0.007 (lag: 1 min)
2025-10-21 20:00:22,100 - density_analysis - INFO -   WaterMill-Density correlation: -0.120 (lag: 0 min)
2025-10-21 20:00:22,101 - density_analysis - INFO - 
Motif 9 (3 instances):
2025-10-21 20:00:22,106 - density_analysis - INFO -   Avg DensityHC change: -12.27
2025-10-21 20:00:22,108 - density_analysis - INFO -   Ore-Density correlation: +0.813 (lag: -1 min)
2025-10-21 20:00:22,108 - density_analysis - INFO -   WaterMill-Density correlation: +0.822 (lag: 0 min)
2025-10-21 20:00:22,109 - density_analysis - INFO - 
Motif 10 (20 instances):
2025-10-21 20:00:22,145 - density_analysis - INFO -   Avg DensityHC change: +4.64
2025-10-21 20:00:22,145 - density_analysis - INFO -   Ore-Density correlation: +0.279 (lag: 0 min)
2025-10-21 20:00:22,146 - density_analysis - INFO -   WaterMill-Density correlation: +0.300 (lag: 0 min)
2025-10-21 20:00:22,146 - density_analysis - INFO - 
Motif 11 (19 instances):
2025-10-21 20:00:22,180 - density_analysis - INFO -   Avg DensityHC change: +3.99
2025-10-21 20:00:22,180 - density_analysis - INFO -   Ore-Density correlation: +0.391 (lag: 2 min)
2025-10-21 20:00:22,181 - density_analysis - INFO -   WaterMill-Density correlation: +0.342 (lag: 0 min)
2025-10-21 20:00:22,181 - density_analysis - INFO - 
Motif 12 (6 instances):
2025-10-21 20:00:22,195 - density_analysis - INFO -   Avg DensityHC change: -4.65
2025-10-21 20:00:22,195 - density_analysis - INFO -   Ore-Density correlation: +0.376 (lag: -8 min)
2025-10-21 20:00:22,195 - density_analysis - INFO -   WaterMill-Density correlation: -0.383 (lag: -4 min)
2025-10-21 20:00:22,195 - density_analysis - INFO - 
Motif 13 (4 instances):
2025-10-21 20:00:22,205 - density_analysis - INFO -   Avg DensityHC change: -14.90
2025-10-21 20:00:22,205 - density_analysis - INFO -   Ore-Density correlation: +0.597 (lag: 4 min)
2025-10-21 20:00:22,205 - density_analysis - INFO -   WaterMill-Density correlation: +0.617 (lag: 8 min)
2025-10-21 20:00:22,208 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-21 20:00:22,209 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 20:00:22,209 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-21 20:00:22,209 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 20:00:22,209 - segmentation - INFO - Merging motif collections...
2025-10-21 20:00:22,209 - segmentation - INFO -   Primary motifs: 20
2025-10-21 20:00:22,209 - segmentation - INFO -   Secondary motifs: 13
2025-10-21 20:00:22,209 - segmentation - INFO -   ✓ Merged: 33 total motifs
2025-10-21 20:00:22,210 - __main__ - INFO - ✓ Total motifs: 33
2025-10-21 20:00:22,210 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 20:00:22,210 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-21 20:00:22,210 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 20:00:22,210 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-21 20:00:22,210 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 20:00:23,331 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 20:00:23,332 - segmentation - INFO -     - Total segments: 1732
2025-10-21 20:00:23,332 - segmentation - INFO -     - Total rows: 103920
2025-10-21 20:00:23,335 - segmentation - INFO -     - Unique motifs: 20
2025-10-21 20:00:23,351 - __main__ - INFO -   Creating complete dataset (33 motifs)...
2025-10-21 20:00:23,351 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-21 20:00:24,560 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-21 20:00:24,561 - segmentation - INFO -     - Total segments: 1938
2025-10-21 20:00:24,561 - segmentation - INFO -     - Total rows: 116280
2025-10-21 20:00:24,563 - segmentation - INFO -     - Unique motifs: 33
2025-10-21 20:00:26,462 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV.csv (103920 rows)
2025-10-21 20:00:28,583 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all.csv (116280 rows)
2025-10-21 20:00:28,586 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 20:00:28,587 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-21 20:00:28,587 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 20:00:28,587 - segmentation - INFO - Extracting motif summaries...
2025-10-21 20:00:28,652 - segmentation - INFO -   ✓ Created summary for 33 motifs
2025-10-21 20:00:28,653 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-21 20:00:28,654 - segmentation - INFO - Creating instance catalog...
2025-10-21 20:00:28,668 - segmentation - INFO -   ✓ Cataloged 1938 instances
2025-10-21 20:00:28,674 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-21 20:00:28,674 - segmentation - INFO - Calculating segment statistics...
2025-10-21 20:00:28,734 - segmentation - INFO -   ✓ Calculated statistics for 33 motifs
2025-10-21 20:00:28,736 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-21 20:00:28,736 - visualization - INFO - Creating summary report...
2025-10-21 20:00:28,737 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-21 20:00:28,738 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-21 20:00:28,738 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-21 20:00:28,738 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-21 20:00:28,739 - visualization - INFO - Plotting top 10 motifs...
2025-10-21 20:00:29,335 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-21 20:00:29,766 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-21 20:00:30,187 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-21 20:00:30,625 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-21 20:00:31,159 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-21 20:00:31,617 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-21 20:00:32,048 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-21 20:00:32,461 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-21 20:00:32,864 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-21 20:00:33,278 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-21 20:00:33,280 - visualization - INFO - Creating motif overview plot...
2025-10-21 20:00:33,704 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-21 20:00:33,705 - visualization - INFO - Creating density analysis plot...
2025-10-21 20:00:34,285 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-21 20:00:34,285 - visualization - INFO - Creating correlation heatmap...
2025-10-21 20:00:34,726 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-21 20:00:34,726 - visualization - INFO - Creating feature distribution plots...
2025-10-21 20:00:35,972 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-21 20:00:35,972 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_6
2025-10-21 20:00:35,972 - __main__ - INFO - 
================================================================================
2025-10-21 20:00:35,973 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-21 20:00:35,973 - __main__ - INFO - ================================================================================
2025-10-21 20:00:35,973 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-21 20:00:35,973 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-21 20:00:35,974 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-21 20:00:35,974 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-22 11:35:39,265 - __main__ - INFO - 
================================================================================
2025-10-22 11:35:39,266 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-22 11:35:39,266 - __main__ - INFO - ================================================================================
2025-10-22 11:35:39,266 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-09-1 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-22 11:35:39,266 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:35:39,266 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-22 11:35:39,266 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:35:39,266 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-22 11:35:39,394 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-22 11:35:39,394 - database - INFO - ✅ Database connector initialized
2025-10-22 11:35:39,395 - database - INFO - Loading data from database for Mill 6...
2025-10-22 11:35:39,395 - database - INFO -   Date range: 2025-09-1 to 2025-10-19
2025-10-22 11:35:39,395 - database - INFO -   Resample frequency: 1min
2025-10-22 11:35:39,395 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-22 11:35:39,395 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-09-1, end_date=2025-10-19
2025-10-22 11:35:39,395 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-22 11:35:39,395 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-09-1 to 2025-10-19
2025-10-22 11:35:39,395 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-09-1, end_date=2025-10-19
2025-10-22 11:35:39,395 - db.db_connector - INFO - DEBUG: Current time: 2025-10-22 11:35:39.395974
2025-10-22 11:35:39,398 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-09-01 00:00:00 (timezone: None)
2025-10-22 11:35:39,398 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-22 11:35:39,399 - db.db_connector - INFO - DEBUG: Days from now to end_date: -4
2025-10-22 11:35:39,399 - db.db_connector - INFO - DEBUG: Converted start_date 2025-09-1 -> 2025-09-01 00:00:00
2025-10-22 11:35:39,400 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-22 11:35:39,400 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-09-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-22 11:35:39,400 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-22 11:35:39,435 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-22 11:35:39,435 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-22 11:35:39,446 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-22 11:35:40,061 - db.db_connector - INFO - Retrieved 69109 rows for Mill 6
2025-10-22 11:35:40,062 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:35:40,062 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-22 11:35:40,065 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 69109
2025-10-22 11:35:40,065 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-09-01 00:00:00
2025-10-22 11:35:40,065 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-22 11:35:40,066 - db.db_connector - INFO - Mill data retrieved: 69109 rows, 13 columns
2025-10-22 11:35:40,066 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-22 11:35:40,078 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp  PSI80  PSI200
TimeStamp                                            ...                           
2025-09-01 00:00:00  176.967  14.681531   124.23800  ...  212.835485   52.0    20.5
2025-09-01 00:01:00  176.967  14.739024   124.23800  ...  209.783758   52.0    20.5
2025-09-01 00:02:00  176.967  14.716262   123.98775  ...  212.117882   52.0    20.5

[3 rows x 13 columns]
2025-10-22 11:35:40,088 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-09-01 00:00:00, end=2025-10-19 00:00:00
2025-10-22 11:35:40,088 - db.db_connector - INFO - DEBUG: Before date filtering: 69109 rows, date range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:35:40,089 - db.db_connector - INFO - DEBUG: After start date filter (2025-09-01 00:00:00): 69109 rows (removed 0 rows)
2025-10-22 11:35:40,092 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 69109 rows (removed 0 rows)
2025-10-22 11:35:40,092 - db.db_connector - INFO - DEBUG: After date filtering: 69109 rows, date range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:35:40,131 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-22 11:35:40,150 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-22 11:35:40,150 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-22 11:35:40,152 - db.db_connector - INFO - Processed mill data: 69121 rows, 13 columns
2025-10-22 11:35:40,152 - db.db_connector - INFO - Retrieving ore quality data
2025-10-22 11:35:40,152 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-09-1, end_date=2025-10-19
2025-10-22 11:35:40,154 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-09-01 00:00:00 (timezone: None)
2025-10-22 11:35:40,155 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-22 11:35:40,155 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-09-1 -> 2025-09-01 00:00:00
2025-10-22 11:35:40,156 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-22 11:35:40,156 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-09-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-22 11:35:40,161 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-22 11:35:40,161 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-22 11:35:40,163 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-22 11:35:40,164 - db.db_connector - INFO - DEBUG: ore_quality has 144 records in requested range 2025-09-1 to 2025-10-19
2025-10-22 11:35:40,168 - db.db_connector - INFO - Retrieved 144 rows of ore quality data
2025-10-22 11:35:40,168 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:35:40,168 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-22 11:35:40,170 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 144
2025-10-22 11:35:40,170 - db.db_connector - INFO - Ore data retrieved: 144 rows, 11 columns
2025-10-22 11:35:40,170 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-22 11:35:40,171 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-09-01 00:00:00, end=2025-10-19 00:00:00
2025-10-22 11:35:40,171 - db.db_connector - INFO - DEBUG: Before date filtering: 144 rows, date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:35:40,172 - db.db_connector - INFO - DEBUG: After start date filter (2025-09-01 00:00:00): 144 rows (removed 0 rows)
2025-10-22 11:35:40,172 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 144 rows (removed 0 rows)
2025-10-22 11:35:40,172 - db.db_connector - INFO - DEBUG: After date filtering: 144 rows, date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:35:40,182 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-22 11:35:40,182 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-22 11:35:40,184 - db.db_connector - INFO - Processed ore data: 68641 rows, 9 columns - with constant values (no interpolation)
2025-10-22 11:35:40,185 - db.db_connector - INFO - DF1 (mill): 69121 rows, index range: 2025-09-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:35:40,185 - db.db_connector - INFO - DF2 (ore): 68641 rows, index range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:35:40,185 - db.db_connector - INFO - Found 68641 common timestamps
2025-10-22 11:35:40,194 - db.db_connector - INFO - Successfully joined dataframes: 68641 rows, 22 columns
2025-10-22 11:35:40,194 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-22 11:35:40,195 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:35:40,203 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 68641
2025-10-22 11:35:40,203 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 68641 records
2025-10-22 11:35:40,203 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-22 11:35:40,207 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                                
2025-09-01 06:00:00  176.898480  14.730702     124.742  2042.187456  1602.319027    0.403065  1659.355988  3.207067  408.527603  674.914692  214.507862  50.823137  21.869804  730   NaN      1       0.6       5.6  0.668  0.273   0.059             NaN
2025-09-01 06:01:00  176.972747  14.721150     124.742  2040.682737  1601.375441    0.402159  1659.329429  3.203933  408.009086  674.898307  214.330872  50.983137  21.689804  730   NaN      1       0.6       5.6  0.668  0.273   0.059             NaN
2025-09-01 06:02:00  176.979680  14.716917     124.742  2039.980160  1603.366318    0.404820  1659.289190  3.200800  408.823780  675.810809  214.308859  51.077804  21.584471  730   NaN      1       0.6       5.6  0.668  0.273   0.059             NaN
2025-10-22 11:35:40,207 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-22 11:35:40,210 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-22 11:35:40,211 - db.db_connector - INFO - ==================================================
2025-10-22 11:35:40,212 - db.db_connector - INFO - Combined data has 68641 rows and 22 columns
2025-10-22 11:35:40,212 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-22 11:35:40,223 - db.db_connector - INFO - Combined data sample:
                            Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                               ...                               
2025-09-01 06:00:00  176.898480  14.730702     124.742  ...  0.273   0.059             NaN
2025-09-01 06:01:00  176.972747  14.721150     124.742  ...  0.273   0.059             NaN
2025-09-01 06:02:00  176.979680  14.716917     124.742  ...  0.273   0.059             NaN

[3 rows x 22 columns]
2025-10-22 11:35:40,224 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-22 11:35:40,224 - db.db_connector - INFO - DEBUG: Final result - 68641 total records
2025-10-22 11:35:40,225 - db.db_connector - INFO - DEBUG: Final date range: 2025-09-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:35:40,246 - database - INFO -   ✓ Loaded 68641 rows, 24 columns
2025-10-22 11:35:41,174 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-22 11:35:41,174 - database - INFO - ✓ All 10 required columns present
2025-10-22 11:35:41,174 - database - INFO - Applying data filters...
2025-10-22 11:35:41,177 - database - INFO -   Ore: 100 < x < 220
2025-10-22 11:35:41,178 - database - INFO -   PulpHC: 400 < x < 600
2025-10-22 11:35:41,178 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-22 11:35:41,184 - database - INFO -   ✓ Filtered: 66100 rows kept, 2541 removed (3.7%)
2025-10-22 11:35:41,186 - circulative_load - INFO - Calculating circulative load...
2025-10-22 11:35:41,187 - circulative_load - INFO -   Using rho_solid = 2900 kg/m³
2025-10-22 11:35:41,194 - circulative_load - INFO -   ✓ Circulative load calculated for 66100 rows
2025-10-22 11:35:41,194 - circulative_load - INFO -     Mean: 2.235
2025-10-22 11:35:41,194 - circulative_load - INFO -     Median: 2.246
2025-10-22 11:35:41,195 - circulative_load - INFO -     Std: 0.189
2025-10-22 11:35:41,195 - circulative_load - INFO -     Min: 1.114
2025-10-22 11:35:41,196 - circulative_load - INFO -     Max: 4.476
2025-10-22 11:35:41,196 - circulative_load - INFO -     Values in typical range [1.5, 3.0]: 65585/66100 (99.2%)
2025-10-22 11:35:41,197 - circulative_load - INFO - Validating circulative load values...
2025-10-22 11:35:41,198 - circulative_load - INFO -   Total rows: 66100
2025-10-22 11:35:41,198 - circulative_load - INFO -   Valid values: 66100 (100.0%)
2025-10-22 11:35:41,198 - circulative_load - INFO -   Invalid/NaN values: 0 (0.0%)
2025-10-22 11:35:41,199 - circulative_load - INFO -   Out of range [0.5, 5.0]: 0 (0.0%)
2025-10-22 11:35:41,199 - __main__ - INFO -   ✓ Circulative load calculation complete
2025-10-22 11:35:42,283 - __main__ - INFO -   ✓ Updated data with circulative load saved to initial_data.csv
2025-10-22 11:35:42,283 - __main__ - INFO - ✓ Data loaded and filtered: 66100 rows
2025-10-22 11:35:42,283 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:35:42,283 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-22 11:35:42,283 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:35:42,283 - motif_discovery - INFO - Discovering motifs in 3 features...
2025-10-22 11:35:42,283 - motif_discovery - INFO -   Window size: 60
2025-10-22 11:35:42,284 - motif_discovery - INFO -   Max motifs: 20
2025-10-22 11:35:42,284 - motif_discovery - INFO -   Radius: 4.5
2025-10-22 11:35:42,285 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-22 11:38:14,331 - motif_discovery - INFO -   Discovering motif groups...
2025-10-22 11:38:16,508 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-22 11:38:16,509 - motif_discovery - INFO -   ✓ Total instances: 322
2025-10-22 11:38:16,509 - motif_discovery - INFO -   ✓ Average distance: 2.916
2025-10-22 11:38:16,510 - __main__ - INFO - 
Applying correlation filter...
2025-10-22 11:38:16,510 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-22 11:38:16,510 - motif_discovery - INFO -   Filter level: instance
2025-10-22 11:38:16,510 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-22 11:38:16,511 - motif_discovery - INFO -   Rules:
2025-10-22 11:38:16,511 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-22 11:38:16,511 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-22 11:38:16,513 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-22 11:38:16,514 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-22 11:38:16,514 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-22 11:38:16,515 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:38:16,515 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-22 11:38:16,515 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:38:16,515 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-22 11:38:16,515 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-22 11:38:16,515 - density_analysis - INFO -   Window size: 60 minutes
2025-10-22 11:38:16,515 - density_analysis - INFO -   Max motifs: 15
2025-10-22 11:38:16,515 - density_analysis - INFO -   Radius: 4.5
2025-10-22 11:38:16,517 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-22 11:40:44,707 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-22 11:42:16,733 - density_analysis - INFO -   ✓ Found 8 motif groups
2025-10-22 11:42:16,733 - density_analysis - INFO -   ✓ Total instances: 32
2025-10-22 11:42:16,734 - __main__ - INFO - ✓ Density motif discovery complete: 8 motifs
2025-10-22 11:42:16,734 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:42:16,735 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-22 11:42:16,735 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:42:16,735 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-22 11:42:16,736 - density_analysis - INFO - 
Motif 1 (12 instances):
2025-10-22 11:42:16,758 - density_analysis - INFO -   Avg DensityHC change: +0.02
2025-10-22 11:42:16,758 - density_analysis - INFO -   Ore-Density correlation: -0.123 (lag: 0 min)
2025-10-22 11:42:16,758 - density_analysis - INFO -   WaterMill-Density correlation: -0.135 (lag: 0 min)
2025-10-22 11:42:16,760 - density_analysis - INFO - 
Motif 2 (4 instances):
2025-10-22 11:42:16,768 - density_analysis - INFO -   Avg DensityHC change: -4.34
2025-10-22 11:42:16,768 - density_analysis - INFO -   Ore-Density correlation: +0.240 (lag: -8 min)
2025-10-22 11:42:16,769 - density_analysis - INFO -   WaterMill-Density correlation: +0.354 (lag: -4 min)
2025-10-22 11:42:16,769 - density_analysis - INFO - 
Motif 3 (2 instances):
2025-10-22 11:42:16,772 - density_analysis - INFO -   Avg DensityHC change: +16.30
2025-10-22 11:42:16,772 - density_analysis - INFO -   Ore-Density correlation: -0.836 (lag: 2 min)
2025-10-22 11:42:16,773 - density_analysis - INFO -   WaterMill-Density correlation: -0.791 (lag: 2 min)
2025-10-22 11:42:16,773 - density_analysis - INFO - 
Motif 4 (4 instances):
2025-10-22 11:42:16,781 - density_analysis - INFO -   Avg DensityHC change: -3.51
2025-10-22 11:42:16,782 - density_analysis - INFO -   Ore-Density correlation: +0.369 (lag: -2 min)
2025-10-22 11:42:16,782 - density_analysis - INFO -   WaterMill-Density correlation: +0.395 (lag: 0 min)
2025-10-22 11:42:16,782 - density_analysis - INFO - 
Motif 5 (3 instances):
2025-10-22 11:42:16,788 - density_analysis - INFO -   Avg DensityHC change: +3.98
2025-10-22 11:42:16,789 - density_analysis - INFO -   Ore-Density correlation: -0.013 (lag: 0 min)
2025-10-22 11:42:16,789 - density_analysis - INFO -   WaterMill-Density correlation: -0.155 (lag: 0 min)
2025-10-22 11:42:16,789 - density_analysis - INFO - 
Motif 6 (3 instances):
2025-10-22 11:42:16,795 - density_analysis - INFO -   Avg DensityHC change: +7.83
2025-10-22 11:42:16,796 - density_analysis - INFO -   Ore-Density correlation: +0.766 (lag: 0 min)
2025-10-22 11:42:16,796 - density_analysis - INFO -   WaterMill-Density correlation: +0.747 (lag: -1 min)
2025-10-22 11:42:16,796 - density_analysis - INFO - 
Motif 7 (2 instances):
2025-10-22 11:42:16,801 - density_analysis - INFO -   Avg DensityHC change: +2.69
2025-10-22 11:42:16,801 - density_analysis - INFO -   Ore-Density correlation: -0.260 (lag: 10 min)
2025-10-22 11:42:16,801 - density_analysis - INFO -   WaterMill-Density correlation: -0.322 (lag: 8 min)
2025-10-22 11:42:16,801 - density_analysis - INFO - 
Motif 8 (2 instances):
2025-10-22 11:42:16,805 - density_analysis - INFO -   Avg DensityHC change: -13.34
2025-10-22 11:42:16,806 - density_analysis - INFO -   Ore-Density correlation: +0.632 (lag: -8 min)
2025-10-22 11:42:16,806 - density_analysis - INFO -   WaterMill-Density correlation: -0.804 (lag: -4 min)
2025-10-22 11:42:16,808 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-22 11:42:16,809 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:42:16,809 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-22 11:42:16,810 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:42:16,810 - segmentation - INFO - Merging motif collections...
2025-10-22 11:42:16,810 - segmentation - INFO -   Primary motifs: 20
2025-10-22 11:42:16,810 - segmentation - INFO -   Secondary motifs: 8
2025-10-22 11:42:16,810 - segmentation - INFO -   ✓ Merged: 28 total motifs
2025-10-22 11:42:16,810 - __main__ - INFO - ✓ Total motifs: 28
2025-10-22 11:42:16,810 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:42:16,810 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-22 11:42:16,810 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:42:16,810 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-22 11:42:16,810 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-22 11:42:16,982 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-22 11:42:16,982 - segmentation - INFO -     - Total segments: 322
2025-10-22 11:42:16,982 - segmentation - INFO -     - Total rows: 19320
2025-10-22 11:42:16,983 - segmentation - INFO -     - Unique motifs: 20
2025-10-22 11:42:16,987 - __main__ - INFO -   Creating complete dataset (28 motifs)...
2025-10-22 11:42:16,987 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-22 11:42:17,261 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-22 11:42:17,262 - segmentation - INFO -     - Total segments: 354
2025-10-22 11:42:17,262 - segmentation - INFO -     - Total rows: 21240
2025-10-22 11:42:17,263 - segmentation - INFO -     - Unique motifs: 28
2025-10-22 11:42:17,591 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV.csv (19320 rows)
2025-10-22 11:42:17,965 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all.csv (21240 rows)
2025-10-22 11:42:17,966 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:42:17,967 - __main__ - INFO - STEP 6: SAVING SEGMENTED DATA TO DATABASE
2025-10-22 11:42:17,967 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:42:17,967 - __main__ - INFO -   Saving segmented motifs data for Mill 6...
2025-10-22 11:42:17,967 - db.db_connector - INFO - Saving motifs data to database table: mills.MOTIFS_06
2025-10-22 11:42:17,967 - db.db_connector - INFO - DataFrame shape: (21240, 32)
2025-10-22 11:42:17,967 - db.db_connector - INFO - DataFrame columns: ['TimeStamp', 'Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'mill_id', 'C_v', 'C_m', 'M_solid_to_cyclone', 'CirculativeLoad', 'motif_id', 'segment_start', 'segment_end', 'motif_distance']
2025-10-22 11:42:26,231 - db.db_connector - INFO - ✅ Successfully saved 21240 rows to mills.MOTIFS_06
2025-10-22 11:42:26,232 - db.db_connector - INFO -    Action: replace
2025-10-22 11:42:26,237 - db.db_connector - INFO -    Verification: Table mills.MOTIFS_06 now contains 21240 rows
2025-10-22 11:42:26,240 - __main__ - INFO - ✓ Segmented data saved to database table: MOTIF_06
2025-10-22 11:42:26,241 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:42:26,241 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-22 11:42:26,241 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:42:26,241 - segmentation - INFO - Extracting motif summaries...
2025-10-22 11:42:26,258 - segmentation - INFO -   ✓ Created summary for 28 motifs
2025-10-22 11:42:26,260 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-22 11:42:26,261 - segmentation - INFO - Creating instance catalog...
2025-10-22 11:42:26,263 - segmentation - INFO -   ✓ Cataloged 354 instances
2025-10-22 11:42:26,267 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-22 11:42:26,267 - segmentation - INFO - Calculating segment statistics...
2025-10-22 11:42:26,304 - segmentation - INFO -   ✓ Calculated statistics for 28 motifs
2025-10-22 11:42:26,306 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-22 11:42:26,307 - visualization - INFO - Creating summary report...
2025-10-22 11:42:26,308 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-22 11:42:26,308 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:42:26,308 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-22 11:42:26,308 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:42:26,308 - visualization - INFO - Plotting top 10 motifs...
2025-10-22 11:42:26,840 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-22 11:42:27,240 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-22 11:42:27,625 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-22 11:42:28,034 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-22 11:42:28,428 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-22 11:42:28,852 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-22 11:42:29,245 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-22 11:42:29,771 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-22 11:42:30,201 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-22 11:42:30,607 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-22 11:42:30,607 - visualization - INFO - Creating motif overview plot...
2025-10-22 11:42:31,004 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-22 11:42:31,004 - visualization - INFO - Creating density analysis plot...
2025-10-22 11:42:31,583 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-22 11:42:31,583 - visualization - INFO - Creating correlation heatmap...
2025-10-22 11:42:31,881 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-22 11:42:31,881 - visualization - INFO - Creating feature distribution plots...
2025-10-22 11:42:33,171 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-22 11:42:33,171 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_6
2025-10-22 11:42:33,171 - __main__ - INFO - 
================================================================================
2025-10-22 11:42:33,172 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-22 11:42:33,172 - __main__ - INFO - ================================================================================
2025-10-22 11:42:33,172 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-22 11:42:33,172 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-22 11:42:33,172 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-22 11:42:33,172 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-22 11:52:47,390 - __main__ - INFO - 
================================================================================
2025-10-22 11:52:47,391 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-22 11:52:47,391 - __main__ - INFO - ================================================================================
2025-10-22 11:52:47,391 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-10-1 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-22 11:52:47,391 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:52:47,392 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-22 11:52:47,392 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:52:47,392 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-22 11:52:47,491 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-22 11:52:47,491 - database - INFO - ✅ Database connector initialized
2025-10-22 11:52:47,491 - database - INFO - Loading data from database for Mill 6...
2025-10-22 11:52:47,492 - database - INFO -   Date range: 2025-10-1 to 2025-10-19
2025-10-22 11:52:47,492 - database - INFO -   Resample frequency: 1min
2025-10-22 11:52:47,492 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-22 11:52:47,492 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-10-1, end_date=2025-10-19
2025-10-22 11:52:47,493 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-22 11:52:47,493 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-10-1 to 2025-10-19
2025-10-22 11:52:47,493 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-10-1, end_date=2025-10-19
2025-10-22 11:52:47,494 - db.db_connector - INFO - DEBUG: Current time: 2025-10-22 11:52:47.494089
2025-10-22 11:52:47,494 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-10-01 00:00:00 (timezone: None)
2025-10-22 11:52:47,495 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-22 11:52:47,495 - db.db_connector - INFO - DEBUG: Days from now to end_date: -4
2025-10-22 11:52:47,496 - db.db_connector - INFO - DEBUG: Converted start_date 2025-10-1 -> 2025-10-01 00:00:00
2025-10-22 11:52:47,496 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-22 11:52:47,496 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-10-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-22 11:52:47,497 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-22 11:52:47,531 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-22 11:52:47,531 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-22 11:52:47,544 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-22 11:52:47,781 - db.db_connector - INFO - Retrieved 25921 rows for Mill 6
2025-10-22 11:52:47,782 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:52:47,783 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-22 11:52:47,785 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 25921
2025-10-22 11:52:47,785 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-10-01 00:00:00
2025-10-22 11:52:47,786 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-22 11:52:47,786 - db.db_connector - INFO - Mill data retrieved: 25921 rows, 13 columns
2025-10-22 11:52:47,786 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-22 11:52:47,794 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp  PSI80  PSI200
TimeStamp                                            ...                           
2025-10-01 00:00:00  175.641  16.074357  175.375733  ...  208.235133   52.8    19.6
2025-10-01 00:01:00  175.641  16.081372  186.158786  ...  208.537825   52.8    19.6
2025-10-01 00:02:00  175.641  16.285897  165.261000  ...  208.956145   52.8    19.6

[3 rows x 13 columns]
2025-10-22 11:52:47,803 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-10-01 00:00:00, end=2025-10-19 00:00:00
2025-10-22 11:52:47,803 - db.db_connector - INFO - DEBUG: Before date filtering: 25921 rows, date range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:52:47,804 - db.db_connector - INFO - DEBUG: After start date filter (2025-10-01 00:00:00): 25921 rows (removed 0 rows)
2025-10-22 11:52:47,805 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 25921 rows (removed 0 rows)
2025-10-22 11:52:47,806 - db.db_connector - INFO - DEBUG: After date filtering: 25921 rows, date range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:52:47,819 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-22 11:52:47,824 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-22 11:52:47,824 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-22 11:52:47,826 - db.db_connector - INFO - Processed mill data: 25921 rows, 13 columns
2025-10-22 11:52:47,826 - db.db_connector - INFO - Retrieving ore quality data
2025-10-22 11:52:47,827 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-10-1, end_date=2025-10-19
2025-10-22 11:52:47,827 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-10-01 00:00:00 (timezone: None)
2025-10-22 11:52:47,828 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-22 11:52:47,828 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-10-1 -> 2025-10-01 00:00:00
2025-10-22 11:52:47,828 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-22 11:52:47,829 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-10-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-22 11:52:47,834 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-22 11:52:47,834 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-22 11:52:47,837 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-22 11:52:47,839 - db.db_connector - INFO - DEBUG: ore_quality has 54 records in requested range 2025-10-1 to 2025-10-19
2025-10-22 11:52:47,842 - db.db_connector - INFO - Retrieved 54 rows of ore quality data
2025-10-22 11:52:47,844 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:52:47,845 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-22 11:52:47,845 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 54
2025-10-22 11:52:47,845 - db.db_connector - INFO - Ore data retrieved: 54 rows, 11 columns
2025-10-22 11:52:47,846 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-22 11:52:47,847 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-10-01 00:00:00, end=2025-10-19 00:00:00
2025-10-22 11:52:47,848 - db.db_connector - INFO - DEBUG: Before date filtering: 54 rows, date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:52:47,848 - db.db_connector - INFO - DEBUG: After start date filter (2025-10-01 00:00:00): 54 rows (removed 0 rows)
2025-10-22 11:52:47,848 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 54 rows (removed 0 rows)
2025-10-22 11:52:47,849 - db.db_connector - INFO - DEBUG: After date filtering: 54 rows, date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:52:47,853 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-22 11:52:47,853 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-22 11:52:47,853 - db.db_connector - INFO - Processed ore data: 25441 rows, 9 columns - with constant values (no interpolation)
2025-10-22 11:52:47,854 - db.db_connector - INFO - DF1 (mill): 25921 rows, index range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:52:47,854 - db.db_connector - INFO - DF2 (ore): 25441 rows, index range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:52:47,855 - db.db_connector - INFO - Found 25441 common timestamps
2025-10-22 11:52:47,858 - db.db_connector - INFO - Successfully joined dataframes: 25441 rows, 22 columns
2025-10-22 11:52:47,858 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-22 11:52:47,859 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:52:47,862 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 25441
2025-10-22 11:52:47,863 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 25441 records
2025-10-22 11:52:47,863 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-22 11:52:47,866 - db.db_connector - INFO -                            Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp  PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                           
2025-10-01 06:00:00  175.79675  16.274777  176.869724  1962.232223  1649.574659    0.443846  1650.273079  3.432400  572.277313  697.768267  207.962289   53.6  18.685217  820   NaN      1       0.9       4.4  0.768  0.202    0.03             NaN
2025-10-01 06:01:00  175.80635  16.276501  175.965782  1963.492164  1650.467599    0.443712  1650.518650  3.427533  572.714654  697.879085  208.060184   53.6  18.638551  820   NaN      1       0.9       4.4  0.768  0.202    0.03             NaN
2025-10-01 06:02:00  175.81595  16.274134  175.379844  1962.421107  1649.571410    0.443808  1650.816317  3.426067  573.067152  697.957876  207.829274   53.6  18.600000  820   NaN      1       0.9       4.4  0.768  0.202    0.03             NaN
2025-10-22 11:52:47,866 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-22 11:52:47,870 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-22 11:52:47,871 - db.db_connector - INFO - ==================================================
2025-10-22 11:52:47,871 - db.db_connector - INFO - Combined data has 25441 rows and 22 columns
2025-10-22 11:52:47,871 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-22 11:52:47,881 - db.db_connector - INFO - Combined data sample:
                           Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                              ...                               
2025-10-01 06:00:00  175.79675  16.274777  176.869724  ...  0.202    0.03             NaN
2025-10-01 06:01:00  175.80635  16.276501  175.965782  ...  0.202    0.03             NaN
2025-10-01 06:02:00  175.81595  16.274134  175.379844  ...  0.202    0.03             NaN

[3 rows x 22 columns]
2025-10-22 11:52:47,882 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-22 11:52:47,882 - db.db_connector - INFO - DEBUG: Final result - 25441 total records
2025-10-22 11:52:47,882 - db.db_connector - INFO - DEBUG: Final date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:52:47,894 - database - INFO -   ✓ Loaded 25441 rows, 24 columns
2025-10-22 11:52:48,208 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-22 11:52:48,208 - database - INFO - ✓ All 10 required columns present
2025-10-22 11:52:48,208 - database - INFO - Applying data filters...
2025-10-22 11:52:48,210 - database - INFO -   Ore: 100 < x < 220
2025-10-22 11:52:48,210 - database - INFO -   PulpHC: 400 < x < 600
2025-10-22 11:52:48,211 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-22 11:52:48,213 - database - INFO -   ✓ Filtered: 24967 rows kept, 474 removed (1.9%)
2025-10-22 11:52:48,215 - circulative_load - INFO - Calculating circulative load...
2025-10-22 11:52:48,215 - circulative_load - INFO -   Using rho_solid = 2900 kg/m³
2025-10-22 11:52:48,219 - circulative_load - INFO -   ✓ Circulative load calculated for 24967 rows
2025-10-22 11:52:48,220 - circulative_load - INFO -     Mean: 2.277
2025-10-22 11:52:48,220 - circulative_load - INFO -     Median: 2.281
2025-10-22 11:52:48,221 - circulative_load - INFO -     Std: 0.165
2025-10-22 11:52:48,221 - circulative_load - INFO -     Min: 1.125
2025-10-22 11:52:48,221 - circulative_load - INFO -     Max: 3.688
2025-10-22 11:52:48,221 - circulative_load - INFO -     Values in typical range [1.5, 3.0]: 24944/24967 (99.9%)
2025-10-22 11:52:48,221 - circulative_load - INFO - Validating circulative load values...
2025-10-22 11:52:48,222 - circulative_load - INFO -   Total rows: 24967
2025-10-22 11:52:48,222 - circulative_load - INFO -   Valid values: 24967 (100.0%)
2025-10-22 11:52:48,222 - circulative_load - INFO -   Invalid/NaN values: 0 (0.0%)
2025-10-22 11:52:48,223 - circulative_load - INFO -   Out of range [0.5, 5.0]: 0 (0.0%)
2025-10-22 11:52:48,223 - __main__ - INFO -   ✓ Circulative load calculation complete
2025-10-22 11:52:48,607 - __main__ - INFO -   ✓ Updated data with circulative load saved to initial_data.csv
2025-10-22 11:52:48,607 - __main__ - INFO - ✓ Data loaded and filtered: 24967 rows
2025-10-22 11:52:48,609 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:52:48,609 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-22 11:52:48,609 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:52:48,609 - motif_discovery - INFO - Discovering motifs in 3 features...
2025-10-22 11:52:48,609 - motif_discovery - INFO -   Window size: 60
2025-10-22 11:52:48,609 - motif_discovery - INFO -   Max motifs: 20
2025-10-22 11:52:48,610 - motif_discovery - INFO -   Radius: 4.5
2025-10-22 11:52:48,611 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-22 11:53:16,485 - motif_discovery - INFO -   Discovering motif groups...
2025-10-22 11:53:17,611 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-22 11:53:17,612 - motif_discovery - INFO -   ✓ Total instances: 84
2025-10-22 11:53:17,612 - motif_discovery - INFO -   ✓ Average distance: 2.007
2025-10-22 11:53:17,613 - __main__ - INFO - 
Applying correlation filter...
2025-10-22 11:53:17,613 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-22 11:53:17,613 - motif_discovery - INFO -   Filter level: instance
2025-10-22 11:53:17,613 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-22 11:53:17,613 - motif_discovery - INFO -   Rules:
2025-10-22 11:53:17,613 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-22 11:53:17,613 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-22 11:53:17,615 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-22 11:53:17,615 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-22 11:53:17,615 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-22 11:53:17,615 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:53:17,616 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-22 11:53:17,616 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:53:17,616 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-22 11:53:17,616 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-22 11:53:17,616 - density_analysis - INFO -   Window size: 60 minutes
2025-10-22 11:53:17,616 - density_analysis - INFO -   Max motifs: 15
2025-10-22 11:53:17,616 - density_analysis - INFO -   Radius: 4.5
2025-10-22 11:53:17,618 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-22 11:53:44,276 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-22 11:54:24,272 - density_analysis - INFO -   ✓ Found 6 motif groups
2025-10-22 11:54:24,273 - density_analysis - INFO -   ✓ Total instances: 25
2025-10-22 11:54:24,274 - __main__ - INFO - ✓ Density motif discovery complete: 6 motifs
2025-10-22 11:54:24,274 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:54:24,274 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-22 11:54:24,274 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:54:24,274 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-22 11:54:24,274 - density_analysis - INFO - 
Motif 1 (9 instances):
2025-10-22 11:54:24,294 - density_analysis - INFO -   Avg DensityHC change: +0.60
2025-10-22 11:54:24,294 - density_analysis - INFO -   Ore-Density correlation: -0.095 (lag: 0 min)
2025-10-22 11:54:24,294 - density_analysis - INFO -   WaterMill-Density correlation: -0.106 (lag: 0 min)
2025-10-22 11:54:24,294 - density_analysis - INFO - 
Motif 2 (3 instances):
2025-10-22 11:54:24,302 - density_analysis - INFO -   Avg DensityHC change: -7.33
2025-10-22 11:54:24,302 - density_analysis - INFO -   Ore-Density correlation: +0.213 (lag: -4 min)
2025-10-22 11:54:24,303 - density_analysis - INFO -   WaterMill-Density correlation: +0.227 (lag: -1 min)
2025-10-22 11:54:24,303 - density_analysis - INFO - 
Motif 3 (4 instances):
2025-10-22 11:54:24,311 - density_analysis - INFO -   Avg DensityHC change: +6.55
2025-10-22 11:54:24,311 - density_analysis - INFO -   Ore-Density correlation: -0.030 (lag: 0 min)
2025-10-22 11:54:24,312 - density_analysis - INFO -   WaterMill-Density correlation: -0.020 (lag: 0 min)
2025-10-22 11:54:24,312 - density_analysis - INFO - 
Motif 4 (4 instances):
2025-10-22 11:54:24,322 - density_analysis - INFO -   Avg DensityHC change: +10.07
2025-10-22 11:54:24,322 - density_analysis - INFO -   Ore-Density correlation: +0.807 (lag: 0 min)
2025-10-22 11:54:24,322 - density_analysis - INFO -   WaterMill-Density correlation: +0.794 (lag: -0 min)
2025-10-22 11:54:24,322 - density_analysis - INFO - 
Motif 5 (3 instances):
2025-10-22 11:54:24,329 - density_analysis - INFO -   Avg DensityHC change: +5.19
2025-10-22 11:54:24,329 - density_analysis - INFO -   Ore-Density correlation: +0.724 (lag: 4 min)
2025-10-22 11:54:24,329 - density_analysis - INFO -   WaterMill-Density correlation: +0.694 (lag: 6 min)
2025-10-22 11:54:24,329 - density_analysis - INFO - 
Motif 6 (2 instances):
2025-10-22 11:54:24,334 - density_analysis - INFO -   Avg DensityHC change: +2.69
2025-10-22 11:54:24,335 - density_analysis - INFO -   Ore-Density correlation: -0.260 (lag: 10 min)
2025-10-22 11:54:24,335 - density_analysis - INFO -   WaterMill-Density correlation: -0.322 (lag: 8 min)
2025-10-22 11:54:24,336 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-22 11:54:24,336 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:54:24,336 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-22 11:54:24,337 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:54:24,337 - segmentation - INFO - Merging motif collections...
2025-10-22 11:54:24,337 - segmentation - INFO -   Primary motifs: 20
2025-10-22 11:54:24,337 - segmentation - INFO -   Secondary motifs: 6
2025-10-22 11:54:24,337 - segmentation - INFO -   ✓ Merged: 26 total motifs
2025-10-22 11:54:24,337 - __main__ - INFO - ✓ Total motifs: 26
2025-10-22 11:54:24,337 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:54:24,337 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-22 11:54:24,337 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:54:24,337 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-22 11:54:24,337 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-22 11:54:24,385 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-22 11:54:24,385 - segmentation - INFO -     - Total segments: 84
2025-10-22 11:54:24,385 - segmentation - INFO -     - Total rows: 5040
2025-10-22 11:54:24,385 - segmentation - INFO -     - Unique motifs: 20
2025-10-22 11:54:24,385 - __main__ - INFO -   Creating complete dataset (26 motifs)...
2025-10-22 11:54:24,385 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-22 11:54:24,445 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-22 11:54:24,445 - segmentation - INFO -     - Total segments: 109
2025-10-22 11:54:24,445 - segmentation - INFO -     - Total rows: 6540
2025-10-22 11:54:24,445 - segmentation - INFO -     - Unique motifs: 26
2025-10-22 11:54:24,518 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV_06.csv (5040 rows, 21 columns)
2025-10-22 11:54:24,609 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all_06.csv (6540 rows, 21 columns)
2025-10-22 11:54:24,609 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:54:24,609 - __main__ - INFO - STEP 6: SAVING SEGMENTED DATA TO DATABASE
2025-10-22 11:54:24,609 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:54:24,609 - __main__ - INFO -   Saving segmented motifs data for Mill 6...
2025-10-22 11:54:24,609 - __main__ - INFO -   Table will be recreated (if_exists='replace')
2025-10-22 11:54:24,609 - db.db_connector - INFO - Saving motifs data to database table: mills.MOTIFS_06
2025-10-22 11:54:24,609 - db.db_connector - INFO - DataFrame shape: (6540, 21)
2025-10-22 11:54:24,609 - db.db_connector - INFO - DataFrame columns: ['TimeStamp', 'Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'M_solid_to_cyclone', 'CirculativeLoad']
2025-10-22 11:54:26,780 - db.db_connector - INFO - ✅ Successfully saved 6540 rows to mills.MOTIFS_06
2025-10-22 11:54:26,781 - db.db_connector - INFO -    Action: replace
2025-10-22 11:54:26,784 - db.db_connector - INFO -    Verification: Table mills.MOTIFS_06 now contains 6540 rows
2025-10-22 11:54:26,784 - __main__ - INFO - ✓ Segmented data saved to database table: MOTIFS_06
2025-10-22 11:54:26,785 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:54:26,785 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-22 11:54:26,785 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:54:26,785 - segmentation - INFO - Extracting motif summaries...
2025-10-22 11:54:26,796 - segmentation - INFO -   ✓ Created summary for 26 motifs
2025-10-22 11:54:26,799 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-22 11:54:26,799 - segmentation - INFO - Creating instance catalog...
2025-10-22 11:54:26,802 - segmentation - INFO -   ✓ Cataloged 109 instances
2025-10-22 11:54:26,802 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-22 11:54:26,803 - segmentation - INFO - Calculating segment statistics...
2025-10-22 11:56:01,982 - __main__ - INFO - 
================================================================================
2025-10-22 11:56:01,982 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-22 11:56:01,983 - __main__ - INFO - ================================================================================
2025-10-22 11:56:01,983 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-10-1 to 2025-10-19

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-22 11:56:01,983 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:56:01,984 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-22 11:56:01,984 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:56:01,984 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-22 11:56:02,078 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-22 11:56:02,079 - database - INFO - ✅ Database connector initialized
2025-10-22 11:56:02,079 - database - INFO - Loading data from database for Mill 6...
2025-10-22 11:56:02,079 - database - INFO -   Date range: 2025-10-1 to 2025-10-19
2025-10-22 11:56:02,080 - database - INFO -   Resample frequency: 1min
2025-10-22 11:56:02,080 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-22 11:56:02,080 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-10-1, end_date=2025-10-19
2025-10-22 11:56:02,080 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-22 11:56:02,080 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-10-1 to 2025-10-19
2025-10-22 11:56:02,080 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-10-1, end_date=2025-10-19
2025-10-22 11:56:02,080 - db.db_connector - INFO - DEBUG: Current time: 2025-10-22 11:56:02.080239
2025-10-22 11:56:02,082 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-10-01 00:00:00 (timezone: None)
2025-10-22 11:56:02,082 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-22 11:56:02,083 - db.db_connector - INFO - DEBUG: Days from now to end_date: -4
2025-10-22 11:56:02,083 - db.db_connector - INFO - DEBUG: Converted start_date 2025-10-1 -> 2025-10-01 00:00:00
2025-10-22 11:56:02,084 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-22 11:56:02,084 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-10-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-22 11:56:02,084 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-22 11:56:02,117 - db.db_connector - INFO - DEBUG: Table MILL_06 has 419351 total records
2025-10-22 11:56:02,118 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-19 08:19:00
2025-10-22 11:56:02,129 - db.db_connector - INFO - DEBUG: Table MILL_06 has 97633 records after 2025-08-12 12:54:00
2025-10-22 11:56:02,370 - db.db_connector - INFO - Retrieved 25921 rows for Mill 6
2025-10-22 11:56:02,370 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:56:02,371 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-18 23:56:00'), Timestamp('2025-10-18 23:57:00'), Timestamp('2025-10-18 23:58:00'), Timestamp('2025-10-18 23:59:00'), Timestamp('2025-10-19 00:00:00')]
2025-10-22 11:56:02,372 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 25921
2025-10-22 11:56:02,372 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-10-01 00:00:00
2025-10-22 11:56:02,373 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-19 00:00:00
2025-10-22 11:56:02,373 - db.db_connector - INFO - Mill data retrieved: 25921 rows, 13 columns
2025-10-22 11:56:02,373 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-22 11:56:02,383 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp  PSI80  PSI200
TimeStamp                                            ...                           
2025-10-01 00:00:00  175.641  16.074357  175.375733  ...  208.235133   52.8    19.6
2025-10-01 00:01:00  175.641  16.081372  186.158786  ...  208.537825   52.8    19.6
2025-10-01 00:02:00  175.641  16.285897  165.261000  ...  208.956145   52.8    19.6

[3 rows x 13 columns]
2025-10-22 11:56:02,394 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-10-01 00:00:00, end=2025-10-19 00:00:00
2025-10-22 11:56:02,394 - db.db_connector - INFO - DEBUG: Before date filtering: 25921 rows, date range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:56:02,395 - db.db_connector - INFO - DEBUG: After start date filter (2025-10-01 00:00:00): 25921 rows (removed 0 rows)
2025-10-22 11:56:02,396 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 25921 rows (removed 0 rows)
2025-10-22 11:56:02,397 - db.db_connector - INFO - DEBUG: After date filtering: 25921 rows, date range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:56:02,410 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-22 11:56:02,416 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-22 11:56:02,416 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-22 11:56:02,416 - db.db_connector - INFO - Processed mill data: 25921 rows, 13 columns
2025-10-22 11:56:02,418 - db.db_connector - INFO - Retrieving ore quality data
2025-10-22 11:56:02,418 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-10-1, end_date=2025-10-19
2025-10-22 11:56:02,418 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-10-01 00:00:00 (timezone: None)
2025-10-22 11:56:02,418 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-19 00:00:00 (timezone: None)
2025-10-22 11:56:02,419 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-10-1 -> 2025-10-01 00:00:00
2025-10-22 11:56:02,420 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-19 -> 2025-10-19 00:00:00
2025-10-22 11:56:02,420 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-10-01 00:00:00' AND "TimeStamp" <= '2025-10-19 00:00:00'
2025-10-22 11:56:02,423 - db.db_connector - INFO - DEBUG: ore_quality table has 876 total records
2025-10-22 11:56:02,424 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-19 22:00:00
2025-10-22 11:56:02,426 - db.db_connector - INFO - DEBUG: ore_quality table has 206 records after 2025-08-12 12:54:00
2025-10-22 11:56:02,429 - db.db_connector - INFO - DEBUG: ore_quality has 54 records in requested range 2025-10-1 to 2025-10-19
2025-10-22 11:56:02,430 - db.db_connector - INFO - Retrieved 54 rows of ore quality data
2025-10-22 11:56:02,433 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:56:02,434 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-17 14:00:00'), Timestamp('2025-10-17 22:00:00'), Timestamp('2025-10-18 06:00:00'), Timestamp('2025-10-18 14:00:00'), Timestamp('2025-10-18 22:00:00')]
2025-10-22 11:56:02,434 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 54
2025-10-22 11:56:02,434 - db.db_connector - INFO - Ore data retrieved: 54 rows, 11 columns
2025-10-22 11:56:02,434 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-22 11:56:02,437 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-10-01 00:00:00, end=2025-10-19 00:00:00
2025-10-22 11:56:02,437 - db.db_connector - INFO - DEBUG: Before date filtering: 54 rows, date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:56:02,439 - db.db_connector - INFO - DEBUG: After start date filter (2025-10-01 00:00:00): 54 rows (removed 0 rows)
2025-10-22 11:56:02,439 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-19 00:00:00): 54 rows (removed 0 rows)
2025-10-22 11:56:02,440 - db.db_connector - INFO - DEBUG: After date filtering: 54 rows, date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:56:02,446 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-22 11:56:02,446 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-22 11:56:02,447 - db.db_connector - INFO - Processed ore data: 25441 rows, 9 columns - with constant values (no interpolation)
2025-10-22 11:56:02,447 - db.db_connector - INFO - DF1 (mill): 25921 rows, index range: 2025-10-01 00:00:00 to 2025-10-19 00:00:00
2025-10-22 11:56:02,448 - db.db_connector - INFO - DF2 (ore): 25441 rows, index range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:56:02,449 - db.db_connector - INFO - Found 25441 common timestamps
2025-10-22 11:56:02,454 - db.db_connector - INFO - Successfully joined dataframes: 25441 rows, 22 columns
2025-10-22 11:56:02,454 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-22 11:56:02,455 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:56:02,459 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 25441
2025-10-22 11:56:02,459 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 25441 records
2025-10-22 11:56:02,460 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-22 11:56:02,463 - db.db_connector - INFO -                            Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp  PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                           
2025-10-01 06:00:00  175.79675  16.274777  176.869724  1962.232223  1649.574659    0.443846  1650.273079  3.432400  572.277313  697.768267  207.962289   53.6  18.685217  820   NaN      1       0.9       4.4  0.768  0.202    0.03             NaN
2025-10-01 06:01:00  175.80635  16.276501  175.965782  1963.492164  1650.467599    0.443712  1650.518650  3.427533  572.714654  697.879085  208.060184   53.6  18.638551  820   NaN      1       0.9       4.4  0.768  0.202    0.03             NaN
2025-10-01 06:02:00  175.81595  16.274134  175.379844  1962.421107  1649.571410    0.443808  1650.816317  3.426067  573.067152  697.957876  207.829274   53.6  18.600000  820   NaN      1       0.9       4.4  0.768  0.202    0.03             NaN
2025-10-22 11:56:02,464 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-22 11:56:02,469 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC  PumpRPM    MotorAmp      PSI80     PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                             
2025-10-18 21:58:00  184.983100  17.116227  163.725272  1953.412516  1578.891076    0.458463  1671.000365  3.466000  580.919349   731.58  206.456408  47.475000  25.725000  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 21:59:00  184.924767  17.131345  163.906099  1950.305726  1579.555746    0.458307  1671.124744  3.468867  581.347279   731.58  206.137138  47.388333  25.811667  872   NaN      2       1.1       5.6  0.678  0.247   0.075             NaN
2025-10-18 22:00:00  184.866433  17.132532  164.535689  1947.714174  1580.133010    0.458395  1671.160114  3.471733  581.607567   731.58  205.816949  47.301667  25.898333  873   NaN      3       1.1       7.0  0.664  0.263   0.073             NaN
2025-10-22 11:56:02,469 - db.db_connector - INFO - ==================================================
2025-10-22 11:56:02,470 - db.db_connector - INFO - Combined data has 25441 rows and 22 columns
2025-10-22 11:56:02,470 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-22 11:56:02,481 - db.db_connector - INFO - Combined data sample:
                           Ore  WaterMill  WaterZumpf  ...  Daiki  Shisti  Original_Sheet
TimeStamp                                              ...                               
2025-10-01 06:00:00  175.79675  16.274777  176.869724  ...  0.202    0.03             NaN
2025-10-01 06:01:00  175.80635  16.276501  175.965782  ...  0.202    0.03             NaN
2025-10-01 06:02:00  175.81595  16.274134  175.379844  ...  0.202    0.03             NaN

[3 rows x 22 columns]
2025-10-22 11:56:02,481 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-22 11:56:02,482 - db.db_connector - INFO - DEBUG: Final result - 25441 total records
2025-10-22 11:56:02,482 - db.db_connector - INFO - DEBUG: Final date range: 2025-10-01 06:00:00 to 2025-10-18 22:00:00
2025-10-22 11:56:02,496 - database - INFO -   ✓ Loaded 25441 rows, 24 columns
2025-10-22 11:56:02,810 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-22 11:56:02,811 - database - INFO - ✓ All 10 required columns present
2025-10-22 11:56:02,811 - database - INFO - Applying data filters...
2025-10-22 11:56:02,812 - database - INFO -   Ore: 100 < x < 220
2025-10-22 11:56:02,814 - database - INFO -   PulpHC: 400 < x < 600
2025-10-22 11:56:02,815 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-22 11:56:02,817 - database - INFO -   ✓ Filtered: 24967 rows kept, 474 removed (1.9%)
2025-10-22 11:56:02,817 - circulative_load - INFO - Calculating circulative load...
2025-10-22 11:56:02,817 - circulative_load - INFO -   Using rho_solid = 2900 kg/m³
2025-10-22 11:56:02,825 - circulative_load - INFO -   ✓ Circulative load calculated for 24967 rows
2025-10-22 11:56:02,825 - circulative_load - INFO -     Mean: 2.277
2025-10-22 11:56:02,825 - circulative_load - INFO -     Median: 2.281
2025-10-22 11:56:02,825 - circulative_load - INFO -     Std: 0.165
2025-10-22 11:56:02,827 - circulative_load - INFO -     Min: 1.125
2025-10-22 11:56:02,827 - circulative_load - INFO -     Max: 3.688
2025-10-22 11:56:02,827 - circulative_load - INFO -     Values in typical range [1.5, 3.0]: 24944/24967 (99.9%)
2025-10-22 11:56:02,828 - circulative_load - INFO - Validating circulative load values...
2025-10-22 11:56:02,828 - circulative_load - INFO -   Total rows: 24967
2025-10-22 11:56:02,828 - circulative_load - INFO -   Valid values: 24967 (100.0%)
2025-10-22 11:56:02,829 - circulative_load - INFO -   Invalid/NaN values: 0 (0.0%)
2025-10-22 11:56:02,829 - circulative_load - INFO -   Out of range [0.5, 5.0]: 0 (0.0%)
2025-10-22 11:56:02,829 - __main__ - INFO -   ✓ Circulative load calculation complete
2025-10-22 11:56:03,207 - __main__ - INFO -   ✓ Updated data with circulative load saved to initial_data.csv
2025-10-22 11:56:03,207 - __main__ - INFO - ✓ Data loaded and filtered: 24967 rows
2025-10-22 11:56:03,207 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:56:03,207 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-22 11:56:03,207 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:56:03,208 - motif_discovery - INFO - Discovering motifs in 3 features...
2025-10-22 11:56:03,208 - motif_discovery - INFO -   Window size: 60
2025-10-22 11:56:03,208 - motif_discovery - INFO -   Max motifs: 20
2025-10-22 11:56:03,209 - motif_discovery - INFO -   Radius: 4.5
2025-10-22 11:56:03,210 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-22 11:56:28,597 - motif_discovery - INFO -   Discovering motif groups...
2025-10-22 11:56:29,510 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-22 11:56:29,510 - motif_discovery - INFO -   ✓ Total instances: 84
2025-10-22 11:56:29,510 - motif_discovery - INFO -   ✓ Average distance: 2.007
2025-10-22 11:56:29,510 - __main__ - INFO - 
Applying correlation filter...
2025-10-22 11:56:29,512 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-22 11:56:29,512 - motif_discovery - INFO -   Filter level: instance
2025-10-22 11:56:29,512 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-22 11:56:29,512 - motif_discovery - INFO -   Rules:
2025-10-22 11:56:29,512 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-22 11:56:29,512 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-22 11:56:29,512 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-22 11:56:29,514 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-22 11:56:29,514 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-22 11:56:29,514 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:56:29,514 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-22 11:56:29,514 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:56:29,515 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-22 11:56:29,515 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-22 11:56:29,515 - density_analysis - INFO -   Window size: 60 minutes
2025-10-22 11:56:29,515 - density_analysis - INFO -   Max motifs: 15
2025-10-22 11:56:29,515 - density_analysis - INFO -   Radius: 4.5
2025-10-22 11:56:29,515 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-22 11:56:50,931 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-22 11:57:21,826 - density_analysis - INFO -   ✓ Found 6 motif groups
2025-10-22 11:57:21,826 - density_analysis - INFO -   ✓ Total instances: 25
2025-10-22 11:57:21,828 - __main__ - INFO - ✓ Density motif discovery complete: 6 motifs
2025-10-22 11:57:21,828 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:57:21,828 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-22 11:57:21,828 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:57:21,828 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-22 11:57:21,828 - density_analysis - INFO - 
Motif 1 (9 instances):
2025-10-22 11:57:21,849 - density_analysis - INFO -   Avg DensityHC change: +0.60
2025-10-22 11:57:21,849 - density_analysis - INFO -   Ore-Density correlation: -0.095 (lag: 0 min)
2025-10-22 11:57:21,850 - density_analysis - INFO -   WaterMill-Density correlation: -0.106 (lag: 0 min)
2025-10-22 11:57:21,850 - density_analysis - INFO - 
Motif 2 (3 instances):
2025-10-22 11:57:21,857 - density_analysis - INFO -   Avg DensityHC change: -7.33
2025-10-22 11:57:21,858 - density_analysis - INFO -   Ore-Density correlation: +0.213 (lag: -4 min)
2025-10-22 11:57:21,858 - density_analysis - INFO -   WaterMill-Density correlation: +0.227 (lag: -1 min)
2025-10-22 11:57:21,858 - density_analysis - INFO - 
Motif 3 (4 instances):
2025-10-22 11:57:21,866 - density_analysis - INFO -   Avg DensityHC change: +6.55
2025-10-22 11:57:21,867 - density_analysis - INFO -   Ore-Density correlation: -0.030 (lag: 0 min)
2025-10-22 11:57:21,867 - density_analysis - INFO -   WaterMill-Density correlation: -0.020 (lag: 0 min)
2025-10-22 11:57:21,868 - density_analysis - INFO - 
Motif 4 (4 instances):
2025-10-22 11:57:21,876 - density_analysis - INFO -   Avg DensityHC change: +10.07
2025-10-22 11:57:21,876 - density_analysis - INFO -   Ore-Density correlation: +0.807 (lag: 0 min)
2025-10-22 11:57:21,877 - density_analysis - INFO -   WaterMill-Density correlation: +0.794 (lag: -0 min)
2025-10-22 11:57:21,877 - density_analysis - INFO - 
Motif 5 (3 instances):
2025-10-22 11:57:21,882 - density_analysis - INFO -   Avg DensityHC change: +5.19
2025-10-22 11:57:21,883 - density_analysis - INFO -   Ore-Density correlation: +0.724 (lag: 4 min)
2025-10-22 11:57:21,883 - density_analysis - INFO -   WaterMill-Density correlation: +0.694 (lag: 6 min)
2025-10-22 11:57:21,883 - density_analysis - INFO - 
Motif 6 (2 instances):
2025-10-22 11:57:21,887 - density_analysis - INFO -   Avg DensityHC change: +2.69
2025-10-22 11:57:21,887 - density_analysis - INFO -   Ore-Density correlation: -0.260 (lag: 10 min)
2025-10-22 11:57:21,887 - density_analysis - INFO -   WaterMill-Density correlation: -0.322 (lag: 8 min)
2025-10-22 11:57:21,888 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-22 11:57:21,888 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:57:21,888 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-22 11:57:21,888 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:57:21,888 - segmentation - INFO - Merging motif collections...
2025-10-22 11:57:21,888 - segmentation - INFO -   Primary motifs: 20
2025-10-22 11:57:21,890 - segmentation - INFO -   Secondary motifs: 6
2025-10-22 11:57:21,890 - segmentation - INFO -   ✓ Merged: 26 total motifs
2025-10-22 11:57:21,890 - __main__ - INFO - ✓ Total motifs: 26
2025-10-22 11:57:21,890 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:57:21,890 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-22 11:57:21,890 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:57:21,890 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-22 11:57:21,890 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-22 11:57:21,936 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-22 11:57:21,937 - segmentation - INFO -     - Total segments: 84
2025-10-22 11:57:21,937 - segmentation - INFO -     - Total rows: 5040
2025-10-22 11:57:21,938 - segmentation - INFO -     - Unique motifs: 20
2025-10-22 11:57:21,939 - __main__ - INFO -   Creating complete dataset (26 motifs)...
2025-10-22 11:57:21,939 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-22 11:57:21,998 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-22 11:57:21,998 - segmentation - INFO -     - Total segments: 109
2025-10-22 11:57:21,998 - segmentation - INFO -     - Total rows: 6540
2025-10-22 11:57:21,999 - segmentation - INFO -     - Unique motifs: 26
2025-10-22 11:57:22,073 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV_06.csv (5040 rows, 22 columns)
2025-10-22 11:57:22,166 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all_06.csv (6540 rows, 22 columns)
2025-10-22 11:57:22,166 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:57:22,166 - __main__ - INFO - STEP 6: SAVING SEGMENTED DATA TO DATABASE
2025-10-22 11:57:22,166 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:57:22,166 - __main__ - INFO -   Saving segmented motifs data for Mill 6...
2025-10-22 11:57:22,166 - __main__ - INFO -   Table will be recreated (if_exists='replace')
2025-10-22 11:57:22,166 - db.db_connector - INFO - Saving motifs data to database table: mills.MOTIFS_06
2025-10-22 11:57:22,167 - db.db_connector - INFO - DataFrame shape: (6540, 22)
2025-10-22 11:57:22,167 - db.db_connector - INFO - DataFrame columns: ['TimeStamp', 'Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'M_solid_to_cyclone', 'CirculativeLoad', 'motif_id']
2025-10-22 11:57:24,273 - db.db_connector - INFO - ✅ Successfully saved 6540 rows to mills.MOTIFS_06
2025-10-22 11:57:24,274 - db.db_connector - INFO -    Action: replace
2025-10-22 11:57:24,276 - db.db_connector - INFO -    Verification: Table mills.MOTIFS_06 now contains 6540 rows
2025-10-22 11:57:24,278 - __main__ - INFO - ✓ Segmented data saved to database table: MOTIFS_06
2025-10-22 11:57:24,278 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:57:24,278 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-22 11:57:24,278 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:57:24,278 - segmentation - INFO - Extracting motif summaries...
2025-10-22 11:57:24,288 - segmentation - INFO -   ✓ Created summary for 26 motifs
2025-10-22 11:57:24,290 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-22 11:57:24,290 - segmentation - INFO - Creating instance catalog...
2025-10-22 11:57:24,291 - segmentation - INFO -   ✓ Cataloged 109 instances
2025-10-22 11:57:24,292 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-22 11:57:24,292 - segmentation - INFO - Calculating segment statistics...
2025-10-22 11:57:24,320 - segmentation - INFO -   ✓ Calculated statistics for 26 motifs
2025-10-22 11:57:24,322 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-22 11:57:24,323 - visualization - INFO - Creating summary report...
2025-10-22 11:57:24,323 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-22 11:57:24,323 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-22 11:57:24,323 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-22 11:57:24,323 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-22 11:57:24,324 - visualization - INFO - Plotting top 10 motifs...
2025-10-22 11:57:24,730 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-22 11:57:25,166 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-22 11:57:25,572 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-22 11:57:25,966 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-22 11:57:26,333 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-22 11:57:26,797 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-22 11:57:27,142 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-22 11:57:27,485 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-22 11:57:27,850 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-22 11:57:28,200 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-22 11:57:28,200 - visualization - INFO - Creating motif overview plot...
2025-10-22 11:57:28,566 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-22 11:57:28,566 - visualization - INFO - Creating density analysis plot...
2025-10-22 11:57:29,058 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-22 11:57:29,058 - visualization - INFO - Creating correlation heatmap...
2025-10-22 11:57:29,326 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-22 11:57:29,326 - visualization - INFO - Creating feature distribution plots...
2025-10-22 11:57:30,534 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-22 11:57:30,534 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_6
2025-10-22 11:57:30,534 - __main__ - INFO - 
================================================================================
2025-10-22 11:57:30,534 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-22 11:57:30,534 - __main__ - INFO - ================================================================================
2025-10-22 11:57:30,534 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-22 11:57:30,534 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-22 11:57:30,535 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-22 11:57:30,535 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
2025-10-27 10:58:47,528 - __main__ - INFO - 
================================================================================
2025-10-27 10:58:47,528 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-27 10:58:47,528 - __main__ - INFO - ================================================================================
2025-10-27 10:58:47,528 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-01-01 to 2025-10-26

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-27 10:58:47,529 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 10:58:47,529 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-27 10:58:47,529 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 10:58:47,529 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-27 10:58:47,610 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-27 10:58:47,610 - database - INFO - ✅ Database connector initialized
2025-10-27 10:58:47,610 - database - INFO - Loading data from database for Mill 6...
2025-10-27 10:58:47,611 - database - INFO -   Date range: 2025-01-01 to 2025-10-26
2025-10-27 10:58:47,611 - database - INFO -   Resample frequency: 1min
2025-10-27 10:58:47,611 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-27 10:58:47,611 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-01-01, end_date=2025-10-26
2025-10-27 10:58:47,611 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-27 10:58:47,612 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-01-01 to 2025-10-26
2025-10-27 10:58:47,612 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-01-01, end_date=2025-10-26
2025-10-27 10:58:47,612 - db.db_connector - INFO - DEBUG: Current time: 2025-10-27 10:58:47.612735
2025-10-27 10:58:47,613 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-01-01 00:00:00 (timezone: None)
2025-10-27 10:58:47,614 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-26 00:00:00 (timezone: None)
2025-10-27 10:58:47,615 - db.db_connector - INFO - DEBUG: Days from now to end_date: -2
2025-10-27 10:58:47,616 - db.db_connector - INFO - DEBUG: Converted start_date 2025-01-01 -> 2025-01-01 00:00:00
2025-10-27 10:58:47,616 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-26 -> 2025-10-26 00:00:00
2025-10-27 10:58:47,617 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-01-01 00:00:00' AND "TimeStamp" <= '2025-10-26 00:00:00'
2025-10-27 10:58:47,617 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-27 10:58:47,840 - db.db_connector - INFO - DEBUG: Table MILL_06 has 426272 total records
2025-10-27 10:58:47,840 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-24 03:40:00
2025-10-27 10:58:47,857 - db.db_connector - INFO - DEBUG: Table MILL_06 has 104554 records after 2025-08-12 12:54:00
2025-10-27 10:58:51,712 - db.db_connector - INFO - Retrieved 426272 rows for Mill 6
2025-10-27 10:58:51,713 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-01-01 02:07:00 to 2025-10-24 03:40:00
2025-10-27 10:58:51,713 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-24 03:36:00'), Timestamp('2025-10-24 03:37:00'), Timestamp('2025-10-24 03:38:00'), Timestamp('2025-10-24 03:39:00'), Timestamp('2025-10-24 03:40:00')]
2025-10-27 10:58:51,719 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 104554
2025-10-27 10:58:51,719 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-12 12:55:00
2025-10-27 10:58:51,719 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-24 03:40:00
2025-10-27 10:58:51,720 - db.db_connector - INFO - Mill data retrieved: 426272 rows, 13 columns
2025-10-27 10:58:51,720 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-27 10:58:51,734 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf        Power  ...     PumpRPM    MotorAmp  PSI80  PSI200
TimeStamp                                                         ...                                       
2025-01-01 02:07:00  159.334  14.712979     225.132  1986.962727  ...  683.069111  208.412746  667.0   157.0
2025-01-01 02:08:00  159.334  14.729826     225.132  1992.564697  ...  682.768222  210.032806  667.0   157.0
2025-01-01 02:09:00  159.334  14.820792     225.132  2025.332388  ...  682.939000  213.046922  667.0   157.0

[3 rows x 13 columns]
2025-10-27 10:58:51,748 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-01-01 00:00:00, end=2025-10-26 00:00:00
2025-10-27 10:58:51,748 - db.db_connector - INFO - DEBUG: Before date filtering: 426272 rows, date range: 2025-01-01 02:07:00 to 2025-10-24 03:40:00
2025-10-27 10:58:51,758 - db.db_connector - INFO - DEBUG: After start date filter (2025-01-01 00:00:00): 426272 rows (removed 0 rows)
2025-10-27 10:58:51,768 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-26 00:00:00): 426272 rows (removed 0 rows)
2025-10-27 10:58:51,769 - db.db_connector - INFO - DEBUG: After date filtering: 426272 rows, date range: 2025-01-01 02:07:00 to 2025-10-24 03:40:00
2025-10-27 10:58:52,114 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-27 10:58:52,267 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-27 10:58:52,268 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-27 10:58:52,283 - db.db_connector - INFO - Processed mill data: 426334 rows, 13 columns
2025-10-27 10:58:52,283 - db.db_connector - INFO - Retrieving ore quality data
2025-10-27 10:58:52,283 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-01-01, end_date=2025-10-26
2025-10-27 10:58:52,283 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-01-01 00:00:00 (timezone: None)
2025-10-27 10:58:52,284 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-26 00:00:00 (timezone: None)
2025-10-27 10:58:52,284 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-01-01 -> 2025-01-01 00:00:00
2025-10-27 10:58:52,284 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-26 -> 2025-10-26 00:00:00
2025-10-27 10:58:52,285 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-01-01 00:00:00' AND "TimeStamp" <= '2025-10-26 00:00:00'
2025-10-27 10:58:52,289 - db.db_connector - INFO - DEBUG: ore_quality table has 897 total records
2025-10-27 10:58:52,289 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-26 22:00:00
2025-10-27 10:58:52,291 - db.db_connector - INFO - DEBUG: ore_quality table has 227 records after 2025-08-12 12:54:00
2025-10-27 10:58:52,293 - db.db_connector - INFO - DEBUG: ore_quality has 894 records in requested range 2025-01-01 to 2025-10-26
2025-10-27 10:58:52,304 - db.db_connector - INFO - Retrieved 894 rows of ore quality data
2025-10-27 10:58:52,306 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-01-01 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:58:52,307 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-24 14:00:00'), Timestamp('2025-10-24 22:00:00'), Timestamp('2025-10-25 06:00:00'), Timestamp('2025-10-25 14:00:00'), Timestamp('2025-10-25 22:00:00')]
2025-10-27 10:58:52,308 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 224
2025-10-27 10:58:52,308 - db.db_connector - INFO - Ore data retrieved: 894 rows, 11 columns
2025-10-27 10:58:52,308 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-27 10:58:52,309 - db.db_connector - WARNING - Found 3 duplicate timestamps, removing duplicates
2025-10-27 10:58:52,309 - db.db_connector - INFO - After removing duplicates: 891 rows remaining
2025-10-27 10:58:52,309 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-01-01 00:00:00, end=2025-10-26 00:00:00
2025-10-27 10:58:52,310 - db.db_connector - INFO - DEBUG: Before date filtering: 891 rows, date range: 2025-01-01 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:58:52,310 - db.db_connector - INFO - DEBUG: After start date filter (2025-01-01 00:00:00): 891 rows (removed 0 rows)
2025-10-27 10:58:52,310 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-26 00:00:00): 891 rows (removed 0 rows)
2025-10-27 10:58:52,311 - db.db_connector - INFO - DEBUG: After date filtering: 891 rows, date range: 2025-01-01 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:58:52,366 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-27 10:58:52,367 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-27 10:58:52,381 - db.db_connector - INFO - Processed ore data: 428641 rows, 9 columns - with constant values (no interpolation)
2025-10-27 10:58:52,382 - db.db_connector - INFO - DF1 (mill): 426334 rows, index range: 2025-01-01 02:07:00 to 2025-10-24 03:40:00
2025-10-27 10:58:52,382 - db.db_connector - INFO - DF2 (ore): 428641 rows, index range: 2025-01-01 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:58:52,384 - db.db_connector - INFO - Found 426101 common timestamps
2025-10-27 10:58:52,487 - db.db_connector - INFO - Successfully joined dataframes: 426101 rows, 22 columns
2025-10-27 10:58:52,489 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-27 10:58:52,489 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-01-01 06:00:00 to 2025-10-24 03:40:00
2025-10-27 10:58:52,497 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 104566
2025-10-27 10:58:52,497 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 104566 records
2025-10-27 10:58:52,497 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-27 10:58:52,501 - db.db_connector - INFO -                          Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp  PSI80  PSI200  id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                     
2025-01-01 06:00:00  159.559  14.934894  226.703356  1996.306436  1602.420326    0.540322  1627.879919  2.785400  490.606654  684.855034  210.613925  667.0   157.0   1   NaN      1       2.4       4.8  0.559  0.399   0.042             NaN
2025-01-01 06:01:00  159.559  14.920974  226.657000  1994.237762  1601.530977    0.540210  1627.981663  2.787333  490.806722  684.974264  210.416829  667.0   157.0   1   NaN      1       2.4       4.8  0.559  0.399   0.042             NaN
2025-01-01 06:02:00  159.559  14.897781  226.657000  1996.458690  1600.374492    0.539813  1628.058924  2.786400  490.432589  684.982420  210.700429  667.0   157.0   1   NaN      1       2.4       4.8  0.559  0.399   0.042             NaN
2025-10-27 10:58:52,501 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-27 10:58:52,504 - db.db_connector - INFO -                        Ore  WaterMill  WaterZumpf  Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM  MotorAmp      PSI80       PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                     
2025-10-24 03:38:00  0.202  12.057971  224.539662  2.061  1502.132592    0.315462  1361.920135  3.113600  324.963169  722.379405      0.13  84.040000  1325.920000  888   NaN      3       0.6       5.7  0.611  0.354   0.035             NaN
2025-10-24 03:39:00  0.202  11.928564  226.332179  2.061  1436.039506    0.259249  1328.128483  3.109667  353.393690  718.183894      0.13  87.522222  1471.066667  888   NaN      3       0.6       5.7  0.611  0.354   0.035             NaN
2025-10-24 03:40:00  0.202  11.891485  227.689577  2.061  1427.659061    0.244884  1301.866161  3.104750  380.278690  716.818270      0.13  91.875000  1652.500000  888   NaN      3       0.6       5.7  0.611  0.354   0.035             NaN
2025-10-27 10:58:52,504 - db.db_connector - INFO - ==================================================
2025-10-27 10:58:52,511 - db.db_connector - INFO - Combined data has 426101 rows and 22 columns
2025-10-27 10:58:52,511 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-27 10:58:52,521 - db.db_connector - INFO - Combined data sample:
                         Ore  WaterMill  WaterZumpf        Power  ...  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                         ...                                      
2025-01-01 06:00:00  159.559  14.934894  226.703356  1996.306436  ...  0.559  0.399   0.042             NaN
2025-01-01 06:01:00  159.559  14.920974  226.657000  1994.237762  ...  0.559  0.399   0.042             NaN
2025-01-01 06:02:00  159.559  14.897781  226.657000  1996.458690  ...  0.559  0.399   0.042             NaN

[3 rows x 22 columns]
2025-10-27 10:58:52,522 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-27 10:58:52,522 - db.db_connector - INFO - DEBUG: Final result - 426101 total records
2025-10-27 10:58:52,522 - db.db_connector - INFO - DEBUG: Final date range: 2025-01-01 06:00:00 to 2025-10-24 03:40:00
2025-10-27 10:58:52,630 - database - INFO -   ✓ Loaded 426101 rows, 24 columns
2025-10-27 10:58:58,245 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-27 10:58:58,246 - database - INFO - ✓ All 10 required columns present
2025-10-27 10:58:58,246 - database - INFO - Applying data filters...
2025-10-27 10:58:58,263 - database - INFO -   Ore: 100 < x < 220
2025-10-27 10:58:58,264 - database - INFO -   PulpHC: 400 < x < 600
2025-10-27 10:58:58,266 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-27 10:58:58,301 - database - INFO -   ✓ Filtered: 372581 rows kept, 53520 removed (12.6%)
2025-10-27 10:58:58,342 - __main__ - INFO -   ✓ Circulative load calculation complete
2025-10-27 10:59:04,360 - __main__ - INFO -   ✓ Updated data with circulative load saved to initial_data.csv
2025-10-27 10:59:04,360 - __main__ - INFO - ✓ Data loaded and filtered: 372581 rows
2025-10-27 10:59:04,360 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 10:59:04,360 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-27 10:59:04,360 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 10:59:04,361 - motif_discovery - INFO - Discovering motifs in 3 features...
2025-10-27 10:59:04,361 - motif_discovery - INFO -   Window size: 60
2025-10-27 10:59:04,361 - motif_discovery - INFO -   Max motifs: 20
2025-10-27 10:59:04,361 - motif_discovery - INFO -   Radius: 4.5
2025-10-27 10:59:04,374 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-27 10:59:52,001 - __main__ - INFO - 
================================================================================
2025-10-27 10:59:52,001 - __main__ - INFO - STARTING DATA PREPARATION PIPELINE
2025-10-27 10:59:52,001 - __main__ - INFO - ================================================================================
2025-10-27 10:59:52,001 - __main__ - INFO - ============================================================
PIPELINE CONFIGURATION SUMMARY
============================================================

Mill Number: 6
Date Range: 2025-06-26 to 2025-10-26

Features:
  MV: ['Ore', 'WaterMill', 'WaterZumpf']
  CV: ['DensityHC', 'PulpHC', 'PressureHC', 'CirculativeLoad']
  DV: ['Class_15', 'Daiki', 'FE']
  Target: PSI200

Motif Discovery:
  Window Size: 60 min
  Max Motifs: 20
  Radius: 4.5
  Correlation Filter: True

Model Training:
  Test Size: 0.2
  CV Splits: 5

Output Paths:
  Output: C:\Projects\experiments\modeling\output
  Models: C:\Projects\experiments\modeling\models
  Analysis: C:\Projects\experiments\modeling\output\analysis
  Plots: C:\Projects\experiments\modeling\output\plots
============================================================
2025-10-27 10:59:52,001 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 10:59:52,001 - __main__ - INFO - STEP 1: LOADING DATA
2025-10-27 10:59:52,002 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 10:59:52,002 - db.db_connector - INFO - Initializing database connection to s.lyubenov@em-m-db4.ellatzite-med.com:5432/em_pulse_data
2025-10-27 10:59:52,094 - db.db_connector - INFO - ✅ Database connection test successful
2025-10-27 10:59:52,095 - database - INFO - ✅ Database connector initialized
2025-10-27 10:59:52,095 - database - INFO - Loading data from database for Mill 6...
2025-10-27 10:59:52,095 - database - INFO -   Date range: 2025-06-26 to 2025-10-26
2025-10-27 10:59:52,095 - database - INFO -   Resample frequency: 1min
2025-10-27 10:59:52,095 - db.db_connector - INFO - === STARTING get_combined_data for Mill 6 ===
2025-10-27 10:59:52,095 - db.db_connector - INFO - DEBUG: Request parameters - mill_number=6, start_date=2025-06-26, end_date=2025-10-26
2025-10-27 10:59:52,095 - db.db_connector - INFO - DEBUG: Additional parameters - resample_freq=1min, save_to_logs=False, no_interpolation=True
2025-10-27 10:59:52,095 - db.db_connector - INFO - Retrieving mill data for mill 6 from 2025-06-26 to 2025-10-26
2025-10-27 10:59:52,095 - db.db_connector - INFO - DEBUG: get_mill_data called with mill_number=6, start_date=2025-06-26, end_date=2025-10-26
2025-10-27 10:59:52,095 - db.db_connector - INFO - DEBUG: Current time: 2025-10-27 10:59:52.095921
2025-10-27 10:59:52,097 - db.db_connector - INFO - DEBUG: Parsed start_date: 2025-06-26 00:00:00 (timezone: None)
2025-10-27 10:59:52,098 - db.db_connector - INFO - DEBUG: Parsed end_date: 2025-10-26 00:00:00 (timezone: None)
2025-10-27 10:59:52,099 - db.db_connector - INFO - DEBUG: Days from now to end_date: -2
2025-10-27 10:59:52,099 - db.db_connector - INFO - DEBUG: Converted start_date 2025-06-26 -> 2025-06-26 00:00:00
2025-10-27 10:59:52,099 - db.db_connector - INFO - DEBUG: Converted end_date 2025-10-26 -> 2025-10-26 00:00:00
2025-10-27 10:59:52,099 - db.db_connector - INFO - DEBUG: Executing query: SELECT * FROM mills."MILL_06" WHERE "TimeStamp" >= '2025-06-26 00:00:00' AND "TimeStamp" <= '2025-10-26 00:00:00'
2025-10-27 10:59:52,100 - db.db_connector - INFO - DEBUG: Query will search table: mills."MILL_06"
2025-10-27 10:59:52,134 - db.db_connector - INFO - DEBUG: Table MILL_06 has 426272 total records
2025-10-27 10:59:52,134 - db.db_connector - INFO - DEBUG: Table MILL_06 date range: 2025-01-01 02:07:00 to 2025-10-24 03:40:00
2025-10-27 10:59:52,147 - db.db_connector - INFO - DEBUG: Table MILL_06 has 104554 records after 2025-08-12 12:54:00
2025-10-27 10:59:53,638 - db.db_connector - INFO - Retrieved 172997 rows for Mill 6
2025-10-27 10:59:53,640 - db.db_connector - INFO - DEBUG: Mill data date range: 2025-06-26 00:00:00 to 2025-10-24 03:40:00
2025-10-27 10:59:53,640 - db.db_connector - INFO - DEBUG: Last 5 timestamps in mill data: [Timestamp('2025-10-24 03:36:00'), Timestamp('2025-10-24 03:37:00'), Timestamp('2025-10-24 03:38:00'), Timestamp('2025-10-24 03:39:00'), Timestamp('2025-10-24 03:40:00')]
2025-10-27 10:59:53,645 - db.db_connector - INFO - DEBUG: Records after 2025-08-12 12:54:00: 104554
2025-10-27 10:59:53,645 - db.db_connector - INFO - DEBUG: First timestamp after cutoff: 2025-08-12 12:55:00
2025-10-27 10:59:53,645 - db.db_connector - INFO - DEBUG: Last timestamp after cutoff: 2025-10-24 03:40:00
2025-10-27 10:59:53,646 - db.db_connector - INFO - Mill data retrieved: 172997 rows, 13 columns
2025-10-27 10:59:53,646 - db.db_connector - INFO - Mill data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200']
2025-10-27 10:59:53,655 - db.db_connector - INFO - Mill data sample:
                         Ore  WaterMill  WaterZumpf  ...    MotorAmp      PSI80     PSI200
TimeStamp                                            ...                                  
2025-06-26 00:00:00  185.424  17.123173  118.645900  ...  199.620230  51.297778  23.133333
2025-06-26 00:01:00  185.424  17.106059  122.767000  ...  196.694894  51.500000  22.900000
2025-06-26 00:02:00  185.424  17.108720  123.587667  ...  205.798015  51.500000  22.900000

[3 rows x 13 columns]
2025-10-27 10:59:53,666 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-06-26 00:00:00, end=2025-10-26 00:00:00
2025-10-27 10:59:53,666 - db.db_connector - INFO - DEBUG: Before date filtering: 172997 rows, date range: 2025-06-26 00:00:00 to 2025-10-24 03:40:00
2025-10-27 10:59:53,671 - db.db_connector - INFO - DEBUG: After start date filter (2025-06-26 00:00:00): 172997 rows (removed 0 rows)
2025-10-27 10:59:53,674 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-26 00:00:00): 172997 rows (removed 0 rows)
2025-10-27 10:59:53,675 - db.db_connector - INFO - DEBUG: After date filtering: 172997 rows, date range: 2025-06-26 00:00:00 to 2025-10-24 03:40:00
2025-10-27 10:59:53,798 - db.db_connector - INFO - Applied resampling with interpolation
2025-10-27 10:59:53,864 - db.db_connector - INFO - Applied smoothing with rolling window of size 15
2025-10-27 10:59:53,864 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-27 10:59:53,867 - db.db_connector - INFO - Processed mill data: 173021 rows, 13 columns
2025-10-27 10:59:53,868 - db.db_connector - INFO - Retrieving ore quality data
2025-10-27 10:59:53,868 - db.db_connector - INFO - DEBUG: get_ore_quality called with start_date=2025-06-26, end_date=2025-10-26
2025-10-27 10:59:53,868 - db.db_connector - INFO - DEBUG: Ore quality parsed start_date: 2025-06-26 00:00:00 (timezone: None)
2025-10-27 10:59:53,869 - db.db_connector - INFO - DEBUG: Ore quality parsed end_date: 2025-10-26 00:00:00 (timezone: None)
2025-10-27 10:59:53,869 - db.db_connector - INFO - DEBUG: Ore quality converted start_date 2025-06-26 -> 2025-06-26 00:00:00
2025-10-27 10:59:53,869 - db.db_connector - INFO - DEBUG: Ore quality converted end_date 2025-10-26 -> 2025-10-26 00:00:00
2025-10-27 10:59:53,870 - db.db_connector - INFO - DEBUG: Executing ore quality query: SELECT * FROM mills.ore_quality WHERE "TimeStamp" >= '2025-06-26 00:00:00' AND "TimeStamp" <= '2025-10-26 00:00:00'
2025-10-27 10:59:53,873 - db.db_connector - INFO - DEBUG: ore_quality table has 897 total records
2025-10-27 10:59:53,873 - db.db_connector - INFO - DEBUG: ore_quality table date range: 2025-01-01 06:00:00 to 2025-10-26 22:00:00
2025-10-27 10:59:53,875 - db.db_connector - INFO - DEBUG: ore_quality table has 227 records after 2025-08-12 12:54:00
2025-10-27 10:59:53,877 - db.db_connector - INFO - DEBUG: ore_quality has 366 records in requested range 2025-06-26 to 2025-10-26
2025-10-27 10:59:53,882 - db.db_connector - INFO - Retrieved 366 rows of ore quality data
2025-10-27 10:59:53,884 - db.db_connector - INFO - DEBUG: Ore quality data date range: 2025-06-26 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:59:53,884 - db.db_connector - INFO - DEBUG: Last 5 timestamps in ore quality data: [Timestamp('2025-10-24 14:00:00'), Timestamp('2025-10-24 22:00:00'), Timestamp('2025-10-25 06:00:00'), Timestamp('2025-10-25 14:00:00'), Timestamp('2025-10-25 22:00:00')]
2025-10-27 10:59:53,884 - db.db_connector - INFO - DEBUG: Ore quality records after 2025-08-12 12:54:00: 224
2025-10-27 10:59:53,884 - db.db_connector - INFO - Ore data retrieved: 366 rows, 11 columns
2025-10-27 10:59:53,885 - db.db_connector - INFO - Ore data columns: ['id', 'Date', 'Shift', 'TimeStamp', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet', 'Created_At']
2025-10-27 10:59:53,886 - db.db_connector - WARNING - Found 3 duplicate timestamps, removing duplicates
2025-10-27 10:59:53,886 - db.db_connector - INFO - After removing duplicates: 363 rows remaining
2025-10-27 10:59:53,887 - db.db_connector - INFO - DEBUG: process_dataframe date filtering - start=2025-06-26 00:00:00, end=2025-10-26 00:00:00
2025-10-27 10:59:53,887 - db.db_connector - INFO - DEBUG: Before date filtering: 363 rows, date range: 2025-06-26 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:59:53,888 - db.db_connector - INFO - DEBUG: After start date filter (2025-06-26 00:00:00): 363 rows (removed 0 rows)
2025-10-27 10:59:53,888 - db.db_connector - INFO - DEBUG: After end date filter (2025-10-26 00:00:00): 363 rows (removed 0 rows)
2025-10-27 10:59:53,888 - db.db_connector - INFO - DEBUG: After date filtering: 363 rows, date range: 2025-06-26 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:59:53,909 - db.db_connector - INFO - Applied resampling with constant values (no interpolation or smoothing)
2025-10-27 10:59:53,909 - db.db_connector - INFO - Resampled data to 1min frequency
2025-10-27 10:59:53,912 - db.db_connector - INFO - Processed ore data: 175201 rows, 9 columns - with constant values (no interpolation)
2025-10-27 10:59:53,913 - db.db_connector - INFO - DF1 (mill): 173021 rows, index range: 2025-06-26 00:00:00 to 2025-10-24 03:40:00
2025-10-27 10:59:53,913 - db.db_connector - INFO - DF2 (ore): 175201 rows, index range: 2025-06-26 06:00:00 to 2025-10-25 22:00:00
2025-10-27 10:59:53,914 - db.db_connector - INFO - Found 172661 common timestamps
2025-10-27 10:59:53,948 - db.db_connector - INFO - Successfully joined dataframes: 172661 rows, 22 columns
2025-10-27 10:59:53,948 - db.db_connector - INFO - Joined dataframe columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-27 10:59:53,949 - db.db_connector - INFO - DEBUG: Final combined data date range: 2025-06-26 06:00:00 to 2025-10-24 03:40:00
2025-10-27 10:59:53,955 - db.db_connector - INFO - DEBUG: Combined data records after 2025-08-12 12:54:00: 104566
2025-10-27 10:59:53,955 - db.db_connector - INFO - DEBUG: SUCCESS - Combined data extends beyond 2025-08-12 with 104566 records
2025-10-27 10:59:53,955 - db.db_connector - INFO - 
=== Combined Dataframe Head (first 3 rows) ===
2025-10-27 10:59:53,959 - db.db_connector - INFO -                             Ore  WaterMill  WaterZumpf        Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM    MotorAmp      PSI80   PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                              
2025-06-26 06:00:00  182.290440  16.771360  160.873712  1921.806249  1602.468419    0.482426  1699.959271  3.660000  561.112723  690.547506  203.888636  51.445333  22.1128  529   NaN      1       1.0       7.6  0.772  0.153   0.075             NaN
2025-06-26 06:01:00  182.313430  16.766292  160.865016  1919.905857  1602.246179    0.482490  1699.428455  3.662067  560.993691  690.539306  203.691091  51.512000  22.0728  529   NaN      1       1.0       7.6  0.772  0.153   0.075             NaN
2025-06-26 06:02:00  182.339784  16.772740  160.222936  1919.942100  1602.869669    0.482514  1698.854446  3.664133  560.789397  690.546550  203.664908  51.578667  22.0328  529   NaN      1       1.0       7.6  0.772  0.153   0.075             NaN
2025-10-27 10:59:53,959 - db.db_connector - INFO - 
=== Combined Dataframe Tail (last 3 rows) ===
2025-10-27 10:59:53,962 - db.db_connector - INFO -                        Ore  WaterMill  WaterZumpf  Power   ZumpfLevel  PressureHC    DensityHC        FE      PulpHC     PumpRPM  MotorAmp      PSI80       PSI200   id  Date  Shift  Class_15  Class_12  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                                                                                                                                                                                                     
2025-10-24 03:38:00  0.202  12.057971  224.539662  2.061  1502.132592    0.315462  1361.920135  3.113600  324.963169  722.379405      0.13  84.040000  1325.920000  888   NaN      3       0.6       5.7  0.611  0.354   0.035             NaN
2025-10-24 03:39:00  0.202  11.928564  226.332179  2.061  1436.039506    0.259249  1328.128483  3.109667  353.393690  718.183894      0.13  87.522222  1471.066667  888   NaN      3       0.6       5.7  0.611  0.354   0.035             NaN
2025-10-24 03:40:00  0.202  11.891485  227.689577  2.061  1427.659061    0.244884  1301.866161  3.104750  380.278690  716.818270      0.13  91.875000  1652.500000  888   NaN      3       0.6       5.7  0.611  0.354   0.035             NaN
2025-10-27 10:59:53,962 - db.db_connector - INFO - ==================================================
2025-10-27 10:59:53,964 - db.db_connector - INFO - Combined data has 172661 rows and 22 columns
2025-10-27 10:59:53,966 - db.db_connector - INFO - Combined data columns: ['Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'id', 'Date', 'Shift', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'Original_Sheet']
2025-10-27 10:59:53,976 - db.db_connector - INFO - Combined data sample:
                            Ore  WaterMill  WaterZumpf        Power  ...  Grano  Daiki  Shisti  Original_Sheet
TimeStamp                                                            ...                                      
2025-06-26 06:00:00  182.290440  16.771360  160.873712  1921.806249  ...  0.772  0.153   0.075             NaN
2025-06-26 06:01:00  182.313430  16.766292  160.865016  1919.905857  ...  0.772  0.153   0.075             NaN
2025-06-26 06:02:00  182.339784  16.772740  160.222936  1919.942100  ...  0.772  0.153   0.075             NaN

[3 rows x 22 columns]
2025-10-27 10:59:53,976 - db.db_connector - INFO - === COMPLETED get_combined_data for Mill 6 ===
2025-10-27 10:59:53,977 - db.db_connector - INFO - DEBUG: Final result - 172661 total records
2025-10-27 10:59:53,977 - db.db_connector - INFO - DEBUG: Final date range: 2025-06-26 06:00:00 to 2025-10-24 03:40:00
2025-10-27 10:59:54,027 - database - INFO -   ✓ Loaded 172661 rows, 24 columns
2025-10-27 10:59:56,340 - database - INFO -   ✓ Cached to C:\Projects\experiments\modeling\output\initial_data.csv
2025-10-27 10:59:56,340 - database - INFO - ✓ All 10 required columns present
2025-10-27 10:59:56,340 - database - INFO - Applying data filters...
2025-10-27 10:59:56,347 - database - INFO -   Ore: 100 < x < 220
2025-10-27 10:59:56,349 - database - INFO -   PulpHC: 400 < x < 600
2025-10-27 10:59:56,349 - database - INFO -   DensityHC: 1600 < x < 1800
2025-10-27 10:59:56,364 - database - INFO -   ✓ Filtered: 161909 rows kept, 10752 removed (6.2%)
2025-10-27 10:59:56,384 - __main__ - INFO -   ✓ Circulative load calculation complete
2025-10-27 10:59:59,019 - __main__ - INFO -   ✓ Updated data with circulative load saved to initial_data.csv
2025-10-27 10:59:59,020 - __main__ - INFO - ✓ Data loaded and filtered: 161909 rows
2025-10-27 10:59:59,020 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 10:59:59,020 - __main__ - INFO - STEP 2: DISCOVERING MV MOTIFS
2025-10-27 10:59:59,020 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 10:59:59,020 - motif_discovery - INFO - Discovering motifs in 3 features...
2025-10-27 10:59:59,021 - motif_discovery - INFO -   Window size: 60
2025-10-27 10:59:59,021 - motif_discovery - INFO -   Max motifs: 20
2025-10-27 10:59:59,021 - motif_discovery - INFO -   Radius: 4.5
2025-10-27 10:59:59,028 - motif_discovery - INFO -   Computing multivariate matrix profile...
2025-10-27 11:21:11,908 - motif_discovery - INFO -   Discovering motif groups...
2025-10-27 11:21:16,997 - motif_discovery - INFO -   ✓ Found 20 motif groups
2025-10-27 11:21:16,998 - motif_discovery - INFO -   ✓ Total instances: 659
2025-10-27 11:21:16,998 - motif_discovery - INFO -   ✓ Average distance: 3.129
2025-10-27 11:21:16,999 - __main__ - INFO - 
Applying correlation filter...
2025-10-27 11:21:16,999 - motif_discovery - INFO - Filtering motifs by correlation constraints...
2025-10-27 11:21:16,999 - motif_discovery - INFO -   Filter level: instance
2025-10-27 11:21:16,999 - motif_discovery - INFO -   Min correlation strength: 0.1
2025-10-27 11:21:16,999 - motif_discovery - INFO -   Rules:
2025-10-27 11:21:16,999 - motif_discovery - INFO -     PressureHC vs PulpHC: pos
2025-10-27 11:21:16,999 - motif_discovery - INFO -     WaterZumpf vs PressureHC: pos
2025-10-27 11:21:17,006 - motif_discovery - INFO -   ✓ Filtered: 20 motifs kept
2025-10-27 11:21:17,007 - __main__ - INFO -   ✓ Correlation stats saved to correlation_stats.json
2025-10-27 11:21:17,007 - __main__ - INFO - ✓ MV motif discovery complete: 20 motifs
2025-10-27 11:21:17,008 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 11:21:17,008 - __main__ - INFO - STEP 3: DISCOVERING DENSITY MOTIFS
2025-10-27 11:21:17,008 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 11:21:17,008 - density_analysis - INFO - Discovering density motifs with variability constraints...
2025-10-27 11:21:17,008 - density_analysis - INFO -   Constraint: WaterZumpf stable, Ore & WaterMill variable
2025-10-27 11:21:17,009 - density_analysis - INFO -   Window size: 60 minutes
2025-10-27 11:21:17,009 - density_analysis - INFO -   Max motifs: 15
2025-10-27 11:21:17,009 - density_analysis - INFO -   Radius: 4.5
2025-10-27 11:21:17,016 - density_analysis - INFO -   Computing multivariate matrix profile...
2025-10-27 11:42:14,203 - density_analysis - INFO -   Discovering motifs with variability filtering...
2025-10-27 11:45:56,123 - density_analysis - INFO -   ✓ Found 9 motif groups
2025-10-27 11:45:56,124 - density_analysis - INFO -   ✓ Total instances: 60
2025-10-27 11:45:56,124 - __main__ - INFO - ✓ Density motif discovery complete: 9 motifs
2025-10-27 11:45:56,124 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 11:45:56,124 - __main__ - INFO - STEP 4: ANALYZING DENSITY BEHAVIOR
2025-10-27 11:45:56,124 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 11:45:56,125 - density_analysis - INFO - Analyzing density behavior in motifs...
2025-10-27 11:45:56,125 - density_analysis - INFO - 
Motif 1 (13 instances):
2025-10-27 11:45:56,156 - density_analysis - INFO -   Avg DensityHC change: +0.07
2025-10-27 11:45:56,156 - density_analysis - INFO -   Ore-Density correlation: -0.111 (lag: 0 min)
2025-10-27 11:45:56,156 - density_analysis - INFO -   WaterMill-Density correlation: -0.124 (lag: 0 min)
2025-10-27 11:45:56,156 - density_analysis - INFO - 
Motif 2 (13 instances):
2025-10-27 11:45:56,180 - density_analysis - INFO -   Avg DensityHC change: -1.06
2025-10-27 11:45:56,180 - density_analysis - INFO -   Ore-Density correlation: +0.349 (lag: 0 min)
2025-10-27 11:45:56,180 - density_analysis - INFO -   WaterMill-Density correlation: +0.316 (lag: 0 min)
2025-10-27 11:45:56,180 - density_analysis - INFO - 
Motif 3 (2 instances):
2025-10-27 11:45:56,184 - density_analysis - INFO -   Avg DensityHC change: +35.41
2025-10-27 11:45:56,184 - density_analysis - INFO -   Ore-Density correlation: +0.110 (lag: -1 min)
2025-10-27 11:45:56,184 - density_analysis - INFO -   WaterMill-Density correlation: +0.061 (lag: -0 min)
2025-10-27 11:45:56,184 - density_analysis - INFO - 
Motif 4 (7 instances):
2025-10-27 11:45:56,196 - density_analysis - INFO -   Avg DensityHC change: -3.24
2025-10-27 11:45:56,196 - density_analysis - INFO -   Ore-Density correlation: +0.005 (lag: 1 min)
2025-10-27 11:45:56,196 - density_analysis - INFO -   WaterMill-Density correlation: +0.026 (lag: 3 min)
2025-10-27 11:45:56,196 - density_analysis - INFO - 
Motif 5 (7 instances):
2025-10-27 11:45:56,210 - density_analysis - INFO -   Avg DensityHC change: +2.51
2025-10-27 11:45:56,210 - density_analysis - INFO -   Ore-Density correlation: +0.024 (lag: 10 min)
2025-10-27 11:45:56,210 - density_analysis - INFO -   WaterMill-Density correlation: -0.005 (lag: 7 min)
2025-10-27 11:45:56,211 - density_analysis - INFO - 
Motif 6 (6 instances):
2025-10-27 11:45:56,221 - density_analysis - INFO -   Avg DensityHC change: -3.88
2025-10-27 11:45:56,221 - density_analysis - INFO -   Ore-Density correlation: +0.078 (lag: 0 min)
2025-10-27 11:45:56,222 - density_analysis - INFO -   WaterMill-Density correlation: +0.033 (lag: 0 min)
2025-10-27 11:45:56,222 - density_analysis - INFO - 
Motif 7 (3 instances):
2025-10-27 11:45:56,228 - density_analysis - INFO -   Avg DensityHC change: -7.00
2025-10-27 11:45:56,228 - density_analysis - INFO -   Ore-Density correlation: +0.223 (lag: -5 min)
2025-10-27 11:45:56,229 - density_analysis - INFO -   WaterMill-Density correlation: +0.285 (lag: -5 min)
2025-10-27 11:45:56,229 - density_analysis - INFO - 
Motif 8 (7 instances):
2025-10-27 11:45:56,241 - density_analysis - INFO -   Avg DensityHC change: +4.24
2025-10-27 11:45:56,242 - density_analysis - INFO -   Ore-Density correlation: +0.057 (lag: 0 min)
2025-10-27 11:45:56,242 - density_analysis - INFO -   WaterMill-Density correlation: +0.022 (lag: 0 min)
2025-10-27 11:45:56,242 - density_analysis - INFO - 
Motif 9 (2 instances):
2025-10-27 11:45:56,245 - density_analysis - INFO -   Avg DensityHC change: -16.52
2025-10-27 11:45:56,245 - density_analysis - INFO -   Ore-Density correlation: +0.035 (lag: 0 min)
2025-10-27 11:45:56,245 - density_analysis - INFO -   WaterMill-Density correlation: +0.044 (lag: 0 min)
2025-10-27 11:45:56,247 - __main__ - INFO -   ✓ Density analysis saved to density_analysis.csv
2025-10-27 11:45:56,247 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 11:45:56,247 - __main__ - INFO - STEP 5: MERGING MOTIF COLLECTIONS
2025-10-27 11:45:56,247 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 11:45:56,247 - segmentation - INFO - Merging motif collections...
2025-10-27 11:45:56,247 - segmentation - INFO -   Primary motifs: 20
2025-10-27 11:45:56,247 - segmentation - INFO -   Secondary motifs: 9
2025-10-27 11:45:56,247 - segmentation - INFO -   ✓ Merged: 29 total motifs
2025-10-27 11:45:56,247 - __main__ - INFO - ✓ Total motifs: 29
2025-10-27 11:45:56,247 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 11:45:56,249 - __main__ - INFO - STEP 6: CREATING SEGMENTED DATASET
2025-10-27 11:45:56,249 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 11:45:56,249 - __main__ - INFO -   Creating MV motifs dataset (20 motifs)...
2025-10-27 11:45:56,249 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-27 11:45:56,670 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-27 11:45:56,670 - segmentation - INFO -     - Total segments: 659
2025-10-27 11:45:56,671 - segmentation - INFO -     - Total rows: 39540
2025-10-27 11:45:56,671 - segmentation - INFO -     - Unique motifs: 20
2025-10-27 11:45:56,674 - __main__ - INFO -   Creating complete dataset (29 motifs)...
2025-10-27 11:45:56,674 - segmentation - INFO - Creating segmented dataset from motifs...
2025-10-27 11:45:57,049 - segmentation - INFO -   ✓ Created segmented dataset:
2025-10-27 11:45:57,049 - segmentation - INFO -     - Total segments: 719
2025-10-27 11:45:57,050 - segmentation - INFO -     - Total rows: 43140
2025-10-27 11:45:57,050 - segmentation - INFO -     - Unique motifs: 29
2025-10-27 11:45:57,617 - __main__ - INFO -   ✓ MV motifs data saved to segmented_motifsMV_06.csv (39540 rows, 22 columns)
2025-10-27 11:45:58,229 - __main__ - INFO -   ✓ Complete data saved to segmented_motifs_all_06.csv (43140 rows, 22 columns)
2025-10-27 11:45:58,231 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 11:45:58,232 - __main__ - INFO - STEP 6: SAVING SEGMENTED DATA TO DATABASE
2025-10-27 11:45:58,232 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 11:45:58,232 - __main__ - INFO -   Saving segmented motifs data for Mill 6...
2025-10-27 11:45:58,232 - __main__ - INFO -   Table will be recreated (if_exists='replace')
2025-10-27 11:45:58,233 - db.db_connector - INFO - Saving motifs data to database table: mills.MOTIFS_06
2025-10-27 11:45:58,233 - db.db_connector - INFO - DataFrame shape: (43140, 22)
2025-10-27 11:45:58,233 - db.db_connector - INFO - DataFrame columns: ['TimeStamp', 'Ore', 'WaterMill', 'WaterZumpf', 'Power', 'ZumpfLevel', 'PressureHC', 'DensityHC', 'FE', 'PulpHC', 'PumpRPM', 'MotorAmp', 'PSI80', 'PSI200', 'Class_15', 'Class_12', 'Grano', 'Daiki', 'Shisti', 'M_solid_to_cyclone', 'CirculativeLoad', 'motif_id']
2025-10-27 11:46:11,898 - db.db_connector - INFO - ✅ Successfully saved 43140 rows to mills.MOTIFS_06
2025-10-27 11:46:11,898 - db.db_connector - INFO -    Action: replace
2025-10-27 11:46:11,906 - db.db_connector - INFO -    Verification: Table mills.MOTIFS_06 now contains 43140 rows
2025-10-27 11:46:11,906 - __main__ - INFO - ✓ Segmented data saved to database table: MOTIFS_06
2025-10-27 11:46:11,908 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 11:46:11,908 - __main__ - INFO - STEP 7: GENERATING ANALYSIS OUTPUTS
2025-10-27 11:46:11,908 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 11:46:11,908 - segmentation - INFO - Extracting motif summaries...
2025-10-27 11:46:11,933 - segmentation - INFO -   ✓ Created summary for 29 motifs
2025-10-27 11:46:11,934 - __main__ - INFO -   ✓ Motif summary saved to motif_summary.csv
2025-10-27 11:46:11,934 - segmentation - INFO - Creating instance catalog...
2025-10-27 11:46:11,940 - segmentation - INFO -   ✓ Cataloged 719 instances
2025-10-27 11:46:11,943 - __main__ - INFO -   ✓ Instance catalog saved to instance_catalog.csv
2025-10-27 11:46:11,943 - segmentation - INFO - Calculating segment statistics...
2025-10-27 11:46:11,979 - segmentation - INFO -   ✓ Calculated statistics for 29 motifs
2025-10-27 11:46:11,981 - __main__ - INFO -   ✓ Segment statistics saved to segment_statistics.csv
2025-10-27 11:46:11,982 - visualization - INFO - Creating summary report...
2025-10-27 11:46:11,983 - visualization - INFO -   ✓ Saved summary report to summary_report.txt
2025-10-27 11:46:11,983 - __main__ - INFO - 
--------------------------------------------------------------------------------
2025-10-27 11:46:11,983 - __main__ - INFO - STEP 8: CREATING VISUALIZATIONS
2025-10-27 11:46:11,983 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-27 11:46:11,983 - visualization - INFO - Plotting top 10 motifs...
2025-10-27 11:46:12,515 - visualization - INFO -   ✓ Saved motif 1 plot to motif_01.png
2025-10-27 11:46:12,908 - visualization - INFO -   ✓ Saved motif 2 plot to motif_02.png
2025-10-27 11:46:13,291 - visualization - INFO -   ✓ Saved motif 3 plot to motif_03.png
2025-10-27 11:46:13,775 - visualization - INFO -   ✓ Saved motif 4 plot to motif_04.png
2025-10-27 11:46:14,162 - visualization - INFO -   ✓ Saved motif 5 plot to motif_05.png
2025-10-27 11:46:14,563 - visualization - INFO -   ✓ Saved motif 6 plot to motif_06.png
2025-10-27 11:46:14,959 - visualization - INFO -   ✓ Saved motif 7 plot to motif_07.png
2025-10-27 11:46:15,296 - visualization - INFO -   ✓ Saved motif 8 plot to motif_08.png
2025-10-27 11:46:15,684 - visualization - INFO -   ✓ Saved motif 9 plot to motif_09.png
2025-10-27 11:46:16,081 - visualization - INFO -   ✓ Saved motif 10 plot to motif_10.png
2025-10-27 11:46:16,081 - visualization - INFO - Creating motif overview plot...
2025-10-27 11:46:16,450 - visualization - INFO -   ✓ Saved overview plot to motif_overview.png
2025-10-27 11:46:16,450 - visualization - INFO - Creating density analysis plot...
2025-10-27 11:46:17,028 - visualization - INFO -   ✓ Saved density analysis plot to density_analysis.png
2025-10-27 11:46:17,029 - visualization - INFO - Creating correlation heatmap...
2025-10-27 11:46:17,298 - visualization - INFO -   ✓ Saved correlation heatmap to correlation_heatmap.png
2025-10-27 11:46:17,298 - visualization - INFO - Creating feature distribution plots...
2025-10-27 11:46:18,456 - visualization - INFO -   ✓ Saved feature distributions to feature_distributions.png
2025-10-27 11:46:18,456 - __main__ - INFO - ✓ Visualizations saved to C:\Projects\experiments\modeling\output\plots\mill_6
2025-10-27 11:46:18,456 - __main__ - INFO - 
================================================================================
2025-10-27 11:46:18,456 - __main__ - INFO - DATA PREPARATION COMPLETE
2025-10-27 11:46:18,456 - __main__ - INFO - ================================================================================
2025-10-27 11:46:18,456 - __main__ - INFO - Segmented data saved to: C:\Projects\experiments\modeling\output
2025-10-27 11:46:18,456 - __main__ - INFO - Analysis files saved to: C:\Projects\experiments\modeling\output\analysis
2025-10-27 11:46:18,456 - __main__ - INFO - Plots saved to: C:\Projects\experiments\modeling\output\plots
2025-10-27 11:46:18,456 - __main__ - INFO - 
✓ Data preparation pipeline completed successfully!
